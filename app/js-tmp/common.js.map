{"version":3,"sources":["common.js"],"names":["momentLast","Date","now","window","frameCacheVars","undefined","BX","addCustomEvent","json","loadApp","ready","$","Vue","use","Vuex","store","Store","state","userRegionId","Cookies","getJSON","userCity","mainShop","localStorage","shopsDataLast1","JSON","parse","getItem","filter","item","id","regionsData","shopsData","userPosition","inStock","ostatki","showCityPopup","mutations","deleteMainShop","domain","subdomain","remove","setMainRegion","newRegionId","set","expires","setMainCity","newCity","commit","setMainShop","shop","cityId","regionId","cities","tmpShop","xml_id","location","host","reload","loadData","ajax","url","type","data","success","response","i","isNaN","parseFloat","lat","lng","distance","getDistanceFromLatLonInKm","LAT","LNG","toFixed","sort","a","b","compA","address","toUpperCase","compB","setItem","e","console","log","checkLocation","findedRegion","regions","region","name","REGION","replace","length","app","$refs","citySelect","curRegion","findedCity","city","CITY","setTimeout","curCity","shops","isRegionSelected","isCitySelected","setCity","get","showShopPopup","on","html","showAgeConfirm","el","headMessage","headMessageShow","headMessageClass","isShopsPopupOpened","mounted","uploadInputmask","shopsDataLast","removeItem","loadScripts","computed","cityPopup","methods","fancybox","href","closeBtn","closeClick","helpers","overlay","keys","close","beforeShow","addClass","afterShow","afterClose","removeClass","showMessage","text","options","resolve","class","time","hideCityPopup","getCurShopTime","split","self","isClosable","update","component","props","required","Boolean","default","dateTime","append","toggle","openCalendar","todayDate","moment","ionStartDate","format","hour","add","curYear","nextYear","ionCalendar","lang","sundayFirst","years","hideArrows","startDate","onClick","date","cart_calendar_hours","val","curDate","locale","minute","second","millisecond","selectedDate","diff","onReady","dt","timeStart","timeEnd","parseInt","change","currentTarget","rows","Array","template","regionsList","citiesList","watch","oldVal","selectCity","targetCity","isContacts","search__input","viewType","curShop","srollPane","map","mapId","Math","random","radioPrefix","isKart","viewRadio","reinitMap","oldval","initMap","updated","initScroll","destroyMap","coords","center","shopsList","push","size","$el","find","width","height","zoom","ymaps","util","bounds","getCenterAndZoom","fromPoints","setCenter","objects","cluster","Clusterer","preset","clusterIconColor","hasBalloon","gridSize","selectedID","balloonContent","placemark","Placemark","iconLayout","iconImageHref","iconImageSize","geoObjects","setBounds","getBounds","checkZoomRange","getCenter","Map","setZoom","indexOf","slice","setViewMthod","method","filteredList","toLowerCase","list","inputName","String","toggleText","filteredItems","toggleSearch","max","Number","min","minVal","maxVal","step","minName","maxName","maxValue","minValue","$this","$range","initSlider","slider","animate","values","range","slide","ui","str","slick","slidesToShow","slidesToScroll","arrows","speed","autoplay","autoplaySpeed","click","hasClass","attr","$parent","closest","responsive","breakpoint","settings","toggleClass","parent","matchMedia","matches","document","querySelector","style","display","next","slideToggle","each","$min","$max","smartFilter","title","catalogMenu","submenu","categoryList","clone","appendTo","fooerSoc","prepend","value","files","prev","css","event","touchEvents","touchstart","touchmove","touchend","simulatedEvent","originalEvent","touch","changedTouches","mouseEvent","createEvent","initMouseEvent","screenX","screenY","clientX","clientY","target","dispatchEvent","preventDefault","lat1","lon1","lat2","lon2","R","dLat","deg2rad","dLon","sin","cos","c","atan2","sqrt","d","deg","PI","addEventListener","body","classList","contains","is","ios","smartbanner","appStoreLanguage","button","price","icon","iosApp","androidApp","appLink","setAttribute"],"mappings":"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","file":"common.js","sourcesContent":["\r\nimport is from \"is_js\";\r\n\r\nvar momentLast = Date.now();\r\n\r\nif (window.frameCacheVars !== undefined)\r\n    BX.addCustomEvent(\"onFrameDataReceived\" , (json) => {\r\n    \tloadApp();\r\n    });\r\nelse if (typeof(BX) != \"undefined\")\r\n    BX.ready(() => {\r\n    \tloadApp();\r\n    })\r\nelse\r\n\t$(() => {\r\n\t\tloadApp();\r\n\t})\r\n\r\nconst loadApp = () =>{\r\n\r\n\r\n\t// $('.wrapper-index-top .main-slider__cont').css({\r\n\t// \t'max-height': $('.head__menu .menu').outerHeight()\r\n\t// })\r\n\r\n\t// if($(window).width() < 1000){\r\n\t// \t$(window).resize(function(){\r\n\t// \t\t$('.wrapper-index-top .main-slider__cont').css({\r\n\t// \t\t\t'max-height': $('.head__menu .menu').outerHeight()\r\n\t// \t\t})\r\n\t// \t});\r\n\t// }\r\n\r\n\r\n\r\n\r\n\r\n\tVue.use(Vuex)\r\n\twindow.store = new Vuex.Store({\r\n\t\tstate: {\r\n\t\t\tuserRegionId: +Cookies.getJSON(\"userRegionId\") || null,\r\n\t\t\tuserCity: Cookies.getJSON(\"_userCity\") || \"\",\r\n\t\t\tmainShop: localStorage && localStorage.shopsDataLast1 && Cookies.getJSON(\"mainShop\") ? JSON.parse(localStorage.getItem(\"shopsDataLast1\"))\r\n\t\t\t\t.filter(item => item.id == Cookies.getJSON(\"mainShop\").id)[0] : \"\",\r\n\t\t\tregionsData : localStorage && localStorage.regionsData ? JSON.parse(localStorage.getItem('regionsData')) : {},\r\n      shopsData : localStorage && localStorage.shopsDataLast1 ? JSON.parse(localStorage.getItem('shopsDataLast1')) : {},\r\n\t\t\tuserPosition: Cookies.getJSON(\"geolocation\") || false,\r\n\t\t\tinStock: window.ostatki ? JSON.parse(window.ostatki) : [],\r\n\t\t\tshowCityPopup: false,\r\n\t\t},\r\n\t\tmutations: {\r\n\t\t\tdeleteMainShop (state) {\r\n\r\n\t\t\t\tlet domain = \"\";\r\n\r\n\t\t\t\tif (this.state.userCity.subdomain)\r\n\t\t\t\t\tdomain = `.vinsklad.ru`;\r\n\t\t\t\telse\r\n\t\t\t\t\tdomain = \"vinsklad.ru\"\r\n\r\n\t\t\t\tCookies.remove(\r\n\t\t\t\t\t\"mainShop\",\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdomain: domain\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\r\n\t\t\t\tstate.mainShop = {};\r\n\t\t\t},\r\n\t\t\tsetMainRegion (state, newRegionId) {\r\n\t\t\t\tstate.userRegionId = newRegionId;\r\n\t\t\t\tCookies.set(\r\n\t\t\t\t\t\"userRegionId\",\r\n\t\t\t\t\tnewRegionId,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\texpires: 30,\r\n\t\t\t\t\t\tdomain: `.vinsklad.ru`\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tsetMainCity (state, newCity) {\r\n\r\n\t\t\t\tif (state.userCity.id != newCity.id){\r\n\t\t\t\t\tthis.commit(\"deleteMainShop\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tstate.userCity = newCity;\r\n\r\n\t\t\t\tCookies.set(\r\n\t\t\t\t\t\"_userCity\",\r\n\t\t\t\t\tJSON.stringify(newCity),\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\texpires: 30,\r\n\t\t\t\t\t\tdomain: `.vinsklad.ru`\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\r\n\t\t\t},\r\n\t\t\tsetMainShop (state, id) {\r\n\t\t\t\tlet shop = state.shopsData.filter(item => item.id == id)[0],\r\n\t\t\t\t\tcityId = shop.cityId,\r\n\t\t\t\t\tregionId = state.regionsData.cities.filter(item => item.id == cityId)[0].regionId;\r\n\r\n\t\t\t\tstore.commit(\"setMainRegion\", regionId);\r\n\r\n\t\t\t\tstore.commit(\r\n\t\t\t\t\t\"setMainCity\",\r\n\t\t\t\t\tstate.regionsData\r\n\t\t\t\t\t\t.cities.filter(\r\n\t\t\t\t\t\t\titem => item.id == cityId\r\n\t\t\t\t\t\t)[0]\r\n\t\t\t\t);\r\n\r\n\t\t\t\tstate.mainShop = shop;\r\n\r\n\t\t\t\tlet tmpShop = {\r\n\t\t\t\t\tcityId: shop.cityId,\r\n\t\t\t\t\tid: shop.id,\r\n\t\t\t\t\txml_id: shop.xml_id,\r\n\t\t\t\t};\r\n\r\n\r\n\r\n\t\t\t\tCookies.set(\r\n\t\t\t\t\t\"mainShop\",\r\n\t\t\t\t\tJSON.stringify(tmpShop),\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\texpires: 30,\r\n\t\t\t\t\t\tdomain: `.vinsklad.ru`\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\r\n\t\t\t\t// location.reload()\r\n\r\n\t\t\t\tCookies.set(\r\n\t\t\t\t\t\"mainShopChanged\",\r\n\t\t\t\t\t\"1\",\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdomain: `.vinsklad.ru`\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\r\n\r\n\r\n\t\t\t\tif (this.state.userCity.subdomain)\r\n\t\t\t\t\twindow.location.host = `${this.state.userCity.subdomain}.vinsklad.ru`;\r\n\t\t\t\telse\r\n\t\t\t\t\twindow.location.host = \"vinsklad.ru\"\r\n\r\n\t\t\t\twindow.location.reload();\r\n\r\n\t\t\t},\r\n\t\t\tloadData: async state =>{\r\n\t\t\t\tlet response = await $.ajax({\r\n\t\t\t\t\turl: \"/include/ajax.php\",\r\n\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\tdata: \"AJAX_ADD_CITY=Y\",\r\n\t\t\t\t\tsuccess (response){\r\n\t\t\t\t\t\treturn response\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tlet data = JSON.parse(response);\r\n\r\n\t\t\t\tif (state.userPosition)\r\n\t\t\t\t\tfor (let i in data.shopsData){\r\n\t\t\t\t\t\tlet shop = data.shopsData[i];\r\n\r\n\t\t\t\t\t\tif (isNaN(parseFloat(shop.lat)) || isNaN(parseFloat(shop.lng)))\r\n\t\t\t\t\t\t\tcontinue\r\n\r\n\t\t\t\t\t\tlet distance = getDistanceFromLatLonInKm(parseFloat(state.userPosition.LAT),\r\n\t\t\t\t\t\t\tparseFloat(state.userPosition.LNG),\r\n\t\t\t\t\t\t\tparseFloat(shop.lat),parseFloat(shop.lng))\r\n\r\n\t\t\t\t\t\tdata.shopsData[i].distance = distance.toFixed(2);\r\n\r\n\t\t\t\t\t\t// shop.address = shop.address.replace(\"г. \", \"\").replace(\" КО\", \"\").replace(/\\s+/g, \" \");\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\tdata.shopsData.sort((a, b) => {\r\n\t\t\t\t\tvar compA = a.address.toUpperCase();\r\n\t\t\t\t\tvar compB = b.address.toUpperCase();\r\n\r\n\t\t\t\t\treturn (compA < compB) ? -1 : (compA > compB) ? 1 : 0\r\n\t\t\t\t});\r\n\r\n\t\t\t\tstate.regionsData = data.regionsData;\r\n\r\n\t\t\t\tstate.shopsData = data.shopsData;\r\n\r\n\t\t\t\tif (localStorage){\r\n        \ttry {\r\n        \t\tlocalStorage.setItem(\"regionsData\", JSON.stringify(state.regionsData));\r\n        \t\tlocalStorage.setItem(\"regionsDataTimestamp\", momentLast);\r\n\r\n        \t\tlocalStorage.setItem(\"shopsDataLast1\", JSON.stringify(state.shopsData));\r\n        \t\tlocalStorage.setItem(\"shopsDataTimestamp\", momentLast);\r\n        \t} catch (e){\r\n        \t\tconsole.log(e)\r\n        \t}\r\n        }\r\n\r\n        store.commit(\"checkLocation\");\r\n\t\t\t},\r\n\t\t\tcheckLocation(state){\r\n\t\t\t\t// if (!Cookies.get(\"age_confirmed\"))\r\n\t\t\t\t// \treturn;\r\n\r\n\t\t\t\tif (state.userRegionId == null){\r\n\t\t\t\t\tlet findedRegion = state.regionsData.regions\r\n\t\t\t\t\t.filter(region => region.name == Cookies.getJSON(\"geolocation\").REGION.replace(\"+\", \" \"));\r\n\r\n\t\t\t\t\tif (findedRegion.length){\r\n\t\t\t\t\t\tstate.userRegionId = findedRegion[0].id;\r\n\t\t\t\t\t\twindow.app.$refs.citySelect.curRegion = +state.userRegionId;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (state.userCity == \"\"){\r\n\t\t\t\t\tlet findedCity = state.regionsData.cities\r\n\t\t\t\t\t.filter(city => city.name == Cookies.getJSON(\"geolocation\").CITY.replace(\"+\", \" \"));\r\n\r\n\t\t\t\t\tif (findedCity.length){\r\n\t\t\t\t\t\tstate.userCity = findedCity[0];\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\twindow.app.$refs.citySelect.curCity = +state.userCity.id;\r\n\r\n\t\t\t\t\t\t\twindow.app.$refs.shops.isRegionSelected = state.userRegionId ? true : false;\r\n\t\t\t\t\t\t\twindow.app.$refs.shops.isCitySelected = state.userCity ? true : false;\r\n\t\t\t\t\t\t\t// window.app.$refs.shops.curRegion = +state.userRegionId || \"default\";\r\n\r\n\r\n\t\t\t\t\t\t\twindow.app.$refs.shops.setCity(state.userCity ? +state.userCity.id : \"default\", +state.userRegionId);\r\n\r\n\t\t\t\t\t\t\t// window.app.$refs.citySelect.curCity = +state.userCity.id;\r\n\t\t\t\t\t\t}, 100)\r\n\r\n\t\t\t\t\t\tstate.showCityPopup = Cookies.get(\"cityPopupShowed\") ? false : true;\r\n\t\t\t\t\t\tif (window.showShopPopup)\r\n\t\t\t\t\t\t\tapp.showShopPopup(false);\r\n\r\n\t\t\t\t\t\t$(window).on(\"load\", e => {\r\n\t\t\t\t\t\t\t$(\".menu-mobile .city\").html($(\"header .city\").html());\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tif (Cookies.get(\"age_confirmed\"))\r\n\t\t\t\t\t\t\tapp.showCityPopup(false)\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\tapp.showAgeConfirm()\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!Cookies.get(\"age_confirmed\"))\r\n\t\t\t\t\tapp.showAgeConfirm();\r\n\t\t\t},\r\n\t\t}\r\n\t});\r\n\r\n\twindow.app = new Vue({\r\n\t\tel: \"#page-wr\",\r\n\t\tdata: {\r\n\t\t\theadMessage: \"\",\r\n\t\t\theadMessageShow: false,\r\n\t\t\theadMessageClass: \"notify\",\r\n\t\t\tisShopsPopupOpened: false,\r\n\t\t},\r\n\t\tstore: store,\r\n\t\tmounted () {\r\n\t\t\tconsole.log(\"mounted\");\r\n\r\n\t\t\t// store.state.shopsData.sort((a, b) => {\r\n\t\t\t// \tlet compA = a.address.toUpperCase(),\r\n\t\t\t// \t\tcompB = b.address.toUpperCase();\r\n\r\n\t\t\t// \treturn (compA < compB) ? -1 : (compA > compB) ? 1 : 0\r\n\r\n\t\t\tuploadInputmask();\r\n\r\n\t\t\tif (localStorage && (localStorage.shopsDataLast) || localStorage.shopsData){\r\n\t\t\t\tlocalStorage.removeItem(\"shopsDataLast\");\r\n\t\t\t\tlocalStorage.removeItem(\"shopsData\");\r\n\t\t\t}\r\n\r\n\t\t\tif (localStorage && (!store.state.regionsData.length || !store.state.shopsData.length))\r\n\t\t\t\tstore.commit(\"loadData\");\r\n\t\t\telse{\r\n\t\t\t\tif (!$(\".app-block\").length)\r\n\t\t\t\t\tthis.showAgeConfirm()\r\n\t\t\t}\r\n\r\n\t\t\tloadScripts();\r\n\r\n\t\t\t//filter();\r\n\r\n\t\t\t// console.log(this.mainShop);\r\n\r\n\t\t\t// $('script:contains(CMenuOpener)').each((key, $script) => {\r\n\t\t\t// \teval($script.innerText);\r\n\t\t\t// });\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tmainShop: () => store.state.mainShop,\r\n\t\t\tuserCity: () => store.state.userCity,\r\n\t\t\tcityPopup: () => store.state.showCityPopup,\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tshowAgeConfirm (){\r\n\t\t\t\tif ($(\".app-block\").length)\r\n\t\t\t\t\treturn\r\n\t\t\t\t$.fancybox({\r\n\t\t\t\t\t\thref : '#age-forms',\r\n\t\t\t\t\t\tcloseBtn : false,\r\n\t\t\t\t\t\tcloseClick  : false,\r\n\t\t\t\t\t\thelpers     : {\r\n\t\t\t\t\t\toverlay : {\r\n\t\t\t\t\t\t\tcloseClick: false,\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tkeys : {\r\n\t\t\t\t\t\tclose : null,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tbeforeShow:function() {\r\n\t\t\t\t\t\t$('body').addClass('fancy-active');\r\n\t\t\t\t\t},\r\n\t\t\t\t\tafterShow:function(){\r\n\r\n\t\t\t\t\t},\r\n\t\t\t\t\tafterClose:function(){\r\n\t\t\t\t\t\t$('body').removeClass('fancy-active');\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tshowMessage: async (text, options) => {\r\n\r\n\t\t\t\tif (app.headMessageShow){\r\n\t\t\t\t\tapp.headMessageShow = false;\r\n\t\t\t\t\tawait new Promise(resolve => {\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tresolve()\r\n\t\t\t\t\t\t}, 300)\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\r\n\t\t\t\tapp.headMessage = \"\";\r\n\t\t\t\tapp.headMessageClass = \"notify\";\r\n\r\n\r\n\t\t\t\tapp.headMessageShow = true;\r\n\r\n\t\t\t\tapp.headMessage = text;\r\n\r\n\t\t\t\tif (options.class)\r\n\t\t\t\t\tapp.headMessageClass = options.class;\r\n\r\n\t\t\t\tsetTimeout(()=>{\r\n\t\t\t\t\tapp.headMessageShow = false;\r\n\t\t\t\t}, options.time || 2000)\r\n\r\n\t\t\t},\r\n\t\t\tsetMainShop(id) {\r\n\r\n\t\t\t},\r\n\t\t\thideCityPopup(){\r\n\t\t\t\t// Cookies.set(\"cityPopupShowed\", 1);\r\n\r\n\t\t\t\tCookies.set(\r\n\t\t\t\t\t\"isUsercityConfirmed\",\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdomain: `.vinsklad.ru`\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\r\n\t\t\t\tstore.commit(\"setMainCity\", this.userCity);\r\n\r\n\t\t\t\tstore.state.showCityPopup = false;\r\n\t\t\t},\r\n\t\t\tgetCurShopTime(){\r\n\t\t\t\tlet time = [];\r\n\t\t\t\tif (store.state.mainShop != \"\" && store.state.mainShop.time != \"\"){\r\n      \t\ttime = store.state.mainShop.time.split(\" \");\r\n\r\n      \t\ttime = time[1].split(\"-\");\r\n      \t}else{\r\n      \t\ttime[0] = \"9:00\";\r\n      \t\ttime[1] = \"22:00\";\r\n      \t}\r\n\r\n      \treturn time\r\n\t\t\t},\r\n\t\t\tshowShopPopup(){\r\n\t\t\t\tif ($(\".app-block\").length)\r\n\t\t\t\t\treturn\r\n\r\n\t\t\t\tlet self = this;\r\n\t\t\t\t$(\"#menu-toggle\").removeClass('open');\r\n\t\t\t\t$('body').removeClass(\"mobile-menu--open\");\r\n\r\n\t\t\t\tCookies.set(\r\n\t\t\t\t\t\"isUsercityConfirmed\",\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdomain: `.vinsklad.ru`\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\r\n\t\t\t\t$.fancybox({\r\n\t\t\t\t\thref: \"#shops\",\r\n\t\t\t\t\tbeforeShow (){\r\n\t\t\t\t\t\t$(\"body\").addClass(\"fancy-active\");\r\n\t\t\t\t\t\tself.isShopsPopupOpened = true;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tafterClose (){\r\n\t\t\t\t\t\t$(\"body\").removeClass(\"fancy-active\");\r\n\t\t\t\t\t\tself.isShopsPopupOpened = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tshowCityPopup(isClosable = true){\r\n\t\t\t\tif ($(\".app-block\").length)\r\n\t\t\t\t\treturn\r\n\r\n\t\t\t\t$(\"#menu-toggle\").removeClass('open');\r\n\t\t\t\t$('body').removeClass(\"mobile-menu--open\");\r\n\r\n\t\t\t\tif (!isClosable)\r\n\t\t\t\t\t$.fancybox({\r\n\t\t\t\t\t\thref: \"#city\",\r\n\t\t\t\t\t\tcloseBtn: false,\r\n\t\t\t\t\t\tcloseClick: false,\r\n\t\t\t\t\t\thelpers: {\r\n\t\t\t\t\t\t\toverlay: {\r\n\t\t\t\t\t\t\t\tcloseClick: false\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tkeys: {\r\n\t\t\t\t\t\t\tclose: null\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tbeforeShow (){\r\n\t\t\t\t\t\t\t$(\"body\").addClass(\"fancy-active\")\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tafterClose (){\r\n\t\t\t\t\t\t\t$(\"body\").removeClass(\"fancy-active\")\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tafterShow (){\r\n\t\t\t\t\t\t\t$.fancybox.update()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\telse\r\n\t\t\t\t\t$.fancybox({\r\n\t\t\t\t\t\thref: \"#city\",\r\n\t\t\t\t\t\tbeforeShow (){\r\n\t\t\t\t\t\t\t$(\"body\").addClass(\"fancy-active\")\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tafterClose (){\r\n\t\t\t\t\t\t\t$(\"body\").removeClass(\"fancy-active\")\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tafterShow (){\r\n\t\t\t\t\t\t\t$.fancybox.update()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t});\r\n}\r\n\r\nVue.component(\"datetime-pick\", {\r\n\tprops: {\r\n\t\trequired: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: true\r\n\t\t}\r\n\t},\r\n\tdata: () => ({\r\n\t\tdateTime: \"\",\r\n\t}),\r\n\tmounted(){\r\n\t\t$(\".order-form__date\").append('<div class=\"order-form__calendar\">\\\r\n      <div id=\"order-calendar\" class=\"calendar\"></div>\\\r\n    </div>');\r\n\r\n\r\n    $('.order-form__calendar').toggle();\r\n\t},\r\n\tmethods: {\r\n\t\topenCalendar(){\r\n\t\t\tvar todayDate = moment();\r\n      var ionStartDate = todayDate.format(\"DD.MM.YYYY\");\r\n\r\n      if(todayDate.hour() >= 22) {\r\n          ionStartDate = todayDate.add(1, 'days').format(\"DD.MM.YYYY\");\r\n      }\r\n\r\n      let curYear = +moment().format(\"YYYY\"),\r\n      \t\tnextYear = curYear + 1;\r\n\r\n      $('.order-form__calendar').toggle();\r\n\r\n      $(\"#order-calendar\").ionCalendar({\r\n          lang: \"ru\",\r\n          sundayFirst: false,\r\n          years: curYear+\"-\"+nextYear,\r\n          format: 'DD.MM.YYYY',\r\n          hideArrows: true,\r\n          startDate: ionStartDate,\r\n          onClick: (date) => {\r\n              window.cart_calendar_hours = $('.ic__time-select').val();\r\n\r\n              var curDate = moment();\r\n              curDate.locale(\"ru\")\r\n              curDate.minute(0);\r\n              curDate.second(0);\r\n              curDate.millisecond(0);\r\n\r\n              var selectedDate = moment(date, 'DD.MM.YYYY');\r\n              selectedDate.locale(\"ru\")\r\n              selectedDate.hour(window.cart_calendar_hours);\r\n              //   selectedDate.hour(0);\r\n              selectedDate.minute(0);\r\n              selectedDate.second(0);\r\n              selectedDate.millisecond(0);\r\n\r\n              if (selectedDate.diff(curDate, 'hours') < 2) {\r\n                  selectedDate.hour(moment().add(2, 'hour').format('H'));\r\n              }\r\n\r\n              var date = selectedDate.format(\"HH:mm DD.MM.YYYY\");\r\n              //   date = selectedDate.format(\"DD.MM.YYYY\");\r\n\r\n              if ((selectedDate.diff(curDate, 'hours') < 2) || (selectedDate.diff(curDate, 'days') > 1)) {\r\n              \t// let text = \"Заказ можно оформить только на сегодня и завтра c 9:00 до 22:00\";\r\n\r\n              \tlet time = app.getCurShopTime();\r\n\r\n              \tlet text = \"Заказ можно оформить только на сегодня и завтра c \"+time[0]+\" до \"+time[1];\r\n\r\n            \t\tapp.showMessage(text, {\r\n            \t\t\ttime: 2500,\r\n            \t\t\tclass: \"notify\"\r\n            \t\t});\r\n                // showHeaderMessage('', 'error');\r\n                return false;\r\n              }\r\n\r\n              $('.order-form__calendar').toggle();\r\n              this.dateTime = date;\r\n          },\r\n          onReady: (date) => {\r\n              var selectedDate = moment(date, 'DD.MM.YYYY');\r\n              var curDate = moment();\r\n\r\n              if (typeof(window.cart_calendar_hours) != 'undefined') {\r\n                  curDate.hour(window.cart_calendar_hours);\r\n              }\r\n              else {\r\n                  curDate.add(1, 'hour');\r\n              }\r\n              var dt = moment();\r\n              var html = '<div class=\"ic__time\"><select class=\"ic__time-select\">';\r\n\r\n              let time = app.getCurShopTime();\r\n\r\n              let timeStart = time[0], timeEnd = time[1];\r\n\r\n              for(var i = +timeStart.split(\":\")[0]; i < +timeEnd.split(\":\")[0]; i++){\r\n                  if((i < parseInt(moment().add(2, 'hour').format(\"H\"))) && (selectedDate.format('DD') == moment().format('DD'))) {\r\n                      continue;\r\n                  }\r\n                  if(i === parseInt(curDate.format(\"H\"))){\r\n                      html += '<option value=\"' + i + '\" selected=\"selected\">' + dt.hour(i).format(\"H\") + ':00</option>';\r\n                  } else {\r\n                      html += '<option value=\"' + i + '\">' + dt.hour(i).format(\"H\") + ':00</option>';\r\n                  }\r\n              }\r\n              html += '</select></div>';\r\n              $('.ic__header').append(html);\r\n\r\n              $('.ic__time-select').change((e) => {\r\n                  var hour = $(e.currentTarget).val();\r\n                  var date = this.dateTime;\r\n                  if(date == \"\")\r\n                      date = moment().format('HH:mm DD.MM.YYYY');\r\n                  var selectedDate = moment(date, 'HH:mm DD.MM.YYYY');\r\n                  selectedDate.hour(hour);\r\n                  selectedDate.minute(0);\r\n                  selectedDate.second(0);\r\n                  this.dateTime = selectedDate.format('HH:mm DD.MM.YYYY');\r\n              });\r\n            }\r\n        });\r\n\t\t}\r\n\t}\r\n})\r\n\r\nVue.component(\"features\", {\r\n\tprops: {\r\n\t\trows: {\r\n\t\t\ttype: Array,\r\n\t\t\tdefault: []\r\n\t\t}\r\n\t},\r\n\ttemplate: '\\\r\n\t\t<div class=\"features\">\\\r\n\t\t\t<div class=\"features-list\">\\\r\n\t\t\t\t<div class=\"features-item\" v-for=\"row in rows\">\\\r\n\t\t\t\t\t<div class=\"features-item__title\">{{row.title}}</div>\\\r\n\t\t\t\t\t<div class=\"features-item__content\" v-html=\"row.content\"></div>\\\r\n\t\t\t\t</div>\\\r\n\t\t\t</div>\\\r\n\t\t</div>'\r\n});\r\n\r\nVue.component(\"city-select\", {\r\n\tdata: () => ({\r\n\t\tcurRegion: store.state.userRegionId || \"default\",\r\n\t\tcurCity: (store.state.userCity != \"\" ? store.state.userCity.id : \"default\"),\r\n\t\tisRegionSelected: (store.state.userRegionId != null ? true : false),\r\n\t\tisCitySelected: (store.state.userCity != \"\" ? true : false),\r\n\t}),\r\n\tcomputed: {\r\n\t\tregionsList: () => store.state.regionsData.regions,\r\n\t\tcitiesList () {\r\n\t\t\treturn store.state.regionsData.cities.filter((item) => item.regionId == this.curRegion)\r\n\t\t},\r\n\t},\r\n\tmounted(){\r\n\t\t// store.commit(\"checkLocation\");\r\n\r\n\t\t// this.curRegion = store.state.userRegionId || \"default\";\r\n\t\t// this.curCity = store.state.userCity != \"\" ? store.state.userCity.id : \"default\";\r\n\t},\r\n\tupdate() {\r\n\t\t$.fancybox.update();\r\n\t},\r\n\twatch: {\r\n\t\tcurRegion(val, oldVal){\r\n\t\t\tthis.isRegionSelected = true;\r\n\t\t\tthis.curCity = \"default\";\r\n\t\t},\r\n\t\tcurCity(val, oldVal){\r\n\t\t\tif (val == \"default\")\r\n\t\t\t\tthis.isCitySelected = false;\r\n\t\t\telse\r\n\t\t\t\tthis.isCitySelected = true;\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tselectCity() {\r\n\t\t\tconst targetCity = store.state.regionsData\r\n\t\t\t.cities.filter(item => item.id == this.curCity)[0];\r\n\r\n\t\t\tstore.commit(\"setMainCity\", targetCity);\r\n\r\n\t\t\tstore.commit(\"setMainRegion\", this.curRegion);\r\n\t\t\tapp.showMessage(\"Город успешно выбран\", {\r\n\t\t\t\tclass: \"notify\",\r\n\t\t\t\ttime: 2000\r\n\t\t\t});\r\n\r\n\t\t\t$.fancybox.close();\r\n\r\n\t\t\t//location.reload();\r\n\r\n\t\t\tif (targetCity.subdomain)\r\n\t\t\t\twindow.location.host = `${targetCity.subdomain}.vinsklad.ru`;\r\n\t\t\telse\r\n\t\t\t\twindow.location.host = \"vinsklad.ru\"\r\n\t\t}\r\n\t},\r\n\ttemplate: '\\\r\n\t\t<div class=\"forms__input-wrap\">\\\r\n          <div class=\"forms-input-cont\">\\\r\n              <select v-model=\"curRegion\" name=\"regionSelect\" class=\"forms__select\">\\\r\n\t\t\t\t<option value=\"default\" disabled>Выберите регион</option>\\\r\n                <option v-for=\"region in regionsList\" :value=\"region.id\">{{region.name}}</option>\\\r\n              </select>\\\r\n             <label for=\"form-name\" class=\"forms-label forms__label\">Область</label>\\\r\n          </div>\\\r\n          <div v-if=\"isRegionSelected\" class=\"forms-input-cont\">\\\r\n              <select v-model=\"curCity\" name=\"citySelect\" class=\"forms__select\">\\\r\n                  <option value=\"default\" disabled>Выберите город</option>\\\r\n                  <option v-for=\"city in citiesList\" :value=\"city.id\">{{city.name}}</option>\\\r\n              </select>\\\r\n             <label for=\"form-name\" class=\"forms-label forms__label\">Город</label>\\\r\n          </div>\\\r\n          <div v-if=\"isCitySelected\" style=\"width: 100%; justify-content: center;\" class=\"forms__submit\">\\\r\n            <a @click=\"selectCity()\" class=\"btn btn-form\">Да</a>\\\r\n          </div>\\\r\n        </div>\\\r\n    '\r\n});\r\n\r\nVue.component(\"shops\", {\r\n\tprops: {\r\n\t\tisContacts: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false,\r\n\t\t}\r\n\t},\r\n\tdata: () => ({\r\n\t\tsearch__input: \"\",\r\n\t\tisRegionSelected: Cookies.getJSON(\"userRegionId\") ? true : false,\r\n\t\tisCitySelected: Cookies.getJSON(\"_userCity\") ? true : false,\r\n\t\tviewType: Cookies.get(\"shopsViewType\") || \"dist\",\r\n\t\tcurRegion: +Cookies.getJSON(\"userRegionId\") || \"default\",\r\n\t\tcurCity: (Cookies.getJSON(\"_userCity\") ? +Cookies.getJSON(\"_userCity\").id : \"default\"),\r\n\t\tcurShop: (Cookies.getJSON(\"mainShop\") ? +Cookies.getJSON(\"mainShop\").id : null),\r\n\t\tsrollPane: null,\r\n\t\tmap: null,\r\n\t\tmapId: \"shops-map\"+Math.random(),\r\n\t\tradioPrefix: Math.random(),\r\n\t\tisKart: window.ostatki ? true : false,\r\n\t}),\r\n\twatch: {\r\n\t\tsearch__input(val, oldVal){\r\n\t\t\t//this.scrollPane.reinitialise();\r\n\t\t},\r\n\t\tviewRadio(val, oldVal){\r\n\t\t\tif (val == oldVal)\r\n\t\t\t\treturn\r\n\r\n\r\n\t\t},\r\n\t\tcurRegion(val, oldVal){\r\n\t\t\tif (val == oldVal)\r\n\t\t\t\treturn\r\n\r\n\t\t\t//store.commit(\"setMainRegion\", val);\r\n\r\n\t\t\tthis.isRegionSelected = true;\r\n\t\t\tthis.isCitySelected = false;\r\n\t\t\tthis.curCity = \"default\";\r\n\t\t},\r\n\t\tcurCity(val, oldVal){\r\n\t\t\tif (val == oldVal || val == \"default\")\r\n\t\t\t\treturn\r\n\r\n\t\t\t// console.log(this.viewType);\r\n\r\n\t\t\tif (this.viewType == \"map\"){\r\n\t\t\t\t// this.destroyMap();\r\n\t\t\t\t// console.log(this.viewType);\r\n\t\t\t\t// this.viewType = \"map\";\r\n\t\t\t\tthis.reinitMap();\r\n\t\t\t}\r\n\r\n\t\t\t// console.log(this.viewType);\r\n\r\n\t\t\t//store.commit(\"setMainCity\", (this.citiesList.filter((item) => item.id == this.curCity))[0]);\r\n\r\n\t\t\t//this.isCitySelected = true;\r\n\t\t\tthis.update()\r\n\t\t},\r\n\t\tviewType (val, oldval) {\r\n\t\t\tswitch (val){\r\n\t\t\t\tcase \"map\":\r\n\t\t\t\t\tthis.initMap();\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthis.sort();\r\n\t\t\t\t\t//this.initScroll();\r\n\t\t\t}\r\n\t\t},\r\n\t},\r\n\tmounted (){\r\n\t\t// console.log(this.ostatki);\r\n\r\n\t\t// $(\".shops-view__one:nth-child(2) label\").trigger(\"click\");\r\n\r\n\t\t// this.sort();\r\n\r\n\t\tif (this.isContacts)\r\n\t\t\tthis.viewType = \"map\";\r\n\r\n\t\t// $(\".shops-view__one:first-child label\").trigger(\"click\");\r\n\r\n\t\t// for (let i in this.filteredList)\r\n\t\t\t// console.log(this.filteredList[i].address);\r\n\r\n\t\t// this.initScroll();\r\n\t\tthis.sort();\r\n\r\n\t\t//this.scrollPane.reinitialise();\r\n\t},\r\n\tupdated () {\r\n\t\t// if ($(\".shops-list__list\").length && this.scrollPane == null){\r\n\t\t// \tthis.scrollPane = $(\".shops-list__list\").jScrollPane();\r\n\t\t// \tthis.scrollPane = this.scrollPane.data(\"jsp\");\r\n\t\t// }else if ($(\".shops-list__list\").length){\r\n\t\t// \tthis.scrollPane.reinitialise()\r\n\t\t// }else if (!$(\".shops-list__list\").length)\r\n\t\t// \tthis.scrollPane = null\r\n\r\n\t\t$.fancybox.update();\r\n\t},\r\n\tmethods: {\r\n\t\tinitScroll(){\r\n\t\t\t// this.scrollPane = $(this.$el).find(\".shops-list__list\").jScrollPane();\r\n\r\n\t\t\t// this.scrollPane = this.scrollPane.data(\"jsp\");\r\n\r\n\t\t\t// this.scrollPane.reinitialise();\r\n\t\t},\r\n\t\tdestroyMap() {\r\n\t\t\t// console.log(this.map);\r\n\t\t\t// this.map.destructor();\r\n\t\t},\r\n\t\treinitMap() {\r\n\t\t\t// this.map.removeAll();\r\n\t\t\tvar coords = [], center = [0, 0], lat = 0, lng = 0;\r\n\r\n\t\t\tfor (var i in this.shopsList){\r\n\t\t\t\tlet shop = this.shopsList[i];\r\n\r\n\t\t\t\tif (!parseInt(this.ostatki[shop.xml_id]) && this.ostatki.length)\r\n\t\t\t\t\t\tcontinue\r\n\r\n\t\t\t\tif (!isNaN(parseFloat(shop.lat)) && !isNaN(parseFloat(shop.lat))){\r\n\t\t\t\t\tcoords.push([parseFloat(shop.lat), parseFloat(shop.lng)]);\r\n\t\t\t\t\tlat += parseFloat(shop.lat);\r\n\t\t\t\t\tlng += parseFloat(shop.lng);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tlet size = [$(this.$el).find(\".shops__map\").width(), $(this.$el).find(\".shops__map\").height()];\r\n\r\n\t\t\tlet zoom = ymaps.util.bounds.getCenterAndZoom(ymaps.util.bounds.fromPoints(coords), size);\r\n\r\n\t\t\t// this.map.setZoom(zoom.zoom+0.4);\r\n\r\n\t\t\tthis.map.setCenter(zoom.center, zoom.zoom);\r\n\r\n\t\t\tvar objects = [], cluster = new ymaps.Clusterer({\r\n\t\t\t\t\tpreset: 'islands#nightClusterIcons',\r\n\t\t\t\t\tclusterIconColor: \"#e31e24\",\r\n\t\t\t\t\thasBalloon: false,\r\n\t\t\t\t\tgridSize: 80,\r\n\t\t\t\t}),\r\n\t\t\tselectedID = false;\r\n\r\n\t\t\tfor (var i in this.shopsList){\r\n\t\t\t\tlet shop = this.shopsList[i];\r\n\r\n\t\t\t\tif (!parseInt(this.ostatki[shop.xml_id]) && this.ostatki.length)\r\n\t\t\t\t\t\tcontinue\r\n\r\n\t\t\t\tif (isNaN(parseFloat(shop.lat)) || isNaN(parseFloat(shop.lat)))\r\n\t\t\t\t\tcontinue\r\n\r\n\t\t\t\tif (shop.id != store.state.mainShop.id)\r\n\t\t\t\t\tshop.balloonContent = '\\\r\n\t\t\t\t\t\t<div class=\"shop-balloon\">\\\r\n\t\t\t\t\t\t\t<div class=\"shop-balloon__address\">'+shop.address+'</div>\\\r\n\t\t\t\t\t\t\t<div class=\"shop-balloon__time\">'+shop.time+'</div>\\\r\n\t\t\t\t\t\t\t<div v-if=\"shop.id != store.state.mainShop.id\" class=\"shop-balloon__btn\">\\\r\n\t\t\t\t\t\t\t\t<span onclick=\"store.commit(\\'setMainShop\\', '+shop.id+')\" class=\"btn btn--rectangle shop-select\">Выбрать</span>\\\r\n\t\t\t\t\t\t\t</div>\\\r\n\t\t\t\t\t\t</div>\\\r\n\t\t\t\t\t';\r\n\t\t\t\telse\r\n\t\t\t\t\tshop.balloonContent = '\\\r\n\t\t\t\t\t\t<div class=\"shop-balloon\">\\\r\n\t\t\t\t\t\t\t<div class=\"shop-balloon__address\">'+shop.address+'</div>\\\r\n\t\t\t\t\t\t\t<div class=\"shop-balloon__time\">'+shop.time+'</div>\\\r\n\t\t\t\t\t\t</div>\\\r\n\t\t\t\t\t';\r\n\r\n\t\t\t\tvar placemark = new ymaps.Placemark(\r\n\t\t\t\t\t[parseFloat(shop.lat), parseFloat(shop.lng)],{\r\n\t\t\t\t\t\tballoonContent: shop.balloonContent,\r\n\t\t\t\t\t},{\r\n\t\t\t\t\t\ticonLayout: \"default#image\",\r\n\t\t\t\t\t\ticonImageHref: (shop.id != store.state.mainShop.id ? \"/local/templates/vinsklad2017/img/ico-marker.png\" : \"/local/templates/vinsklad2017/img/ico-selected-marker.png\"),\r\n\t\t\t\t\t\ticonImageSize: (shop.id != store.state.mainShop.id ? [32, 43] : [28, 33])\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif (shop.id == store.state.mainShop.id)\r\n\t\t\t\t\tselectedID = {\r\n\t\t\t\t\t\tcoords: [parseFloat(shop.lat), parseFloat(shop.lng)]\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\tobjects.push(placemark);\r\n\t\t\t}\r\n\r\n\t\t\tcluster.add(objects);\r\n\r\n\t\t\tthis.map.geoObjects.add(cluster);\r\n\r\n\t\t\tif (!selectedID){\r\n\t\t\t\tthis.map.setBounds(cluster.getBounds(), {\r\n\t                checkZoomRange: true\r\n\t            })\r\n\t        }else\r\n\t        \tthis.map.setCenter(selectedID.coords, 3);\r\n\r\n\t\t},\r\n\t\tinitMap () {\r\n\t\t\tvar coords = [], center = [0, 0], lat = 0, lng = 0;\r\n\r\n\t\t\t$(\".shops__map-map\").html(\"\");\r\n\r\n\t\t\tymaps.ready(() => {\r\n\r\n\t\t\t\tfor (var i in this.shopsList){\r\n\t\t\t\t\tlet shop = this.shopsList[i];\r\n\r\n\t\t\t\t\tif (!parseInt(this.ostatki[shop.xml_id]) && this.ostatki.length)\r\n\t\t\t\t\t\tcontinue\r\n\r\n\t\t\t\t\tif (!isNaN(parseFloat(shop.lat)) && !isNaN(parseFloat(shop.lng))){\r\n\t\t\t\t\t\tcoords.push([parseFloat(shop.lat), parseFloat(shop.lng)]);\r\n\t\t\t\t\t\tlat += parseFloat(shop.lat);\r\n\t\t\t\t\t\tlng += parseFloat(shop.lng);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// center = [lng/coords.length, lat/coords.length];\r\n\r\n\t\t\t\tcenter = ymaps.util.bounds.getCenter(ymaps.util.bounds.fromPoints(coords));\r\n\r\n\t\t\t\tthis.map = new ymaps.Map(this.mapId, {\r\n\t\t\t\t\tzoom: 11,\r\n\t\t\t\t\tcenter: center,\r\n\t\t\t\t\t// controls: ['fullscreenControl']\r\n\t\t\t\t});\r\n\r\n\t\t\t\tlet size = [$(this.$el).find(\".shops__map\").width(), $(this.$el).find(\".shops__map\").height()];\r\n\r\n\t\t\t\tlet zoom = ymaps.util.bounds.getCenterAndZoom(ymaps.util.bounds.fromPoints(coords), size);\r\n\r\n\t\t\t\tthis.map.setZoom(zoom.zoom+0.4);\r\n\r\n\t\t\t\tvar objects = [], cluster = new ymaps.Clusterer({\r\n\t\t\t\t\tpreset: 'islands#nightClusterIcons',\r\n\t\t\t\t\tclusterIconColor: \"#e31e24\",\r\n\t\t\t\t\thasBalloon: false,\r\n\t\t\t\t\tgridSize: 80,\r\n\t\t\t\t}),\r\n\t\t\t\tselectedID = false;\r\n\r\n\t\t\t\tfor (var i in this.shopsList){\r\n\t\t\t\t\tlet shop = this.shopsList[i];\r\n\r\n\t\t\t\t\tif (!parseInt(this.ostatki[shop.xml_id]) && this.ostatki.length)\r\n\t\t\t\t\t\tcontinue\r\n\r\n\t\t\t\t\tif (isNaN(parseFloat(shop.lat)) || isNaN(parseFloat(shop.lng)))\r\n\t\t\t\t\t\tcontinue\r\n\r\n\t\t\t\t\tif (shop.id != store.state.mainShop.id)\r\n\t\t\t\t\t\tshop.balloonContent = '\\\r\n\t\t\t\t\t\t\t<div class=\"shop-balloon\">\\\r\n\t\t\t\t\t\t\t\t<div class=\"shop-balloon__address\">'+shop.address+'</div>\\\r\n\t\t\t\t\t\t\t\t<div class=\"shop-balloon__time\">'+shop.time+'</div>\\\r\n\t\t\t\t\t\t\t\t<div class=\"shop-balloon__btn\">\\\r\n\t\t\t\t\t\t\t\t\t<span onclick=\"store.commit(\\'setMainShop\\', '+shop.id+')\" class=\"btn btn--rectangle shop-select\">Выбрать</span>\\\r\n\t\t\t\t\t\t\t\t</div>\\\r\n\t\t\t\t\t\t\t</div>\\\r\n\t\t\t\t\t\t'\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tshop.balloonContent = '\\\r\n\t\t\t\t\t\t\t<div class=\"shop-balloon\">\\\r\n\t\t\t\t\t\t\t\t<div class=\"shop-balloon__address\">'+shop.address+'</div>\\\r\n\t\t\t\t\t\t\t\t<div class=\"shop-balloon__time\">'+shop.time+'</div>\\\r\n\t\t\t\t\t\t\t</div>\\\r\n\t\t\t\t\t\t'\r\n\r\n\t\t\t\t\tvar placemark = new ymaps.Placemark(\r\n\t\t\t\t\t\t[parseFloat(shop.lat), parseFloat(shop.lng)],{\r\n\t\t\t\t\t\t\tballoonContent: shop.balloonContent,\r\n\t\t\t\t\t\t},{\r\n\t\t\t\t\t\t\ticonLayout: \"default#image\",\r\n\t\t\t\t\t\t\ticonImageHref: (shop.id != store.state.mainShop.id ? \"/local/templates/vinsklad2017/img/ico-marker.png\" : \"/local/templates/vinsklad2017/img/ico-selected-marker.png\"),\r\n\t\t\t\t\t\t\ticonImageSize: (shop.id != store.state.mainShop.id ? [32, 43] : [28, 33])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tif (shop.id == store.state.mainShop.id)\r\n\t\t\t\t\t\tselectedID = {\r\n\t\t\t\t\t\t\tcoords: [parseFloat(shop.lat), parseFloat(shop.lng)]\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\tobjects.push(placemark);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcluster.add(objects);\r\n\r\n\t\t\t\tthis.map.geoObjects.add(cluster);\r\n\r\n\t\t\t\tif (!selectedID){\r\n\t\t\t\t\tthis.map.setBounds(cluster.getBounds(), {\r\n\t\t                checkZoomRange: true\r\n\t\t            })\r\n\t\t        }else\r\n\t\t        \tthis.map.setCenter(selectedID.coords, 16);\r\n\r\n\t\t\t\t});\r\n\r\n\r\n\t\t},\r\n\t\tsort (){\r\n\t\t\tswitch (this.viewType){\r\n\t\t\t\tcase \"alph\":\r\n\t\t\t\t\tthis.shopsList.sort((a, b) => {\r\n\t\t\t\t\t\tlet compA = a.address.toUpperCase();\r\n\t\t\t\t\t\tlet compB = b.address.toUpperCase();\r\n\r\n\t\t\t\t\t\tif(compA.indexOf('УЛ.') !== -1) {\r\n\t\t\t\t\t\t\tcompA = compA.slice(compA.indexOf('УЛ.')+4,compA.indexOf('УЛ.') + 5)\r\n\t\t\t\t\t\t}else if (compA.indexOf('ПР-Т') !== -1) {\r\n\t\t\t\t\t\t\tcompA = compA.slice(compA.indexOf('ПР-Т')+5,compA.indexOf('ПР-Т') + 6)\r\n\t\t\t\t\t\t}else if (compA.indexOf('М-Н') !== -1) {\r\n\t\t\t\t\t\t\tcompA = compA.slice(compA.indexOf('М-Н')+4,compA.indexOf('М-Н') + 5)\r\n\t\t\t\t\t\t}else if (compA.indexOf('Б-Р') !== -1) {\r\n\t\t\t\t\t\t\tcompA = compA.slice(compA.indexOf('Б-Р')+4,compA.indexOf('Б-Р') + 5)\r\n\t\t\t\t\t\t}else if (compA.indexOf('МР-Н') !== -1) {\r\n\t\t\t\t\t\t\tcompA = compA.slice(compA.indexOf('МР-Н') + 5, compA.indexOf('МР-Н') + 6)\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif(compB.indexOf('УЛ.') !== -1) {\r\n\t\t\t\t\t\t\tcompB = compB.slice(compB.indexOf('УЛ.')+4,compB.indexOf('УЛ.') + 5)\r\n\t\t\t\t\t\t}else if (compB.indexOf('ПР-Т') !== -1) {\r\n\t\t\t\t\t\t\tcompB = compB.slice(compB.indexOf('ПР-Т')+5,compB.indexOf('ПР-Т') + 6)\r\n\t\t\t\t\t\t}else if (compB.indexOf('М-Н') !== -1) {\r\n\t\t\t\t\t\t\tcompB = compB.slice(compB.indexOf('М-Н')+4,compB.indexOf('М-Н') + 5)\r\n\t\t\t\t\t\t}else if (compB.indexOf('Б-Р') !== -1) {\r\n\t\t\t\t\t\t\tcompB = compB.slice(compB.indexOf('Б-Р')+4,compB.indexOf('Б-Р') + 5)\r\n\t\t\t\t\t\t}else if (compB.indexOf('МР-Н') !== -1) {\r\n\t\t\t\t\t\t\tcompB = compB.slice(compB.indexOf('МР-Н')+5,compB.indexOf('МР-Н') + 6)\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (compA > compB) {\r\n\t\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (compA < compB) {\r\n\t\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// a должно быть равным b\r\n\t\t\t\t\t\treturn 0;\r\n\r\n\t\t\t\t\t\t// return (compA < compB) ? -1 : (compA > compB) ? 1 : 0\r\n\t\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"dist\":\r\n\t\t\t\t\tthis.shopsList.sort((a, b) => {\r\n\t\t\t\t\t\treturn parseFloat(a.distance) - parseFloat(b.distance);\r\n\t\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\tsetViewMthod(method){\r\n\t\t\tif (method == \"map\"){\r\n\r\n\t\t\t}else{\r\n\t\t\t\t//this.initScroll();\r\n\t\t\t}\r\n\t\t\t//this.type = method;\r\n\t\t},\r\n\t\tsetMainShop() {\r\n\t\t\tstore.commit(\"setMainShop\", this.curShop);\r\n\t\t},\r\n\t\tupdate() {\r\n\t\t\tthis.isCitySelected = false;\r\n\t\t\tthis.isCitySelected = true;\r\n\t\t\tthis.sort();\r\n\t\t},\r\n\t},\r\n\tcomputed: {\r\n\t\tfilteredList (){\r\n\t\t\tthis.sort();\r\n\r\n\t\t\treturn this.shopsList.filter(item => ~item.address.toLowerCase()\r\n\t\t\t.indexOf(this.search__input.toLowerCase()));\r\n\t\t},\r\n\t\tregionsList: () => store.state.regionsData.regions,\r\n\t\tcitiesList () {\r\n\t\t\treturn store.state.regionsData.cities.filter(item => item.regionId == this.curRegion)\r\n\t\t},\r\n\t\tshopsList () {\r\n\t\t\tif (!this.isKart)\r\n\t\t\t\treturn store.state.shopsData.filter(item => item.cityId == this.curCity)\r\n\t\t\telse{\r\n\r\n\t\t\t\treturn store.state.shopsData.filter(item => {\r\n\t\t\t\t\t// console.log(item.cityId, this.curCity, store.state.inStock[item.xml_id], item.xml_id);\r\n\r\n\t\t\t\t\treturn item.cityId == this.curCity && parseInt(this.ostatki[item.xml_id])\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\tostatki (){\r\n\t\t\treturn store.state.inStock;\r\n\t\t},\r\n\t},\r\n\ttemplate: '\\\r\n\t\t<div class=\"shops\">\\\r\n\t\t\t<div class=\"shops__top\">\\\r\n\t\t\t\t<div v-if=\"$root.isShopsPopupOpened\" class=\"city-select\">\\\r\n\t\t\t\t\t<div>\\\r\n\t\t\t\t\t\t<select v-model=\"curRegion\" class=\"city-select__region\">\\\r\n\t\t\t\t\t\t\t<option value=\"default\" disabled>Выберите область</option>\\\r\n\t\t\t\t\t\t\t<option v-for=\"region in regionsList\" :value=\"region.id\">{{ region.name }}</option>\\\r\n\t\t\t\t\t\t</select>\\\r\n\t\t\t\t\t</div>\\\r\n\t\t\t\t\t<div>\\\r\n\t\t\t\t\t\t<select v-if=\"isRegionSelected\" v-model=\"curCity\" class=\"city-select__city\">\\\r\n\t\t\t\t\t\t\t<option value=\"default\" disabled>Выберите город</option>\\\r\n\t\t\t\t\t\t\t<option v-for=\"city in citiesList\" :value=\"city.id\">{{ city.name }}</option>\\\r\n\t\t\t\t\t\t</select>\\\r\n\t\t\t\t\t</div>\\\r\n\t\t\t\t</div>\\\r\n\t\t\t\t<div v-else class=\"city-select\">\\\r\n\t\t\t\t\t<select v-model=\"curRegion\" class=\"city-select__region\">\\\r\n\t\t\t\t\t\t<option value=\"default\" >Выберите регион</option>\\\r\n\t\t\t\t\t\t<option v-for=\"region in regionsList\" :value=\"region.id\">{{ region.name }}</option>\\\r\n\t\t\t\t\t</select>\\\r\n\t\t\t\t\t<select v-if=\"isRegionSelected\" v-model=\"curCity\" class=\"city-select__city\">\\\r\n\t\t\t\t\t\t<option value=\"default\" >Выберите город</option>\\\r\n\t\t\t\t\t\t<option v-for=\"city in citiesList\" :value=\"city.id\">{{ city.name }}</option>\\\r\n\t\t\t\t\t</select>\\\r\n\t\t\t\t</div>\\\r\n\t\t\t</div>\\\r\n\t\t\t<div v-if=\"isCitySelected\" class=\"shops-filter\">\\\r\n\t\t\t\t<div class=\"shops-filter__radio\">\\\r\n\t\t\t\t\t<div class=\"shops-view\">\\\r\n\t\t\t\t\t\t<div class=\"shops-view__one\">\\\r\n\t\t\t\t\t\t\t<input type=\"radio\"\\\r\n\t\t\t\t\t\t\t\tclass=\"shops-view__one-input\"\\\r\n\t\t\t\t\t\t\t\tvalue=\"dist\"\\\r\n\t\t\t\t\t\t\t\t:id=\"radioPrefix+\\'dist\\'\"\\\r\n\t\t\t\t\t\t\t\tv-model=\"viewType\"\\\r\n\t\t\t\t\t\t\t/>\\\r\n\t\t\t\t\t\t\t<label\\\r\n\t\t\t\t\t\t\t\t:for=\"radioPrefix+\\'dist\\'\"\\\r\n\t\t\t\t\t\t\t\tclass=\"shops-view__label\">\\\r\n\t\t\t\t\t\t\t\tПо удалённости\\\r\n\t\t\t\t\t\t\t</label>\\\r\n\t\t\t\t\t\t</div>\\\r\n\t\t\t\t\t\t<div v-if=\"false\" data=\"window.ostatki\" class=\"shops-view__one\">\\\r\n\t\t\t\t\t\t\t<input type=\"radio\"\\\r\n\t\t\t\t\t\t\t\tclass=\"shops-view__one-input\"\\\r\n\t\t\t\t\t\t\t\tvalue=\"count\"\\\r\n\t\t\t\t\t\t\t\t:id=\"radioPrefix+\\'dist\\'\"\\\r\n\t\t\t\t\t\t\t\tv-model=\"viewType\"\\\r\n\t\t\t\t\t\t\t/>\\\r\n\t\t\t\t\t\t\t<label\\\r\n\t\t\t\t\t\t\t\t:for=\"radioPrefix+\\'dist\\'\"\\\r\n\t\t\t\t\t\t\t\tclass=\"shops-view__label\">\\\r\n\t\t\t\t\t\t\t\tПо количеству\\\r\n\t\t\t\t\t\t\t</label>\\\r\n\t\t\t\t\t\t</div>\\\r\n\t\t\t\t\t\t<div v-if=\"!isKart || shopsList.length\" class=\"shops-view__one\">\\\r\n\t\t\t\t\t\t\t<input type=\"radio\"\\\r\n\t\t\t\t\t\t\t\tclass=\"shops-view__one-input\"\\\r\n\t\t\t\t\t\t\t\tvalue=\"map\"\\\r\n\t\t\t\t\t\t\t\t:id=\"radioPrefix+\\'view_map\\'\"\\\r\n\t\t\t\t\t\t\t\tv-model=\"viewType\"\\\r\n\t\t\t\t\t\t\t/>\\\r\n\t\t\t\t\t\t\t<label\\\r\n\t\t\t\t\t\t\t\t:for=\"radioPrefix+\\'view_map\\'\"\\\r\n\t\t\t\t\t\t\t\tclass=\"shops-view__label\">\\\r\n\t\t\t\t\t\t\t\tКарта \\\r\n\t\t\t\t\t\t\t</label>\\\r\n\t\t\t\t\t\t</div>\\\r\n\t\t\t\t\t\t<div class=\"shops-view__one\">\\\r\n\t\t\t\t\t\t\t<input type=\"radio\"\\\r\n\t\t\t\t\t\t\t\tclass=\"shops-view__one-input\"\\\r\n\t\t\t\t\t\t\t\tvalue=\"alph\"\\\r\n\t\t\t\t\t\t\t\t:id=\"radioPrefix+\\'alph\\'\"\\\r\n\t\t\t\t\t\t\t\tv-model=\"viewType\"\\\r\n\t\t\t\t\t\t\t/>\\\r\n\t\t\t\t\t\t\t<label\\\r\n\t\t\t\t\t\t\t\t:for=\"radioPrefix+\\'alph\\'\"\\\r\n\t\t\t\t\t\t\t\tclass=\"shops-view__label\">\\\r\n\t\t\t\t\t\t\t\tПо алфавиту\\\r\n\t\t\t\t\t\t\t</label>\\\r\n\t\t\t\t\t\t</div>\\\r\n\t\t\t\t</div>\\\r\n\t\t\t\t<div class=\"shops-filter__search\">\\\r\n\t\t\t\t\t<input v-if=\"viewType == \\'alph\\' || viewType == \\'dist\\'\" type=\"text\" class=\"shops-filter__search-input\"\\\r\n\t\t\t\t\t\tv-model=\"search__input\" placeholder=\"Поиск\" />\\\r\n\t\t\t\t</div>\\\r\n\t\t\t</div>\\\r\n\t\t\t<div v-if=\"isCitySelected && (viewType == \\'alph\\' || viewType == \\'dist\\')\" class=\"shops-list\">\\\r\n\t\t\t\t<ul class=\"shops-list__list\">\\\r\n\t\t\t\t\t<li v-if=\"!filteredList.length\" class=\"no-results\">По запросу ничего не найдено</li>\\\r\n\t\t\t\t\t<!--  -->\\\r\n\t\t\t\t\t<li v-if=\"!isKart || parseInt(ostatki[shop.xml_id])\" v-for=\"shop in filteredList\" class=\"shops-list__list-el\">\\\r\n\t\t\t\t\t\t<div class=\"radio\">\\\r\n\t\t\t\t\t\t\t<input\\\r\n\t\t\t\t\t\t\t\ttype=\"radio\"\\\r\n\t\t\t\t\t\t\t\t:name=\"radioPrefix+\\'_+curshop\\'\"\\\r\n\t\t\t\t\t\t\t\tclass=\"radio__input\"\\\r\n\t\t\t\t\t\t\t\t:id=\"radioPrefix+\\'_\\'+shop.id\"\\\r\n\t\t\t\t\t\t\t\tv-model=\"curShop\"\\\r\n\t\t\t\t\t\t\t\t:value=\"shop.id\"\\\r\n\t\t\t\t\t\t\t/>\\\r\n\t\t\t\t\t\t\t<label :for=\"radioPrefix+\\'_\\'+shop.id\" class=\"radio__label\">\\\r\n\t\t\t\t\t\t\t\t<div class=\"shops-list__list-address\">\\\r\n\t\t\t\t\t\t\t\t\t<span>{{ shop.address }}</span>&nbsp;<span v-if=\"shop.draftbeer ==\\'BEERRIVER\\'\" title=\"Есть разливное пиво\" class=\"shops-list__list-beer\"></span>\\\r\n\t\t\t\t\t\t\t\t</div>\\\r\n\t\t\t\t\t\t\t\t<div v-if=\"shop.time\" class=\"shops-list__list-time\"><span>{{ shop.time }}</span></div>\\\r\n\t\t\t\t\t\t\t\t<div v-if=\"shop.distance\" class=\"shops-list__list-dist\"><span>{{ shop.distance }} км</span></div>\\\r\n\t\t\t\t\t\t\t\t<div v-if=\"window.ostatki\" class=\"shops-list__list-dist\"><span>{{ ostatki[shop.xml_id] || 0 }} шт</span></div>\\\r\n\t\t\t\t\t\t\t</label>\\\r\n\t\t\t\t\t\t</div>\\\r\n\t\t\t\t\t</li>\\\r\n\t\t\t\t\t<li v-if=\"isKart && !shopsList.length\" class=\"no-results\">Товара нет в наличии</li>\\\r\n\t\t\t\t</ul>\\\r\n\t\t\t</div>\\\r\n\t\t\t<div v-show=\"isCitySelected && viewType == \\'map\\'\" class=\"shops__map\">\\\r\n\t\t\t\t<div :id=\"mapId\" class=\"shops__map-map\"></div>\\\r\n\t\t\t</div>\\\r\n\t\t\t<div v-if=\"curShop && (viewType == \\'alph\\' || viewType == \\'dist\\')\" class=\"shop-select__cont\">\\\r\n\t\t\t\t<span @click=\"setMainShop()\" class=\"btn btn--rectangle lol shop-select\">Выбрать</span>\\\r\n\t\t\t</div>\\\r\n\t\t</div>\\\r\n\t'\r\n});\r\n\r\nVue.component(\"checks-filter\", {\r\n\tprops: {\r\n\t\tlist: {\r\n\t\t\ttype: Array,\r\n\t\t\tdefault: []\r\n\t\t},\r\n\t\tinputName: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: \"checks\"\r\n\t\t}\r\n\t},\r\n\tdata: () => ({\r\n\t\tsearch__input: \"\",\r\n\t\ttoggleText: \"Развернуть\",\r\n\t}),\r\n\tcomputed: {\r\n\t\tfilteredItems (){\r\n\t\t\treturn this.list.filter(item => {\r\n\t\t\t\treturn ~item.name.toLowerCase().indexOf(this.search__input.toLowerCase())\r\n\t\t\t})\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\ttoggleSearch() {\r\n\t\t\tthis.toggleText = (this.toggleText == \"Развернуть\" ? \"Свернуть\" : \"Развернуть\");\r\n\t\t}\r\n\t},\r\n\ttemplate: '\\\r\n\t\t<div class=\"filter-search\">\\\r\n\t\t\t<input type=\"text\" placeholder=\"Поиск по значениям\" v-model.trim=\"search__input\" class=\"filter-search__input\"/>\\\r\n\t\t\t<ul class=\"filter__checks filter__checks--search\">\\\r\n\t\t\t\t<li v-for=\"(item, i) in filteredItems\" class=\"filter__checks-el\">\\\r\n\t\t\t\t\t<div v-if=\"toggleText == \\'Свернуть\\' || i <= 5\" class=\"checkbox\">\\\r\n\t\t\t\t\t\t<input :id=\"inputName+i\" type=\"checkbox\" :name=\"inputName\" :checked=\"item.checked\" class=\"checkbox__input\"/>\\\r\n\t\t\t\t\t\t<label :for=\"inputName+i\" class=\"checkbox__label\">{{ item.name }}</label>\\\r\n\t\t\t\t\t</div>\\\r\n\t\t\t\t</li>\\\r\n\t\t\t</ul>\\\r\n\t\t\t<div v-if=\"filteredItems.length > 5\" class=\"filter-search__show\">\\\r\n\t\t\t\t<div @click=\"toggleSearch()\" class=\"filter-show-toggle\">{{ toggleText }}</div>\\\r\n\t\t\t</div>\\\r\n\t\t</div>'\r\n});\r\n\r\nVue.component(\"price-filter\", {\r\n\tprops: {\r\n\t\tmax: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 10000,\r\n\t\t},\r\n\t\tmin: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 0,\r\n\t\t},\r\n\t\tminVal: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 0\r\n\t\t},\r\n\t\tmaxVal: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 10000\r\n\t\t},\r\n\t\tstep: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 0.5\r\n\t\t},\r\n\t\tminName: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: \"min\"\r\n\t\t},\r\n\t\tmaxName: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: \"max\"\r\n\t\t}\r\n\t},\r\n\tdata: () => ({\r\n\t\tmaxValue: 0,\r\n\t\tminValue: 0,\r\n\t\t$this: null,\r\n\t\t$range: null\r\n\t}),\r\n\tmounted (){\r\n\t\tthis.$this = $(this.$el);\r\n\r\n\t\tthis.minValue = +this.minVal;\r\n\t\tthis.maxValue = +this.maxVal;\r\n\r\n\t\tthis.initSlider();\r\n\t},\r\n\ttemplate: '\\\r\n\t\t<div class=\"price-filter\">\\\r\n\t\t\t<div class=\"input-group\">\\\r\n\t\t\t\t<input type=\"tel\" v-model.number=\"minValue\" :name=\"minName\" class=\"catalog-filter__input input-group__input\"/>\\\r\n\t\t\t\t<input type=\"tel\" v-model.number=\"maxValue\" :name=\"maxName\" class=\"catalog-filter__input input-group__input\"/>\\\r\n\t\t\t</div>\\\r\n\t\t\t<i class=\"price-filter__range range\"></i>\\\r\n\t\t</div>\\\r\n\t',\r\n\twatch: {\r\n\t\tmaxValue (val, oldVal) {\r\n\t\t\tthis.$range.slider(\"values\", 1, val);\r\n\t\t},\r\n\t\tminValue (val, oldVal) {\r\n\t\t\tthis.$range.slider(\"values\", 0, val);\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tinitSlider () {\r\n\t\t\tvar self = this;\r\n\r\n\t\t\tthis.$range = this.$this.find(\".range\").slider({\r\n\t\t\t\tanimate: \"normal\",\r\n\t\t\t\tmin: +self.min,\r\n\t\t\t\tmax: +self.max,\r\n\t\t\t\tvalues: [+self.minValue, +self.maxValue],\r\n\t\t\t\trange: true,\r\n\t\t\t\tstep: +self.step,\r\n\t\t\t\tslide: (e, ui) =>{\r\n\t\t\t\t\tself.minValue = ui.values[0];\r\n\t\t\t\t\tself.maxValue = ui.values[1];\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n})\r\n\r\nvar log = (str) => {\r\n\tconsole.log(str)\r\n},\r\nloadScripts = () => {\r\n\t$(\".fancybox\").fancybox({\r\n\t\tbeforeShow (){\r\n\t\t\t$(\"body\").addClass(\"fancy-active\")\r\n\t\t},\r\n\t\tafterClose (){\r\n\t\t\t$(\"body\").removeClass(\"fancy-active\")\r\n\t\t}\r\n\t});\r\n\r\n\t$(\"body\").on(\"click\", \".mobile-head__top .head__shop-city\", () => {\r\n\t\tapp.showCityPopup();\r\n\t});\r\n\r\n\t$(\"body\").on(\"click\", \".mobile-head__top .head__shop-address .address\", () => {\r\n\t\tapp.showShopPopup();\r\n\t});\r\n\r\n\t$(\"body\").on(\"click\", \".mobile-head__top .head__shop-address .delete\", () =>{\r\n\t\tstore.commit(\"deleteMainShop\");\r\n\t\tlocation.reload()\r\n\t});\r\n\r\n\t$(\".main-slider\").slick({\r\n\t\tslide: \".main-slider__slide\",\r\n\t\tslidesToShow: 1,\r\n\t\tslidesToScroll: 1,\r\n\t\tarrows: true,\r\n\t\tspeed: 400,\r\n\t\tautoplay: true,\r\n\t\t// lazyLoad: \"progressive\",\r\n\t\tautoplaySpeed: 4000\r\n\t});\r\n\r\n\t$(\".anketa_new-slider\").slick({\r\n\t\tslide: \".anketa_new-slide\",\r\n\t\tslidesToShow: 1,\r\n\t\tslidesToScroll: 1,\r\n\t\tarrows: true,\r\n\t\tspeed: 400,\r\n\t\tautoplay: true,\r\n\t\t// lazyLoad: \"progressive\",\r\n\t\tautoplaySpeed: 2000\r\n\t});\r\n\r\n\t$(\".tabs__tab\").click(function(){\r\n\t\tvar $this = $(this);\r\n\r\n\t\tif ($(this).hasClass(\"active\"))\r\n\t\t\treturn\r\n\r\n\t\tvar id = +$this.attr(\"data-id\"),\r\n\t\t\t$parent = $this.closest(\".tabs\");\r\n\r\n\t\t$parent.find(\".tabs__tab.active, .tabs-content.active\").removeClass(\"active\");\r\n\r\n\t\t$parent.find(\".tabs__tab[data-id='\"+id+\"'], .tabs-content[data-id='\"+id+\"']\").addClass(\"active\");\r\n\r\n\t});\r\n\r\n\t$(\".cat-slider\").slick({\r\n\t\tslidesToShow: 4,\r\n\t\tslidesToScroll: 1,\r\n\t\tslide: \".cat-slider__slide\",\r\n\t\tautoplay: true,\r\n\t\tautoplaySpeed: 3000,\r\n\t\tresponsive: [\r\n\t\t\t{\r\n\t\t\t\tbreakpoint: 1000,\r\n\t\t\t\tsettings: {\r\n\t\t\t\t\tslidesToShow: 3,\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tbreakpoint: 820,\r\n\t\t\t\tsettings: {\r\n\t\t\t\t\tslidesToShow: 2,\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tbreakpoint: 660,\r\n\t\t\t\tsettings: {\r\n\t\t\t\t\tslidesToShow: 1,\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t]\r\n\t});\r\n\r\n\t// слайдер в карточке товвара\r\n\t$(\".another .cat-plate\").slick({\r\n\t\tslidesToShow: 3,\r\n\t\tslidesToScroll: 1,\r\n\t\tslide: \".cat-plate__one-wrap\",\r\n\t\tresponsive: [\r\n\t\t\t{\r\n\t\t\t\tbreakpoint: 820,\r\n\t\t\t\tsettings: {\r\n\t\t\t\t\tslidesToShow: 2,\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tbreakpoint: 660,\r\n\t\t\t\tsettings: {\r\n\t\t\t\t\tslidesToShow: 1,\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t]\r\n\t});\r\n\r\n\t$(\".bot-text__btn\").click(function(){\r\n\t\t$(this).toggleClass(\"active\");\r\n\t\t$(this).parent(\".bot-text\").toggleClass(\"active\");\r\n\t});\r\n\r\n\tif(window.matchMedia('(max-width: 767px)').matches) {\r\n\t\tconst list = document.querySelector('.catalog-nav__list')\r\n        if(list) list.style.display = 'none'\r\n\t}\r\n\r\n\t$(\".catalog-nav__current\").click(function(){\r\n\t\tvar $this = $(this);\r\n\r\n\t\t$this.next(\".catalog-nav__list\").slideToggle(300);\r\n\t});\r\n\r\n\t$('.catalog-filter__button').click(function(){\r\n\t\tvar $this = $(this);\r\n\r\n\t\t$this.next('.catalog-filter__bock').slideToggle(300);\r\n\t});\r\n\r\n\t$(\".filter-block__title\").click(function(){\r\n\t\tvar $this = $(this);\r\n\r\n\t\t$this.next(\".filter-block__content\").slideToggle(300);\r\n\r\n\t\tsetTimeout(() =>{\r\n\t\t\t$this.parent(\".filter-block\").toggleClass(\"closed\");\r\n\t\t}, 290);\r\n\r\n\t});\r\n\r\n\t$('.catalog__filter-btn').click(function() {\r\n\t\t$('.catalog-filter__bock').slideToggle('slow');\r\n\t});\r\n\r\n\r\n\t$(\".price-filter\").each((i, el)=>{\r\n\t\tvar $this = $(el);\r\n\r\n\t\tvar step = +$this.attr(\"data-step\"),\r\n\t\t\t$min = $this.find(\"input[data-min]\"),\r\n\t\t\t$max = $this.find(\"input[data-max]\");\r\n\r\n\t\tvar min = +$min.attr(\"data-min\"),\r\n\t\t\tmax = +$max.attr(\"data-max\");\r\n\r\n\t\tvar $range = $this.find(\".range\").slider({\r\n\t\t\tanimate: \"normal\",\r\n\t\t\tmin: min,\r\n\t\t\tmax: max,\r\n\t\t\tvalues: [$min.val(), $max.val()],\r\n\t\t\trange: true,\r\n\t\t\tstep: step,\r\n\t\t\tslide: (e, ui) =>{\r\n\t\t\t\t$min.val(ui.values[0]);\r\n\t\t\t\t$max.val(ui.values[1]);\r\n\t\t\t},\r\n\t\t\tchange(e, ui){\r\n\t\t\t\tsmartFilter.reload($min[0])\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\t$this.find(\"input[type='tel']\").on(\"keyup\", function(){\r\n\t\t\tvar id, val;\r\n\r\n\t\t\tif ($(this).attr(\"data-min\")){\r\n\t\t\t\tid = 0;\r\n\t\t\t\tval = (+$(this).val() < min ? min : +$(this).val());\r\n\t\t\t}else if ($(this).attr(\"data-max\")){\r\n\t\t\t\tid = 1;\r\n\t\t\t\tval = (+$(this).val() > max ? max : +$(this).val());\r\n\t\t\t}\r\n\r\n\t\t\t$range.slider(\"values\", id, val);\r\n\t\t})\r\n\t});\r\n\r\n\t$('.tovar-slider').slick({\r\n\t\tslide: '.tovar-slider__slide',\r\n\t\tslidesToShow: 1,\r\n\t\tslidesToScroll: 1,\r\n\t\tarrows: false,\r\n\r\n\t});\r\n\r\n\t$('.vacancy__item-header').click(function() {\r\n\t \t$(this).next().slideToggle('slow');\r\n\t \t$(this).toggleClass('active');\r\n\t});\r\n\r\n\t$('#menu-toggle').click(function(){\r\n\t\t$(this).toggleClass('open');\r\n\t\t$('body').toggleClass(\"mobile-menu--open\");\r\n\t});\r\n\r\n\t$('.catalog__filter-btn').click(function(){\r\n\t\t$(this).toggleClass('filter-open');\r\n\t\t$('catalog-nav').slideToggle('slow');\r\n\t});\r\n\r\n\r\n\tif($('body').hasClass('inner')) {\r\n\t\t$('.head__menu').each(function(i, el){\r\n\t\t\tlet $this = $(this);\r\n\r\n\t\t\tvar title = 'Каталог',\r\n\t\t\t\tcatalogMenu = \"\";\r\n\r\n\t\t\t$this.find('.menu__link').each(function(){\r\n\t\t\t\tcatalogMenu += '<li class=\"submenu__el\">\\\r\n\t\t\t\t\t\t<a href=\"'+$(this).attr(\"href\")+'\" class=\"submenu__link\">'+$(this).text()+'</a>\\\r\n\t\t\t\t</li>'\r\n\t\t\t});\r\n\r\n\t\t\t$(\".mobile-menu\").append('<li class=\"mobile-menu__el\">\\\r\n\t       \t\t<span class=\"mobile-menu__link sub\">'+title+'</span>\\\r\n\t       \t\t<ul class=\"submenu\"><li class=\"submenu__el submenu__back\">Назад</li>'+catalogMenu+'</ul>\\\r\n\t       \t</li>')\r\n\r\n\t\t});\r\n\r\n\r\n\t};\r\n\r\n\r\n\r\n\t$(\".footer-menu__cont\").each((i, el) =>{\r\n    let $this = $(el);\r\n\r\n    var title = $this.find(\".footer-menu__title\").text(),\r\n   \t\tsubmenu = \"\";\r\n\r\n   \t$this.find(\".footer-menu__link\").each((i, el) =>{\r\n   \t\tlet $this = $(el);\r\n\r\n      submenu += '<li class=\"submenu__el\">\\\r\n\t\t\t<a href=\"'+$this.attr(\"href\")+'\" class=\"submenu__link\">'+$this.text()+'</a>\\\r\n\t\t</li>'\r\n   \t});\r\n\r\n\r\n   \t$(\".mobile-menu\").append('<li class=\"mobile-menu__el\">\\\r\n   \t\t<span class=\"mobile-menu__link sub\">'+title+'</span>\\\r\n   \t\t<ul class=\"submenu\"><li class=\"submenu__el submenu__back\">Назад</li>'+submenu+'</ul>\\\r\n   \t</li>')\r\n\r\n\t});\r\n\r\n  $('.catalog-nav').each((i, el) =>{\r\n  \tlet $this = $(el);\r\n\r\n  \tvar title = 'Категории',\r\n  \tcategoryList = \"\";\r\n\r\n  \t$this.find('.catalog-nav__list-link').each((i, el) => {\r\n  \t\tlet $this = $(el);\r\n\r\n  \t\tcategoryList += '<li class=\"submenu__el\">\\\r\n\t\t\t\t<a href=\"'+$this.attr(\"href\")+'\" class=\"submenu__link\">'+$this.text()+'</a>\\\r\n\t\t\t</li>'\r\n  \t});\r\n\r\n  \t$(\".mobile-menu\").append('<li class=\"mobile-menu__el\">\\\r\n       \t\t<span class=\"mobile-menu__link sub\">'+title+'</span>\\\r\n       \t\t<ul class=\"submenu\"><li class=\"submenu__el submenu__back\">Назад</li>'+categoryList+'</ul>\\\r\n       \t</li>')\r\n\r\n  });\r\n\r\n\t$('.head__top').clone().addClass(\"mobile-head__top\").appendTo('.menu-mobile__wrap');\r\n\t$('.msgs').clone().removeClass(\"msgs\").addClass(\"mobile-menu__message\").appendTo('.menu-mobile__wrap');\r\n\r\n\tif($(window).width() < 820) {\r\n\r\n\t\tvar fooerSoc = $('.footer__soc .soc').clone().removeClass('soc').addClass('js__mobile-soc');\r\n\t\t$('.mobile-menu__message').prepend(fooerSoc);\r\n\t};\r\n\r\n\r\n\t$(\"body\").on(\"click\", \".mobile-menu__link.sub, .submenu__back\", function(){\r\n\t\tlet $this = $(this);\r\n\r\n\t\t$this.closest('.mobile-menu__el').toggleClass('submenu-open');\r\n\r\n\t});\r\n\r\n\t$(\".to-full\").click(e =>{\r\n\t\tCookies.set(\"full-version\", 1);\r\n\t\tlocation.reload();\r\n\t});\r\n\r\n\t$(\".to-mobile\").click(e => {\r\n\t\tCookies.remove(\"full-version\");\r\n\t\tlocation.reload();\r\n\t});\r\n\r\n\t$('input[type=\"file\"]').change(function(){\r\n\t\tvar value = $(this)[0].files[0].name;\r\n\t\t$(this).prev('.forms__input--file-support').val(value);\r\n\t\t$(this).next('.forms__input--file-support').val(value);\r\n\t});\r\n\r\n\r\n\tif ($(\"html\").hasClass(\"bx-ie\")){\r\n\t\t$(\".main-news__important\").css({\r\n\t\t\theight: \"auto\"\r\n\t\t});\r\n\t\t$(\".main-news\").css({\r\n\t\t\t\"min-height\": $(\".main-news__important\").height()\r\n\t\t});\r\n\t}\r\n\r\n\t$(\".main-slider__slide\").each((i, el) => {\r\n\t\tlet $this = $(el);\r\n\r\n\t\tif ($this.find(\".main-slider__slide-title\").text() == \"\")\r\n\t\t\t$this.addClass(\"js__empty\");\r\n\t});\r\n\r\n\r\n\t$(\".catalog\").prepend('<div class=\"js__dop-info\"></div>');\r\n\r\n\t$(\".title-block__cont\").clone().addClass(\"js__title\").appendTo(\".js__dop-info\");\r\n\r\n\t// $('.status-price-1').closest('.cat-plate__price, .cat-list__price').addClass('max');\r\n\r\n\r\n\r\n\t$('body').on('touchstart touchmove touchend', 'span.ui-slider-handle', function (event) {\r\n\t    //mousevents to simulate on touch\r\n\t    var touchEvents = {\r\n\t        touchstart: 'mousedown',\r\n\t        touchmove: 'mousemove',\r\n\t        touchend: 'mouseup'\r\n\t    };\r\n\r\n\t    //get element and type of event to simulate\r\n\t    var simulatedEvent = touchEvents[event.originalEvent.type],\r\n\t        touch = event.originalEvent.changedTouches[0],\r\n\t        mouseEvent = document.createEvent('MouseEvent');\r\n\r\n\t    //return if no mouse event is matched\r\n\t    if (typeof simulatedEvent === 'undefined') {\r\n\t        return;\r\n\t    }\r\n\r\n\t    //init the mousevent if we have a matched event\r\n\t    mouseEvent.initMouseEvent(\r\n\t        simulatedEvent, //type\r\n\t        true, //bubbles\r\n\t        true, //cancelable\r\n\t        window, //view\r\n\t        1, //detail\r\n\t        touch.screenX, //screenX\r\n\t        touch.screenY, //screenY\r\n\t        touch.clientX, //clientX\r\n\t        touch.clientY, //clientY\r\n\t        false, //ctrlKey\r\n\t        false, //altKey\r\n\t        false, //shiftKey\r\n\t        false, //metaKey\r\n\t        0, //button\r\n\t        null //related target\r\n\t    );\r\n\r\n\t    //dispatch event on touched element\r\n\t    touch.target.dispatchEvent(mouseEvent);\r\n\t    event.preventDefault();\r\n\t});\r\n\r\n\r\n\r\n}\r\n\r\nvar getDistanceFromLatLonInKm = (lat1,lon1,lat2,lon2) => {\r\n  var R = 6371; // Radius of the earth in km\r\n  var dLat = deg2rad(lat2-lat1);  // deg2rad below\r\n  var dLon = deg2rad(lon2-lon1);\r\n  var a =\r\n    Math.sin(dLat/2) * Math.sin(dLat/2) +\r\n    Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) *\r\n    Math.sin(dLon/2) * Math.sin(dLon/2)\r\n    ;\r\n  var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\r\n  var d = R * c; // Distance in km\r\n  return d;\r\n},\r\ndeg2rad = (deg) => {\r\n  return deg * (Math.PI/180)\r\n}\r\n\r\n\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", function(){\r\n\tif (!document.body.classList.contains(\"mobile-app\") && !is.ios())\r\n\t\t$.smartbanner({\r\n\t\t\ttitle: \"Винный склад\",\r\n\t\t\tappStoreLanguage: \"ru\",\r\n\t\t\tbutton: \"Установить\",\r\n\t\t\tprice: \"\",\r\n\t\t\ticon: \"/local/templates/vinsklad2017/img/app-icon.jpg\",\r\n\t\t});\r\n\r\n\t;(function () {\r\n\t\tconst iosApp = \"https://apps.apple.com/ru/app/винный-склад/id1450252717\",\r\n\t\t\tandroidApp = \"https://play.google.com/store/apps/details?id=us.startmobile.vinestore&hl=ru\",\r\n\t\t\tappLink = document.querySelector(\".app-wrapper\");\r\n\r\n\t\tif (!appLink)\r\n\t\t\treturn;\r\n\r\n\t\tif (is.ios())\r\n\t\t\tappLink.setAttribute(\"href\", iosApp)\r\n\t\telse\r\n\t\t\tappLink.setAttribute(\"href\", androidApp)\r\n\t})()\r\n})"]}
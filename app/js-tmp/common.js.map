{"version":3,"sources":["common.js"],"names":["momentLast","Date","now","window","frameCacheVars","undefined","BX","addCustomEvent","json","loadApp","ready","$","Vue","use","Vuex","store","Store","state","userRegionId","Cookies","getJSON","userCity","mainShop","localStorage","shopsDataLast1","JSON","parse","getItem","filter","item","id","regionsData","shopsData","userPosition","inStock","ostatki","showCityPopup","mutations","deleteMainShop","domain","subdomain","remove","setMainRegion","newRegionId","set","expires","setMainCity","newCity","commit","setMainShop","shop","cityId","regionId","cities","tmpShop","xml_id","location","host","loadData","ajax","url","type","data","success","response","i","isNaN","parseFloat","lat","lng","distance","getDistanceFromLatLonInKm","LAT","LNG","toFixed","sort","a","b","compA","address","toUpperCase","compB","setItem","e","console","log","checkLocation","get","findedRegion","regions","region","name","REGION","replace","length","app","$refs","citySelect","curRegion","findedCity","city","CITY","setTimeout","curCity","shops","isRegionSelected","isCitySelected","setCity","showShopPopup","on","html","showAgeConfirm","el","headMessage","headMessageShow","headMessageClass","isShopsPopupOpened","mounted","uploadInputmask","shopsDataLast","removeItem","loadScripts","computed","cityPopup","methods","fancybox","href","closeBtn","closeClick","helpers","overlay","keys","close","beforeShow","addClass","afterShow","afterClose","removeClass","showMessage","text","options","resolve","class","time","hideCityPopup","getCurShopTime","split","self","isClosable","update","component","props","required","Boolean","default","dateTime","append","toggle","openCalendar","todayDate","moment","ionStartDate","format","hour","add","curYear","nextYear","ionCalendar","lang","sundayFirst","years","hideArrows","startDate","onClick","date","cart_calendar_hours","val","curDate","locale","minute","second","millisecond","selectedDate","diff","onReady","dt","timeStart","timeEnd","parseInt","change","currentTarget","rows","Array","template","regionsList","citiesList","watch","oldVal","selectCity","targetCity","isContacts","search__input","viewType","curShop","srollPane","map","mapId","Math","random","radioPrefix","isKart","viewRadio","reinitMap","oldval","initMap","updated","initScroll","destroyMap","coords","center","shopsList","push","size","$el","find","width","height","zoom","ymaps","util","bounds","getCenterAndZoom","fromPoints","setCenter","objects","cluster","Clusterer","preset","clusterIconColor","hasBalloon","gridSize","selectedID","balloonContent","placemark","Placemark","iconLayout","iconImageHref","iconImageSize","geoObjects","setBounds","getBounds","checkZoomRange","getCenter","Map","setZoom","setViewMthod","method","filteredList","toLowerCase","indexOf","list","inputName","String","toggleText","filteredItems","toggleSearch","max","Number","min","minVal","maxVal","step","minName","maxName","maxValue","minValue","$this","$range","initSlider","slider","animate","values","range","slide","ui","str","reload","slick","slidesToShow","slidesToScroll","arrows","speed","autoplay","autoplaySpeed","click","hasClass","attr","$parent","closest","responsive","breakpoint","settings","toggleClass","parent","next","slideToggle","each","$min","$max","smartFilter","title","catalogMenu","submenu","categoryList","clone","appendTo","fooerSoc","prepend","value","files","prev","css","event","touchEvents","touchstart","touchmove","touchend","simulatedEvent","originalEvent","touch","changedTouches","mouseEvent","document","createEvent","initMouseEvent","screenX","screenY","clientX","clientY","target","dispatchEvent","preventDefault","lat1","lon1","lat2","lon2","R","dLat","deg2rad","dLon","sin","cos","c","atan2","sqrt","d","deg","PI","addEventListener","body","classList","contains","is","ios","smartbanner","appStoreLanguage","button","price","icon","iosApp","androidApp","appLink","querySelector","setAttribute"],"mappings":"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","file":"common.js","sourcesContent":["\nimport is from \"is_js\";\n\nvar momentLast = Date.now();\n\nif (window.frameCacheVars !== undefined)\n    BX.addCustomEvent(\"onFrameDataReceived\" , (json) => {\n    \tloadApp();\n    });\nelse if (typeof(BX) != \"undefined\")\n    BX.ready(() => {\n    \tloadApp();\n    })\nelse\n\t$(() => {\n\t\tloadApp();\n\t})\n\nconst loadApp = () =>{\n\n\n\t// $('.wrapper-index-top .main-slider__cont').css({\n\t// \t'max-height': $('.head__menu .menu').outerHeight()\n\t// })\n\n\t// if($(window).width() < 1000){\n\t// \t$(window).resize(function(){\n\t// \t\t$('.wrapper-index-top .main-slider__cont').css({\n\t// \t\t\t'max-height': $('.head__menu .menu').outerHeight()\n\t// \t\t})\n\t// \t});\n\t// }\n\n\n\t\n\n\n\tVue.use(Vuex)\n\twindow.store = new Vuex.Store({\n\t\tstate: { \n\t\t\tuserRegionId: +Cookies.getJSON(\"userRegionId\") || null,\n\t\t\tuserCity: Cookies.getJSON(\"_userCity\") || \"\",\n\t\t\tmainShop: localStorage && localStorage.shopsDataLast1 && Cookies.getJSON(\"mainShop\") ? JSON.parse(localStorage.getItem(\"shopsDataLast1\"))\n\t\t\t\t.filter(item => item.id == Cookies.getJSON(\"mainShop\").id)[0] : \"\",\n\t\t\tregionsData : localStorage && localStorage.regionsData ? JSON.parse(localStorage.getItem('regionsData')) : {},\n      shopsData : localStorage && localStorage.shopsDataLast1 ? JSON.parse(localStorage.getItem('shopsDataLast1')) : {},\n\t\t\tuserPosition: Cookies.getJSON(\"geolocation\") || false,\n\t\t\tinStock: window.ostatki ? JSON.parse(window.ostatki) : [],\n\t\t\tshowCityPopup: false,\n\t\t},\n\t\tmutations: {\n\t\t\tdeleteMainShop (state) {\n\n\t\t\t\tlet domain = \"\";\n\n\t\t\t\tif (this.state.userCity.subdomain)\n\t\t\t\t\tdomain = `${this.state.userCity.subdomain}.vinsklad.ru`;\n\t\t\t\telse\n\t\t\t\t\tdomain = \"vinsklad.ru\"\n\n\t\t\t\tCookies.remove(\n\t\t\t\t\t\"mainShop\",\n\t\t\t\t\t{\n\t\t\t\t\t\tdomain: domain\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tstate.mainShop = {};\n\t\t\t},\n\t\t\tsetMainRegion (state, newRegionId) {\n\t\t\t\tstate.userRegionId = newRegionId;\n\t\t\t\tCookies.set(\n\t\t\t\t\t\"userRegionId\", \n\t\t\t\t\tnewRegionId, \n\t\t\t\t\t{\n\t\t\t\t\t\texpires: 30,\n\t\t\t\t\t\tdomain: `.vinsklad.ru`\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t},\n\t\t\tsetMainCity (state, newCity) {\n\n\t\t\t\tif (state.userCity.id != newCity.id){\n\t\t\t\t\tthis.commit(\"deleteMainShop\");\n\t\t\t\t}\n\n\t\t\t\tstate.userCity = newCity;\n\n\t\t\t\tCookies.set(\n\t\t\t\t\t\"_userCity\", \n\t\t\t\t\tJSON.stringify(newCity), \n\t\t\t\t\t{\n\t\t\t\t\t\texpires: 30,\n\t\t\t\t\t\tdomain: `.vinsklad.ru`\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t},\n\t\t\tsetMainShop (state, id) {\n\t\t\t\tlet shop = state.shopsData.filter(item => item.id == id)[0],\n\t\t\t\t\tcityId = shop.cityId,\n\t\t\t\t\tregionId = state.regionsData.cities.filter(item => item.id == cityId)[0].regionId;\n\n\t\t\t\tstore.commit(\"setMainRegion\", regionId);\n\n\t\t\t\tstore.commit(\n\t\t\t\t\t\"setMainCity\", \n\t\t\t\t\tstate.regionsData\n\t\t\t\t\t\t.cities.filter(\n\t\t\t\t\t\t\titem => item.id == cityId\n\t\t\t\t\t\t)[0]\n\t\t\t\t);\n\n\t\t\t\tstate.mainShop = shop;\n\n\t\t\t\tlet tmpShop = {\n\t\t\t\t\tcityId: shop.cityId,\n\t\t\t\t\tid: shop.id,\n\t\t\t\t\txml_id: shop.xml_id,\n\t\t\t\t};\n\n\t\t\t\t\n\n\t\t\t\tCookies.set(\n\t\t\t\t\t\"mainShop\", \n\t\t\t\t\tJSON.stringify(tmpShop), \n\t\t\t\t\t{\n\t\t\t\t\t\texpires: 30,\n\t\t\t\t\t\tdomain: `.vinsklad.ru`\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\t// location.reload()\n\n\t\t\t\tCookies.set(\n\t\t\t\t\t\"mainShopChanged\",\n\t\t\t\t\t\"1\",\n\t\t\t\t\t{\n\t\t\t\t\t\tdomain: `.vinsklad.ru`\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\t\n\t\t\t\tif (this.state.userCity.subdomain)\n\t\t\t\t\twindow.location.host = `${this.state.userCity.subdomain}.vinsklad.ru`;\n\t\t\t\telse\n\t\t\t\t\twindow.location.host = \"vinsklad.ru\"\n\n\t\t\t},\n\t\t\tloadData: async state =>{\n\t\t\t\tlet response = await $.ajax({\n\t\t\t\t\turl: \"/include/ajax.php\",\n\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\tdata: \"AJAX_ADD_CITY=Y\",\n\t\t\t\t\tsuccess (response){\n\t\t\t\t\t\treturn response\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tlet data = JSON.parse(response);\n\n\t\t\t\tif (state.userPosition)\n\t\t\t\t\tfor (let i in data.shopsData){\n\t\t\t\t\t\tlet shop = data.shopsData[i];\n\n\t\t\t\t\t\tif (isNaN(parseFloat(shop.lat)) || isNaN(parseFloat(shop.lng)))\n\t\t\t\t\t\t\tcontinue\n\n\t\t\t\t\t\tlet distance = getDistanceFromLatLonInKm(parseFloat(state.userPosition.LAT), \n\t\t\t\t\t\t\tparseFloat(state.userPosition.LNG),\n\t\t\t\t\t\t\tparseFloat(shop.lat),parseFloat(shop.lng))\n\n\t\t\t\t\t\tdata.shopsData[i].distance = distance.toFixed(2);\n\n\t\t\t\t\t\t// shop.address = shop.address.replace(\"г. \", \"\").replace(\" КО\", \"\").replace(/\\s+/g, \" \");\n\n\t\t\t\t\t}\n\n\t\t\t\tdata.shopsData.sort((a, b) => {\n\t\t\t\t\tvar compA = a.address.toUpperCase();\n\t\t\t\t\tvar compB = b.address.toUpperCase();\n\n\t\t\t\t\treturn (compA < compB) ? -1 : (compA > compB) ? 1 : 0\n\t\t\t\t});\n\n\t\t\t\tstate.regionsData = data.regionsData;\n\n\t\t\t\tstate.shopsData = data.shopsData;\n\n\t\t\t\tif (localStorage){\n        \ttry {\n        \t\tlocalStorage.setItem(\"regionsData\", JSON.stringify(state.regionsData));\n        \t\tlocalStorage.setItem(\"regionsDataTimestamp\", momentLast);\n\n        \t\tlocalStorage.setItem(\"shopsDataLast1\", JSON.stringify(state.shopsData));\n        \t\tlocalStorage.setItem(\"shopsDataTimestamp\", momentLast);\n        \t} catch (e){\n        \t\tconsole.log(e)\n        \t}\n        }\n\n        store.commit(\"checkLocation\");\n\t\t\t},\n\t\t\tcheckLocation(state){\n\t\t\t\tif (!Cookies.get(\"age_confirmed\"))\n\t\t\t\t\treturn;\n\n\t\t\t\tif (state.userRegionId == null){\n\t\t\t\t\tlet findedRegion = state.regionsData.regions\n\t\t\t\t\t.filter(region => region.name == Cookies.getJSON(\"geolocation\").REGION.replace(\"+\", \" \"));\n\n\t\t\t\t\tif (findedRegion.length){\n\t\t\t\t\t\tstate.userRegionId = findedRegion[0].id;\n\t\t\t\t\t\twindow.app.$refs.citySelect.curRegion = +state.userRegionId;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (state.userCity == \"\"){\n\t\t\t\t\tlet findedCity = state.regionsData.cities\n\t\t\t\t\t.filter(city => city.name == Cookies.getJSON(\"geolocation\").CITY.replace(\"+\", \" \"));\n\n\t\t\t\t\tif (findedCity.length){\n\t\t\t\t\t\tstate.userCity = findedCity[0];\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\twindow.app.$refs.citySelect.curCity = +state.userCity.id;\n\n\t\t\t\t\t\t\twindow.app.$refs.shops.isRegionSelected = state.userRegionId ? true : false;\n\t\t\t\t\t\t\twindow.app.$refs.shops.isCitySelected = state.userCity ? true : false;\n\t\t\t\t\t\t\t// window.app.$refs.shops.curRegion = +state.userRegionId || \"default\";\n\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\twindow.app.$refs.shops.setCity(state.userCity ? +state.userCity.id : \"default\", +state.userRegionId);\n\n\t\t\t\t\t\t\t// window.app.$refs.citySelect.curCity = +state.userCity.id;\n\t\t\t\t\t\t}, 100)\n\n\t\t\t\t\t\t// state.showCityPopup = Cookies.get(\"cityPopupShowed\") ? false : true;\n\t\t\t\t\t\tif (window.showShopPopup)\n\t\t\t\t\t\t\tapp.showShopPopup(false);\n\n\t\t\t\t\t\t$(window).on(\"load\", e => {\n\t\t\t\t\t\t\t$(\".menu-mobile .city\").html($(\"header .city\").html());\t\t\t\t\t\t\t\n\t\t\t\t\t\t});\n\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif (Cookies.get(\"age_confirmed\"))\n\t\t\t\t\t\t\tapp.showCityPopup(false)\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tapp.showAgeConfirm()\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!Cookies.get(\"age_confirmed\"))\n\t\t\t\t\tapp.showAgeConfirm();\n\t\t\t},\n\t\t}\n\t});\n\n\twindow.app = new Vue({\n\t\tel: \"#page-wr\",\n\t\tdata: {\n\t\t\theadMessage: \"\",\n\t\t\theadMessageShow: false,\n\t\t\theadMessageClass: \"notify\",\n\t\t\tisShopsPopupOpened: false,\n\t\t},\n\t\tstore: store,\n\t\tmounted () {\n\t\t\tconsole.log(\"mounted\");\n\n\t\t\t// store.state.shopsData.sort((a, b) => {\n\t\t\t// \tlet compA = a.address.toUpperCase(),\n\t\t\t// \t\tcompB = b.address.toUpperCase();\n\n\t\t\t// \treturn (compA < compB) ? -1 : (compA > compB) ? 1 : 0\n\n\t\t\tuploadInputmask();\n\n\t\t\tif (localStorage && (localStorage.shopsDataLast) || localStorage.shopsData){\n\t\t\t\tlocalStorage.removeItem(\"shopsDataLast\");\n\t\t\t\tlocalStorage.removeItem(\"shopsData\");\n\t\t\t}\n\n\t\t\tif (localStorage && (!store.state.regionsData.length || !store.state.shopsData.length))\n\t\t\t\tstore.commit(\"loadData\");\n\t\t\telse{\n\t\t\t\tif (!$(\".app-block\").length)\n\t\t\t\t\tthis.showAgeConfirm()\n\t\t\t}\n\n\t\t\tloadScripts();\n\n\t\t\t//filter();\n\n\t\t\t// console.log(this.mainShop);\n\n\t\t\t// $('script:contains(CMenuOpener)').each((key, $script) => {\n\t\t\t// \teval($script.innerText);\n\t\t\t// });\n\t\t},\n\t\tcomputed: {\n\t\t\tmainShop: () => store.state.mainShop,\n\t\t\tuserCity: () => store.state.userCity,\n\t\t\tcityPopup: () => store.state.showCityPopup,\n\t\t},\n\t\tmethods: {\n\t\t\tshowAgeConfirm (){\n\t\t\t\tif ($(\".app-block\").length)\n\t\t\t\t\treturn\n\t\t\t\t$.fancybox({\n\t\t\t\t\t\thref : '#age-forms',\n\t\t\t\t\t\tcloseBtn : false,\n\t\t\t\t\t\tcloseClick  : false,\n\t\t\t\t\t\thelpers     : {\n\t\t\t\t\t\toverlay : {\n\t\t\t\t\t\t\tcloseClick: false,\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tkeys : {\n\t\t\t\t\t\tclose : null,\n\t\t\t\t\t},\n\t\t\t\t\tbeforeShow:function() {\n\t\t\t\t\t\t$('body').addClass('fancy-active');\n\t\t\t\t\t},\n\t\t\t\t\tafterShow:function(){\n\n\t\t\t\t\t},\n\t\t\t\t\tafterClose:function(){\n\t\t\t\t\t\t$('body').removeClass('fancy-active');\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t\tshowMessage: async (text, options) => {\n\n\t\t\t\tif (app.headMessageShow){\n\t\t\t\t\tapp.headMessageShow = false;\n\t\t\t\t\tawait new Promise(resolve => {\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tresolve()\n\t\t\t\t\t\t}, 300)\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\tapp.headMessage = \"\";\n\t\t\t\tapp.headMessageClass = \"notify\";\n\n\n\t\t\t\tapp.headMessageShow = true;\n\n\t\t\t\tapp.headMessage = text;\n\n\t\t\t\tif (options.class)\n\t\t\t\t\tapp.headMessageClass = options.class;\n\n\t\t\t\tsetTimeout(()=>{\n\t\t\t\t\tapp.headMessageShow = false;\n\t\t\t\t}, options.time || 2000)\n\t\t\t\t\n\t\t\t},\n\t\t\tsetMainShop(id) {\n\t\t\t\t\n\t\t\t},\n\t\t\thideCityPopup(){\n\t\t\t\t// Cookies.set(\"cityPopupShowed\", 1);\n\n\t\t\t\tCookies.set(\n\t\t\t\t\t\"isUsercityConfirmed\",\n\t\t\t\t\t{\n\t\t\t\t\t\tdomain: `.vinsklad.ru`\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tstore.commit(\"setMainCity\", this.userCity);\n\n\t\t\t\tstore.state.showCityPopup = false;\n\t\t\t},\n\t\t\tgetCurShopTime(){\n\t\t\t\tlet time = [];\n\t\t\t\tif (store.state.mainShop != \"\" && store.state.mainShop.time != \"\"){\n      \t\ttime = store.state.mainShop.time.split(\" \");\n\n      \t\ttime = time[1].split(\"-\");\n      \t}else{\n      \t\ttime[0] = \"9:00\";\n      \t\ttime[1] = \"22:00\";\n      \t}\n\n      \treturn time\n\t\t\t},\n\t\t\tshowShopPopup(){\n\t\t\t\tif ($(\".app-block\").length)\n\t\t\t\t\treturn\n\n\t\t\t\tlet self = this;\n\t\t\t\t$(\"#menu-toggle\").removeClass('open');\n\t\t\t\t$('body').removeClass(\"mobile-menu--open\");\n\n\t\t\t\tCookies.set(\n\t\t\t\t\t\"isUsercityConfirmed\",\n\t\t\t\t\t{\n\t\t\t\t\t\tdomain: `.vinsklad.ru`\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\t$.fancybox({\n\t\t\t\t\thref: \"#shops\",\n\t\t\t\t\tbeforeShow (){\n\t\t\t\t\t\t$(\"body\").addClass(\"fancy-active\");\n\t\t\t\t\t\tself.isShopsPopupOpened = true;\n\t\t\t\t\t},\n\t\t\t\t\tafterClose (){\n\t\t\t\t\t\t$(\"body\").removeClass(\"fancy-active\");\n\t\t\t\t\t\tself.isShopsPopupOpened = false;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\tshowCityPopup(isClosable = true){\n\t\t\t\tif ($(\".app-block\").length)\n\t\t\t\t\treturn\n\n\t\t\t\t$(\"#menu-toggle\").removeClass('open');\n\t\t\t\t$('body').removeClass(\"mobile-menu--open\");\n\n\t\t\t\tif (!isClosable)\n\t\t\t\t\t$.fancybox({\n\t\t\t\t\t\thref: \"#city\",\n\t\t\t\t\t\tcloseBtn: false,\n\t\t\t\t\t\tcloseClick: false,\n\t\t\t\t\t\thelpers: {\n\t\t\t\t\t\t\toverlay: {\n\t\t\t\t\t\t\t\tcloseClick: false\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tkeys: {\n\t\t\t\t\t\t\tclose: null\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbeforeShow (){\n\t\t\t\t\t\t\t$(\"body\").addClass(\"fancy-active\")\n\t\t\t\t\t\t},\n\t\t\t\t\t\tafterClose (){\n\t\t\t\t\t\t\t$(\"body\").removeClass(\"fancy-active\")\t\n\t\t\t\t\t\t},\n\t\t\t\t\t\tafterShow (){\n\t\t\t\t\t\t\t$.fancybox.update()\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\telse\n\t\t\t\t\t$.fancybox({\n\t\t\t\t\t\thref: \"#city\",\n\t\t\t\t\t\tbeforeShow (){\n\t\t\t\t\t\t\t$(\"body\").addClass(\"fancy-active\")\n\t\t\t\t\t\t},\n\t\t\t\t\t\tafterClose (){\n\t\t\t\t\t\t\t$(\"body\").removeClass(\"fancy-active\")\t\n\t\t\t\t\t\t},\n\t\t\t\t\t\tafterShow (){\n\t\t\t\t\t\t\t$.fancybox.update()\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t}\n\t\t},\n\t});\n}\n\nVue.component(\"datetime-pick\", {\n\tprops: {\n\t\trequired: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t}\n\t},\n\tdata: () => ({\n\t\tdateTime: \"\",\n\t}),\n\tmounted(){\n\t\t$(\".order-form__date\").append('<div class=\"order-form__calendar\">\\\n      <div id=\"order-calendar\" class=\"calendar\"></div>\\\n    </div>');\n\n\n    $('.order-form__calendar').toggle();\n\t},\n\tmethods: {\n\t\topenCalendar(){\t\n\t\t\tvar todayDate = moment();\n      var ionStartDate = todayDate.format(\"DD.MM.YYYY\");\n\n      if(todayDate.hour() >= 22) {\n          ionStartDate = todayDate.add(1, 'days').format(\"DD.MM.YYYY\");\n      }\n\n      let curYear = +moment().format(\"YYYY\"),\n      \t\tnextYear = curYear + 1;\n\n      $('.order-form__calendar').toggle();\n\n      $(\"#order-calendar\").ionCalendar({\n          lang: \"ru\",\n          sundayFirst: false,\n          years: curYear+\"-\"+nextYear,\n          format: 'DD.MM.YYYY',\n          hideArrows: true,\n          startDate: ionStartDate,\n          onClick: (date) => {\n              window.cart_calendar_hours = $('.ic__time-select').val();\n\n              var curDate = moment();\n              curDate.locale(\"ru\")\n              curDate.minute(0);\n              curDate.second(0);\n              curDate.millisecond(0);\n\n              var selectedDate = moment(date, 'DD.MM.YYYY');\n              selectedDate.locale(\"ru\")\n              selectedDate.hour(window.cart_calendar_hours);\n              //   selectedDate.hour(0);\n              selectedDate.minute(0);\n              selectedDate.second(0);\n              selectedDate.millisecond(0);\n\n              if (selectedDate.diff(curDate, 'hours') < 2) {\n                  selectedDate.hour(moment().add(2, 'hour').format('H'));\n              }\n\n              var date = selectedDate.format(\"HH:mm DD.MM.YYYY\");\n              //   date = selectedDate.format(\"DD.MM.YYYY\");\n\n              if ((selectedDate.diff(curDate, 'hours') < 2) || (selectedDate.diff(curDate, 'days') > 1)) {\n              \t// let text = \"Заказ можно оформить только на сегодня и завтра c 9:00 до 22:00\";\n              \t\n              \tlet time = app.getCurShopTime();\n\n              \tlet text = \"Заказ можно оформить только на сегодня и завтра c \"+time[0]+\" до \"+time[1];\n\n            \t\tapp.showMessage(text, {\n            \t\t\ttime: 2500,\n            \t\t\tclass: \"notify\"\n            \t\t});\n                // showHeaderMessage('', 'error');\n                return false;\n              }\n\n              $('.order-form__calendar').toggle();\n              this.dateTime = date;\n          },\n          onReady: (date) => {\n              var selectedDate = moment(date, 'DD.MM.YYYY');\n              var curDate = moment();\n\n              if (typeof(window.cart_calendar_hours) != 'undefined') {\n                  curDate.hour(window.cart_calendar_hours);\n              }\n              else {\n                  curDate.add(1, 'hour');\n              }\n              var dt = moment();\n              var html = '<div class=\"ic__time\"><select class=\"ic__time-select\">';\n\n              let time = app.getCurShopTime();\n\n              let timeStart = time[0], timeEnd = time[1];\n\n              for(var i = +timeStart.split(\":\")[0]; i < +timeEnd.split(\":\")[0]; i++){\n                  if((i < parseInt(moment().add(2, 'hour').format(\"H\"))) && (selectedDate.format('DD') == moment().format('DD'))) {\n                      continue;\n                  }\n                  if(i === parseInt(curDate.format(\"H\"))){\n                      html += '<option value=\"' + i + '\" selected=\"selected\">' + dt.hour(i).format(\"H\") + ':00</option>';\n                  } else {\n                      html += '<option value=\"' + i + '\">' + dt.hour(i).format(\"H\") + ':00</option>';\n                  }\n              }\n              html += '</select></div>';\n              $('.ic__header').append(html);\n\n              $('.ic__time-select').change((e) => {\n                  var hour = $(e.currentTarget).val();\n                  var date = this.dateTime;\n                  if(date == \"\")\n                      date = moment().format('HH:mm DD.MM.YYYY');\n                  var selectedDate = moment(date, 'HH:mm DD.MM.YYYY');\n                  selectedDate.hour(hour);\n                  selectedDate.minute(0);\n                  selectedDate.second(0);\n                  this.dateTime = selectedDate.format('HH:mm DD.MM.YYYY');\n              });\n            }\n        });\n\t\t}\n\t}\n})\n\nVue.component(\"features\", {\n\tprops: {\n\t\trows: {\n\t\t\ttype: Array,\n\t\t\tdefault: []\n\t\t}\n\t},\n\ttemplate: '\\\n\t\t<div class=\"features\">\\\n\t\t\t<div class=\"features-list\">\\\n\t\t\t\t<div class=\"features-item\" v-for=\"row in rows\">\\\n\t\t\t\t\t<div class=\"features-item__title\">{{row.title}}</div>\\\n\t\t\t\t\t<div class=\"features-item__content\" v-html=\"row.content\"></div>\\\n\t\t\t\t</div>\\\n\t\t\t</div>\\\n\t\t</div>'\n});\n\nVue.component(\"city-select\", {\n\tdata: () => ({\n\t\tcurRegion: store.state.userRegionId || \"default\",\n\t\tcurCity: (store.state.userCity != \"\" ? store.state.userCity.id : \"default\"),\n\t\tisRegionSelected: (store.state.userRegionId != null ? true : false),\n\t\tisCitySelected: (store.state.userCity != \"\" ? true : false),\n\t}),\n\tcomputed: {\n\t\tregionsList: () => store.state.regionsData.regions,\n\t\tcitiesList () {\n\t\t\treturn store.state.regionsData.cities.filter((item) => item.regionId == this.curRegion)\n\t\t},\n\t},\n\tmounted(){\n\t\t// store.commit(\"checkLocation\");\n\n\t\t// this.curRegion = store.state.userRegionId || \"default\";\n\t\t// this.curCity = store.state.userCity != \"\" ? store.state.userCity.id : \"default\";\n\t},\n\tupdate() {\n\t\t$.fancybox.update();\n\t},\n\twatch: {\n\t\tcurRegion(val, oldVal){\n\t\t\tthis.isRegionSelected = true;\n\t\t\tthis.curCity = \"default\";\n\t\t},\n\t\tcurCity(val, oldVal){\n\t\t\tif (val == \"default\")\n\t\t\t\tthis.isCitySelected = false;\n\t\t\telse\n\t\t\t\tthis.isCitySelected = true;\n\t\t}\n\t},\n\tmethods: {\n\t\tselectCity() {\n\t\t\tconst targetCity = store.state.regionsData\n\t\t\t.cities.filter(item => item.id == this.curCity)[0];\n\n\t\t\tstore.commit(\"setMainCity\", targetCity);\n\n\t\t\tstore.commit(\"setMainRegion\", this.curRegion);\n\t\t\tapp.showMessage(\"Город успешно выбран\", {\n\t\t\t\tclass: \"notify\",\n\t\t\t\ttime: 2000\n\t\t\t});\n\n\t\t\t$.fancybox.close();\n\n\t\t\t//location.reload();\n\t\t\t\t\n\t\t\tif (targetCity.subdomain)\n\t\t\t\twindow.location.host = `${targetCity.subdomain}.vinsklad.ru`;\n\t\t\telse\n\t\t\t\twindow.location.host = \"vinsklad.ru\"\n\t\t}\n\t},\n\ttemplate: '\\\n\t\t<div class=\"forms__input-wrap\">\\\n          <div class=\"forms-input-cont\">\\\n              <select v-model=\"curRegion\" name=\"regionSelect\" class=\"forms__select\">\\\n\t\t\t\t<option value=\"default\" disabled>Выберите регион</option>\\\n                <option v-for=\"region in regionsList\" :value=\"region.id\">{{region.name}}</option>\\\n              </select>\\\n             <label for=\"form-name\" class=\"forms-label forms__label\">Область</label>\\\n          </div>\\\n          <div v-if=\"isRegionSelected\" class=\"forms-input-cont\">\\\n              <select v-model=\"curCity\" name=\"citySelect\" class=\"forms__select\">\\\n                  <option value=\"default\" disabled>Выберите город</option>\\\n                  <option v-for=\"city in citiesList\" :value=\"city.id\">{{city.name}}</option>\\\n              </select>\\\n             <label for=\"form-name\" class=\"forms-label forms__label\">Город</label>\\\n          </div>\\\n          <div v-if=\"isCitySelected\" style=\"width: 100%; justify-content: center;\" class=\"forms__submit\">\\\n            <a @click=\"selectCity()\" class=\"btn btn-form\">Да</a>\\\n          </div>\\\n        </div>\\\n    '\n});\n\nVue.component(\"shops\", {\n\tprops: {\n\t\tisContacts: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t}\n\t},\n\tdata: () => ({\n\t\tsearch__input: \"\",\n\t\tisRegionSelected: Cookies.getJSON(\"userRegionId\") ? true : false,\n\t\tisCitySelected: Cookies.getJSON(\"_userCity\") ? true : false,\n\t\tviewType: Cookies.get(\"shopsViewType\") || \"dist\",\n\t\tcurRegion: +Cookies.getJSON(\"userRegionId\") || \"default\",\n\t\tcurCity: (Cookies.getJSON(\"_userCity\") ? +Cookies.getJSON(\"_userCity\").id : \"default\"),\n\t\tcurShop: (Cookies.getJSON(\"mainShop\") ? +Cookies.getJSON(\"mainShop\").id : null),\n\t\tsrollPane: null,\n\t\tmap: null,\n\t\tmapId: \"shops-map\"+Math.random(),\n\t\tradioPrefix: Math.random(),\n\t\tisKart: window.ostatki ? true : false,\n\t}),\n\twatch: {\n\t\tsearch__input(val, oldVal){\n\t\t\t//this.scrollPane.reinitialise();\n\t\t},\n\t\tviewRadio(val, oldVal){\n\t\t\tif (val == oldVal)\n\t\t\t\treturn\n\n\t\t\t\n\t\t},\n\t\tcurRegion(val, oldVal){\n\t\t\tif (val == oldVal)\n\t\t\t\treturn\n\n\t\t\t//store.commit(\"setMainRegion\", val);\n\n\t\t\tthis.isRegionSelected = true;\n\t\t\tthis.isCitySelected = false;\n\t\t\tthis.curCity = \"default\";\n\t\t},\n\t\tcurCity(val, oldVal){\n\t\t\tif (val == oldVal || val == \"default\")\n\t\t\t\treturn\n\n\t\t\t// console.log(this.viewType);\n\n\t\t\tif (this.viewType == \"map\"){\n\t\t\t\t// this.destroyMap();\n\t\t\t\t// console.log(this.viewType);\n\t\t\t\t// this.viewType = \"map\";\n\t\t\t\tthis.reinitMap();\n\t\t\t}\n\n\t\t\t// console.log(this.viewType);\n\n\t\t\t//store.commit(\"setMainCity\", (this.citiesList.filter((item) => item.id == this.curCity))[0]);\n\n\t\t\t//this.isCitySelected = true;\n\t\t\tthis.update()\n\t\t},\n\t\tviewType (val, oldval) {\n\t\t\tswitch (val){\n\t\t\t\tcase \"map\":\n\t\t\t\t\tthis.initMap();\n\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tthis.sort();\n\t\t\t\t\t//this.initScroll();\n\t\t\t}\n\t\t},\n\t},\n\tmounted (){\n\t\t// console.log(this.ostatki);\n\n\t\t// $(\".shops-view__one:nth-child(2) label\").trigger(\"click\");\n\n\t\t// this.sort();\n\n\t\tif (this.isContacts)\n\t\t\tthis.viewType = \"map\";\n\n\t\t// $(\".shops-view__one:first-child label\").trigger(\"click\");\n\n\t\t// for (let i in this.filteredList)\n\t\t\t// console.log(this.filteredList[i].address);\n\n\t\t// this.initScroll();\n\t\tthis.sort();\n\n\t\t//this.scrollPane.reinitialise();\n\t},\n\tupdated () {\n\t\t// if ($(\".shops-list__list\").length && this.scrollPane == null){\n\t\t// \tthis.scrollPane = $(\".shops-list__list\").jScrollPane();\n\t\t// \tthis.scrollPane = this.scrollPane.data(\"jsp\");\n\t\t// }else if ($(\".shops-list__list\").length){\n\t\t// \tthis.scrollPane.reinitialise()\n\t\t// }else if (!$(\".shops-list__list\").length)\n\t\t// \tthis.scrollPane = null\n\n\t\t$.fancybox.update();\n\t},\n\tmethods: {\n\t\tinitScroll(){\n\t\t\t// this.scrollPane = $(this.$el).find(\".shops-list__list\").jScrollPane();\n\n\t\t\t// this.scrollPane = this.scrollPane.data(\"jsp\");\n\n\t\t\t// this.scrollPane.reinitialise();\n\t\t},\n\t\tdestroyMap() {\n\t\t\t// console.log(this.map);\n\t\t\t// this.map.destructor();\n\t\t},\n\t\treinitMap() {\n\t\t\t// this.map.removeAll();\n\t\t\tvar coords = [], center = [0, 0], lat = 0, lng = 0;\n\n\t\t\tfor (var i in this.shopsList){\n\t\t\t\tlet shop = this.shopsList[i];\n\n\t\t\t\tif (!parseInt(this.ostatki[shop.xml_id]) && this.ostatki.length)\n\t\t\t\t\t\tcontinue\n\n\t\t\t\tif (!isNaN(parseFloat(shop.lat)) && !isNaN(parseFloat(shop.lat))){\n\t\t\t\t\tcoords.push([parseFloat(shop.lat), parseFloat(shop.lng)]);\n\t\t\t\t\tlat += parseFloat(shop.lat);\n\t\t\t\t\tlng += parseFloat(shop.lng);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet size = [$(this.$el).find(\".shops__map\").width(), $(this.$el).find(\".shops__map\").height()];\n\n\t\t\tlet zoom = ymaps.util.bounds.getCenterAndZoom(ymaps.util.bounds.fromPoints(coords), size);\n\n\t\t\t// this.map.setZoom(zoom.zoom+0.4);\n\n\t\t\tthis.map.setCenter(zoom.center, zoom.zoom);\n\n\t\t\tvar objects = [], cluster = new ymaps.Clusterer({\n\t\t\t\t\tpreset: 'islands#nightClusterIcons',\n\t\t\t\t\tclusterIconColor: \"#e31e24\",\n\t\t\t\t\thasBalloon: false,\n\t\t\t\t\tgridSize: 80,\n\t\t\t\t}),\n\t\t\tselectedID = false;\n\n\t\t\tfor (var i in this.shopsList){\n\t\t\t\tlet shop = this.shopsList[i];\n\n\t\t\t\tif (!parseInt(this.ostatki[shop.xml_id]) && this.ostatki.length)\n\t\t\t\t\t\tcontinue\n\n\t\t\t\tif (isNaN(parseFloat(shop.lat)) || isNaN(parseFloat(shop.lat)))\n\t\t\t\t\tcontinue\n\n\t\t\t\tif (shop.id != store.state.mainShop.id)\n\t\t\t\t\tshop.balloonContent = '\\\n\t\t\t\t\t\t<div class=\"shop-balloon\">\\\n\t\t\t\t\t\t\t<div class=\"shop-balloon__address\">'+shop.address+'</div>\\\n\t\t\t\t\t\t\t<div class=\"shop-balloon__time\">'+shop.time+'</div>\\\n\t\t\t\t\t\t\t<div v-if=\"shop.id != store.state.mainShop.id\" class=\"shop-balloon__btn\">\\\n\t\t\t\t\t\t\t\t<span onclick=\"store.commit(\\'setMainShop\\', '+shop.id+')\" class=\"btn btn--rectangle shop-select\">Выбрать</span>\\\n\t\t\t\t\t\t\t</div>\\\n\t\t\t\t\t\t</div>\\\n\t\t\t\t\t';\n\t\t\t\telse\n\t\t\t\t\tshop.balloonContent = '\\\n\t\t\t\t\t\t<div class=\"shop-balloon\">\\\n\t\t\t\t\t\t\t<div class=\"shop-balloon__address\">'+shop.address+'</div>\\\n\t\t\t\t\t\t\t<div class=\"shop-balloon__time\">'+shop.time+'</div>\\\n\t\t\t\t\t\t</div>\\\n\t\t\t\t\t';\n\n\t\t\t\tvar placemark = new ymaps.Placemark(\n\t\t\t\t\t[parseFloat(shop.lat), parseFloat(shop.lng)],{\n\t\t\t\t\t\tballoonContent: shop.balloonContent,\n\t\t\t\t\t},{\n\t\t\t\t\t\ticonLayout: \"default#image\",\n\t\t\t\t\t\ticonImageHref: (shop.id != store.state.mainShop.id ? \"/local/templates/vinsklad2017/img/ico-marker.png\" : \"/local/templates/vinsklad2017/img/ico-selected-marker.png\"),\n\t\t\t\t\t\ticonImageSize: (shop.id != store.state.mainShop.id ? [32, 43] : [28, 33])\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tif (shop.id == store.state.mainShop.id)\n\t\t\t\t\tselectedID = {\n\t\t\t\t\t\tcoords: [parseFloat(shop.lat), parseFloat(shop.lng)]\n\t\t\t\t\t}\n\n\t\t\t\tobjects.push(placemark);\n\t\t\t}\n\n\t\t\tcluster.add(objects);\n\n\t\t\tthis.map.geoObjects.add(cluster);\n\n\t\t\tif (!selectedID){\n\t\t\t\tthis.map.setBounds(cluster.getBounds(), {\n\t                checkZoomRange: true\n\t            })\n\t        }else\n\t        \tthis.map.setCenter(selectedID.coords, 3);\n\n\t\t},\n\t\tinitMap () {\n\t\t\tvar coords = [], center = [0, 0], lat = 0, lng = 0;\n\n\t\t\t$(\".shops__map-map\").html(\"\");\n\n\t\t\tymaps.ready(() => {\n\n\t\t\t\tfor (var i in this.shopsList){\n\t\t\t\t\tlet shop = this.shopsList[i];\n\n\t\t\t\t\tif (!parseInt(this.ostatki[shop.xml_id]) && this.ostatki.length)\n\t\t\t\t\t\tcontinue\n\n\t\t\t\t\tif (!isNaN(parseFloat(shop.lat)) && !isNaN(parseFloat(shop.lng))){\n\t\t\t\t\t\tcoords.push([parseFloat(shop.lat), parseFloat(shop.lng)]);\n\t\t\t\t\t\tlat += parseFloat(shop.lat);\n\t\t\t\t\t\tlng += parseFloat(shop.lng);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// center = [lng/coords.length, lat/coords.length];\n\n\t\t\t\tcenter = ymaps.util.bounds.getCenter(ymaps.util.bounds.fromPoints(coords));\n\n\t\t\t\tthis.map = new ymaps.Map(this.mapId, {\n\t\t\t\t\tzoom: 11,\n\t\t\t\t\tcenter: center,\n\t\t\t\t\t// controls: ['fullscreenControl']\n\t\t\t\t});\n\n\t\t\t\tlet size = [$(this.$el).find(\".shops__map\").width(), $(this.$el).find(\".shops__map\").height()];\n\n\t\t\t\tlet zoom = ymaps.util.bounds.getCenterAndZoom(ymaps.util.bounds.fromPoints(coords), size);\n\n\t\t\t\tthis.map.setZoom(zoom.zoom+0.4);\n\n\t\t\t\tvar objects = [], cluster = new ymaps.Clusterer({\n\t\t\t\t\tpreset: 'islands#nightClusterIcons',\n\t\t\t\t\tclusterIconColor: \"#e31e24\",\n\t\t\t\t\thasBalloon: false,\n\t\t\t\t\tgridSize: 80,\n\t\t\t\t}),\n\t\t\t\tselectedID = false;\n\n\t\t\t\tfor (var i in this.shopsList){\n\t\t\t\t\tlet shop = this.shopsList[i];\n\n\t\t\t\t\tif (!parseInt(this.ostatki[shop.xml_id]) && this.ostatki.length)\n\t\t\t\t\t\tcontinue\n\n\t\t\t\t\tif (isNaN(parseFloat(shop.lat)) || isNaN(parseFloat(shop.lng)))\n\t\t\t\t\t\tcontinue\n\n\t\t\t\t\tif (shop.id != store.state.mainShop.id)\n\t\t\t\t\t\tshop.balloonContent = '\\\n\t\t\t\t\t\t\t<div class=\"shop-balloon\">\\\n\t\t\t\t\t\t\t\t<div class=\"shop-balloon__address\">'+shop.address+'</div>\\\n\t\t\t\t\t\t\t\t<div class=\"shop-balloon__time\">'+shop.time+'</div>\\\n\t\t\t\t\t\t\t\t<div class=\"shop-balloon__btn\">\\\n\t\t\t\t\t\t\t\t\t<span onclick=\"store.commit(\\'setMainShop\\', '+shop.id+')\" class=\"btn btn--rectangle shop-select\">Выбрать</span>\\\n\t\t\t\t\t\t\t\t</div>\\\n\t\t\t\t\t\t\t</div>\\\n\t\t\t\t\t\t'\n\t\t\t\t\telse\n\t\t\t\t\t\tshop.balloonContent = '\\\n\t\t\t\t\t\t\t<div class=\"shop-balloon\">\\\n\t\t\t\t\t\t\t\t<div class=\"shop-balloon__address\">'+shop.address+'</div>\\\n\t\t\t\t\t\t\t\t<div class=\"shop-balloon__time\">'+shop.time+'</div>\\\n\t\t\t\t\t\t\t</div>\\\n\t\t\t\t\t\t'\n\n\t\t\t\t\tvar placemark = new ymaps.Placemark(\n\t\t\t\t\t\t[parseFloat(shop.lat), parseFloat(shop.lng)],{\n\t\t\t\t\t\t\tballoonContent: shop.balloonContent,\n\t\t\t\t\t\t},{\n\t\t\t\t\t\t\ticonLayout: \"default#image\",\n\t\t\t\t\t\t\ticonImageHref: (shop.id != store.state.mainShop.id ? \"/local/templates/vinsklad2017/img/ico-marker.png\" : \"/local/templates/vinsklad2017/img/ico-selected-marker.png\"),\n\t\t\t\t\t\t\ticonImageSize: (shop.id != store.state.mainShop.id ? [32, 43] : [28, 33])\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\tif (shop.id == store.state.mainShop.id)\n\t\t\t\t\t\tselectedID = {\n\t\t\t\t\t\t\tcoords: [parseFloat(shop.lat), parseFloat(shop.lng)]\n\t\t\t\t\t\t}\n\n\t\t\t\t\tobjects.push(placemark);\n\t\t\t\t}\n\n\t\t\t\tcluster.add(objects);\n\n\t\t\t\tthis.map.geoObjects.add(cluster);\n\n\t\t\t\tif (!selectedID){\n\t\t\t\t\tthis.map.setBounds(cluster.getBounds(), {\n\t\t                checkZoomRange: true\n\t\t            })\n\t\t        }else\n\t\t        \tthis.map.setCenter(selectedID.coords, 16);\n\n\t\t\t\t});\n\n\t\t\t\n\t\t},\n\t\tsort (){\n\t\t\tswitch (this.viewType){\n\t\t\t\tcase \"alph\":\n\t\t\t\t\tthis.shopsList.sort((a, b) => {\n\t\t\t\t\t\tvar compA = a.address.toUpperCase();\n\t\t\t\t\t\tvar compB = b.address.toUpperCase();\n\n\t\t\t\t\t\treturn (compA < compB) ? -1 : (compA > compB) ? 1 : 0\n\t\t\t\t\t});\n\t\t\t\tbreak;\n\n\t\t\t\tcase \"dist\":\n\t\t\t\t\tthis.shopsList.sort((a, b) => {\n\t\t\t\t\t\treturn parseFloat(a.distance) - parseFloat(b.distance);\n\t\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// for (let i in this.filteredList){\n\t\t\t// \tlet shop = this.filteredList[i];\n\n\t\t\t// \tconsole.log(shop.distance)\n\t\t\t// }\n\t\t},\n\t\tsetViewMthod(method){\n\t\t\tif (method == \"map\"){\n\n\t\t\t}else{\n\t\t\t\t//this.initScroll();\n\t\t\t}\n\t\t\t//this.type = method;\n\t\t},\n\t\tsetMainShop() {\n\t\t\tstore.commit(\"setMainShop\", this.curShop);\n\t\t},\n\t\tupdate() {\n\t\t\tthis.isCitySelected = false;\n\t\t\tthis.isCitySelected = true;\n\t\t\tthis.sort();\n\t\t},\n\t},\n\tcomputed: {\n\t\tfilteredList (){\n\t\t\tthis.sort();\n\n\t\t\treturn this.shopsList.filter(item => ~item.address.toLowerCase()\n\t\t\t.indexOf(this.search__input.toLowerCase()));\n\t\t},\n\t\tregionsList: () => store.state.regionsData.regions,\n\t\tcitiesList () {\n\t\t\treturn store.state.regionsData.cities.filter(item => item.regionId == this.curRegion)\n\t\t},\n\t\tshopsList () {\n\t\t\tif (!this.isKart)\n\t\t\t\treturn store.state.shopsData.filter(item => item.cityId == this.curCity)\n\t\t\telse{\n\n\t\t\t\treturn store.state.shopsData.filter(item => {\n\t\t\t\t\tconsole.log(item.cityId, this.curCity, store.state.inStock[item.xml_id], item.xml_id);\n\n\t\t\t\t\treturn item.cityId == this.curCity && parseInt(this.ostatki[item.xml_id])\n\t\t\t\t})\n\t\t\t}\n\t\t},\n\t\tostatki (){\n\t\t\treturn store.state.inStock;\n\t\t},\n\t},\n\ttemplate: '\\\n\t\t<div class=\"shops\">\\\n\t\t\t<div class=\"shops__top\">\\\n\t\t\t\t<div v-if=\"$root.isShopsPopupOpened\" class=\"city-select\">\\\n\t\t\t\t\t<div>\\\n\t\t\t\t\t\t<select v-model=\"curRegion\" class=\"city-select__region\">\\\n\t\t\t\t\t\t\t<option value=\"default\" disabled>Выберите область</option>\\\n\t\t\t\t\t\t\t<option v-for=\"region in regionsList\" :value=\"region.id\">{{ region.name }}</option>\\\n\t\t\t\t\t\t</select>\\\n\t\t\t\t\t</div>\\\n\t\t\t\t\t<div>\\\n\t\t\t\t\t\t<select v-if=\"isRegionSelected\" v-model=\"curCity\" class=\"city-select__city\">\\\n\t\t\t\t\t\t\t<option value=\"default\" disabled>Выберите город</option>\\\n\t\t\t\t\t\t\t<option v-for=\"city in citiesList\" :value=\"city.id\">{{ city.name }}</option>\\\n\t\t\t\t\t\t</select>\\\n\t\t\t\t\t</div>\\\n\t\t\t\t</div>\\\n\t\t\t\t<div v-else class=\"city-select\">\\\n\t\t\t\t\t<select v-model=\"curRegion\" class=\"city-select__region\">\\\n\t\t\t\t\t\t<option value=\"default\" disabled>Выберите регион</option>\\\n\t\t\t\t\t\t<option v-for=\"region in regionsList\" :value=\"region.id\">{{ region.name }}</option>\\\n\t\t\t\t\t</select>\\\n\t\t\t\t\t<select v-if=\"isRegionSelected\" v-model=\"curCity\" class=\"city-select__city\">\\\n\t\t\t\t\t\t<option value=\"default\" disabled>Выберите город</option>\\\n\t\t\t\t\t\t<option v-for=\"city in citiesList\" :value=\"city.id\">{{ city.name }}</option>\\\n\t\t\t\t\t</select>\\\n\t\t\t\t</div>\\\n\t\t\t</div>\\\n\t\t\t<div v-if=\"isCitySelected\" class=\"shops-filter\">\\\n\t\t\t\t<div class=\"shops-filter__radio\">\\\n\t\t\t\t\t<div class=\"shops-view\">\\\n\t\t\t\t\t\t<div class=\"shops-view__one\">\\\n\t\t\t\t\t\t\t<input type=\"radio\"\\\n\t\t\t\t\t\t\t\tclass=\"shops-view__one-input\"\\\n\t\t\t\t\t\t\t\tvalue=\"dist\"\\\n\t\t\t\t\t\t\t\t:id=\"radioPrefix+\\'dist\\'\"\\\n\t\t\t\t\t\t\t\tv-model=\"viewType\"\\\n\t\t\t\t\t\t\t/>\\\n\t\t\t\t\t\t\t<label\\\n\t\t\t\t\t\t\t\t:for=\"radioPrefix+\\'dist\\'\"\\\n\t\t\t\t\t\t\t\tclass=\"shops-view__label\">\\\n\t\t\t\t\t\t\t\tПо удалённости\\\n\t\t\t\t\t\t\t</label>\\\n\t\t\t\t\t\t</div>\\\n\t\t\t\t\t\t<div v-if=\"false\" data=\"window.ostatki\" class=\"shops-view__one\">\\\n\t\t\t\t\t\t\t<input type=\"radio\"\\\n\t\t\t\t\t\t\t\tclass=\"shops-view__one-input\"\\\n\t\t\t\t\t\t\t\tvalue=\"count\"\\\n\t\t\t\t\t\t\t\t:id=\"radioPrefix+\\'dist\\'\"\\\n\t\t\t\t\t\t\t\tv-model=\"viewType\"\\\n\t\t\t\t\t\t\t/>\\\n\t\t\t\t\t\t\t<label\\\n\t\t\t\t\t\t\t\t:for=\"radioPrefix+\\'dist\\'\"\\\n\t\t\t\t\t\t\t\tclass=\"shops-view__label\">\\\n\t\t\t\t\t\t\t\tПо количеству\\\n\t\t\t\t\t\t\t</label>\\\n\t\t\t\t\t\t</div>\\\n\t\t\t\t\t\t<div v-if=\"!isKart || shopsList.length\" class=\"shops-view__one\">\\\n\t\t\t\t\t\t\t<input type=\"radio\"\\\n\t\t\t\t\t\t\t\tclass=\"shops-view__one-input\"\\\n\t\t\t\t\t\t\t\tvalue=\"map\"\\\n\t\t\t\t\t\t\t\t:id=\"radioPrefix+\\'view_map\\'\"\\\n\t\t\t\t\t\t\t\tv-model=\"viewType\"\\\n\t\t\t\t\t\t\t/>\\\n\t\t\t\t\t\t\t<label\\\n\t\t\t\t\t\t\t\t:for=\"radioPrefix+\\'view_map\\'\"\\\n\t\t\t\t\t\t\t\tclass=\"shops-view__label\">\\\n\t\t\t\t\t\t\t\tКарта \\\n\t\t\t\t\t\t\t</label>\\\n\t\t\t\t\t\t</div>\\\n\t\t\t\t\t\t<div class=\"shops-view__one\">\\\n\t\t\t\t\t\t\t<input type=\"radio\"\\\n\t\t\t\t\t\t\t\tclass=\"shops-view__one-input\"\\\n\t\t\t\t\t\t\t\tvalue=\"alph\"\\\n\t\t\t\t\t\t\t\t:id=\"radioPrefix+\\'alph\\'\"\\\n\t\t\t\t\t\t\t\tv-model=\"viewType\"\\\n\t\t\t\t\t\t\t/>\\\n\t\t\t\t\t\t\t<label\\\n\t\t\t\t\t\t\t\t:for=\"radioPrefix+\\'alph\\'\"\\\n\t\t\t\t\t\t\t\tclass=\"shops-view__label\">\\\n\t\t\t\t\t\t\t\tПо алфавиту\\\n\t\t\t\t\t\t\t</label>\\\n\t\t\t\t\t\t</div>\\\n\t\t\t\t</div>\\\n\t\t\t\t<div class=\"shops-filter__search\">\\\n\t\t\t\t\t<input v-if=\"viewType == \\'alph\\' || viewType == \\'dist\\'\" type=\"text\" class=\"shops-filter__search-input\"\\\n\t\t\t\t\t\tv-model=\"search__input\" placeholder=\"Поиск\" />\\\n\t\t\t\t</div>\\\n\t\t\t</div>\\\n\t\t\t<div v-if=\"isCitySelected && (viewType == \\'alph\\' || viewType == \\'dist\\')\" class=\"shops-list\">\\\n\t\t\t\t<ul class=\"shops-list__list\">\\\n\t\t\t\t\t<li v-if=\"!filteredList.length\" class=\"no-results\">По запросу ничего не найдено</li>\\\n\t\t\t\t\t<!--  -->\\\n\t\t\t\t\t<li v-if=\"!isKart || parseInt(ostatki[shop.xml_id])\" v-for=\"shop in filteredList\" class=\"shops-list__list-el\">\\\n\t\t\t\t\t\t<div class=\"radio\">\\\n\t\t\t\t\t\t\t<input\\\n\t\t\t\t\t\t\t\ttype=\"radio\"\\\n\t\t\t\t\t\t\t\t:name=\"radioPrefix+\\'_+curshop\\'\"\\\n\t\t\t\t\t\t\t\tclass=\"radio__input\"\\\n\t\t\t\t\t\t\t\t:id=\"radioPrefix+\\'_\\'+shop.id\"\\\n\t\t\t\t\t\t\t\tv-model=\"curShop\"\\\n\t\t\t\t\t\t\t\t:value=\"shop.id\"\\\n\t\t\t\t\t\t\t/>\\\n\t\t\t\t\t\t\t<label :for=\"radioPrefix+\\'_\\'+shop.id\" class=\"radio__label\">\\\n\t\t\t\t\t\t\t\t<div class=\"shops-list__list-address\">\\\n\t\t\t\t\t\t\t\t\t<span>{{ shop.address }}</span>&nbsp;<span v-if=\"shop.draftbeer ==\\'BEERRIVER\\'\" title=\"Есть разливное пиво\" class=\"shops-list__list-beer\"></span>\\\n\t\t\t\t\t\t\t\t</div>\\\n\t\t\t\t\t\t\t\t<div v-if=\"shop.time\" class=\"shops-list__list-time\"><span>{{ shop.time }}</span></div>\\\n\t\t\t\t\t\t\t\t<div v-if=\"shop.distance\" class=\"shops-list__list-dist\"><span>{{ shop.distance }} км</span></div>\\\n\t\t\t\t\t\t\t\t<div v-if=\"window.ostatki\" class=\"shops-list__list-dist\"><span>{{ ostatki[shop.xml_id] || 0 }} шт</span></div>\\\n\t\t\t\t\t\t\t</label>\\\n\t\t\t\t\t\t</div>\\\n\t\t\t\t\t</li>\\\n\t\t\t\t\t<li v-if=\"isKart && !shopsList.length\" class=\"no-results\">Товара нет в наличии</li>\\\n\t\t\t\t</ul>\\\n\t\t\t</div>\\\n\t\t\t<div v-show=\"isCitySelected && viewType == \\'map\\'\" class=\"shops__map\">\\\n\t\t\t\t<div :id=\"mapId\" class=\"shops__map-map\"></div>\\\n\t\t\t</div>\\\n\t\t\t<div v-if=\"curShop && (viewType == \\'alph\\' || viewType == \\'dist\\')\" class=\"shop-select__cont\">\\\n\t\t\t\t<span @click=\"setMainShop()\" class=\"btn btn--rectangle shop-select\">Выбрать</span>\\\n\t\t\t</div>\\\n\t\t</div>\\\n\t'\n});\n\nVue.component(\"checks-filter\", {\n\tprops: {\n\t\tlist: {\n\t\t\ttype: Array,\n\t\t\tdefault: []\n\t\t},\n\t\tinputName: {\n\t\t\ttype: String,\n\t\t\tdefault: \"checks\"\n\t\t}\n\t},\n\tdata: () => ({\n\t\tsearch__input: \"\",\n\t\ttoggleText: \"Развернуть\",\n\t}),\n\tcomputed: {\n\t\tfilteredItems (){\n\t\t\treturn this.list.filter(item => {\n\t\t\t\treturn ~item.name.toLowerCase().indexOf(this.search__input.toLowerCase())\n\t\t\t})\n\t\t}\n\t},\n\tmethods: {\n\t\ttoggleSearch() {\n\t\t\tthis.toggleText = (this.toggleText == \"Развернуть\" ? \"Свернуть\" : \"Развернуть\");\n\t\t}\n\t},\n\ttemplate: '\\\n\t\t<div class=\"filter-search\">\\\n\t\t\t<input type=\"text\" placeholder=\"Поиск по значениям\" v-model.trim=\"search__input\" class=\"filter-search__input\"/>\\\n\t\t\t<ul class=\"filter__checks filter__checks--search\">\\\n\t\t\t\t<li v-for=\"(item, i) in filteredItems\" class=\"filter__checks-el\">\\\n\t\t\t\t\t<div v-if=\"toggleText == \\'Свернуть\\' || i <= 5\" class=\"checkbox\">\\\n\t\t\t\t\t\t<input :id=\"inputName+i\" type=\"checkbox\" :name=\"inputName\" :checked=\"item.checked\" class=\"checkbox__input\"/>\\\n\t\t\t\t\t\t<label :for=\"inputName+i\" class=\"checkbox__label\">{{ item.name }}</label>\\\n\t\t\t\t\t</div>\\\n\t\t\t\t</li>\\\n\t\t\t</ul>\\\n\t\t\t<div v-if=\"filteredItems.length > 5\" class=\"filter-search__show\">\\\n\t\t\t\t<div @click=\"toggleSearch()\" class=\"filter-show-toggle\">{{ toggleText }}</div>\\\n\t\t\t</div>\\\n\t\t</div>'\n});\n\nVue.component(\"price-filter\", {\n\tprops: {\n\t\tmax: {\n\t\t\ttype: Number,\n\t\t\tdefault: 10000,\n\t\t},\n\t\tmin: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t\tminVal: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\t\tmaxVal: {\n\t\t\ttype: Number,\n\t\t\tdefault: 10000\n\t\t},\n\t\tstep: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0.5\n\t\t},\n\t\tminName: {\n\t\t\ttype: String,\n\t\t\tdefault: \"min\"\n\t\t},\n\t\tmaxName: {\n\t\t\ttype: String,\n\t\t\tdefault: \"max\"\n\t\t}\n\t},\n\tdata: () => ({\n\t\tmaxValue: 0,\n\t\tminValue: 0,\n\t\t$this: null,\n\t\t$range: null\n\t}),\n\tmounted (){\n\t\tthis.$this = $(this.$el);\n\n\t\tthis.minValue = +this.minVal;\n\t\tthis.maxValue = +this.maxVal;\n\n\t\tthis.initSlider();\n\t},\n\ttemplate: '\\\n\t\t<div class=\"price-filter\">\\\n\t\t\t<div class=\"input-group\">\\\n\t\t\t\t<input type=\"tel\" v-model.number=\"minValue\" :name=\"minName\" class=\"catalog-filter__input input-group__input\"/>\\\n\t\t\t\t<input type=\"tel\" v-model.number=\"maxValue\" :name=\"maxName\" class=\"catalog-filter__input input-group__input\"/>\\\n\t\t\t</div>\\\n\t\t\t<i class=\"price-filter__range range\"></i>\\\n\t\t</div>\\\n\t',\n\twatch: {\n\t\tmaxValue (val, oldVal) {\n\t\t\tthis.$range.slider(\"values\", 1, val);\n\t\t},\n\t\tminValue (val, oldVal) {\n\t\t\tthis.$range.slider(\"values\", 0, val);\n\t\t}\n\t},\n\tmethods: {\n\t\tinitSlider () {\n\t\t\tvar self = this;\n\n\t\t\tthis.$range = this.$this.find(\".range\").slider({\n\t\t\t\tanimate: \"normal\",\n\t\t\t\tmin: +self.min,\n\t\t\t\tmax: +self.max,\n\t\t\t\tvalues: [+self.minValue, +self.maxValue],\n\t\t\t\trange: true,\n\t\t\t\tstep: +self.step,\n\t\t\t\tslide: (e, ui) =>{\n\t\t\t\t\tself.minValue = ui.values[0];\n\t\t\t\t\tself.maxValue = ui.values[1];\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n})\n\nvar log = (str) => {\n\tconsole.log(str)\n},\nloadScripts = () => {\n\t$(\".fancybox\").fancybox({\n\t\tbeforeShow (){\n\t\t\t$(\"body\").addClass(\"fancy-active\")\n\t\t},\n\t\tafterClose (){\n\t\t\t$(\"body\").removeClass(\"fancy-active\")\t\n\t\t}\n\t});\n\n\t$(\"body\").on(\"click\", \".mobile-head__top .head__shop-city\", () => {\n\t\tapp.showCityPopup();\n\t});\n\n\t$(\"body\").on(\"click\", \".mobile-head__top .head__shop-address .address\", () => {\n\t\tapp.showShopPopup();\n\t});\n\n\t$(\"body\").on(\"click\", \".mobile-head__top .head__shop-address .delete\", () =>{\n\t\tstore.commit(\"deleteMainShop\");\n\t\tlocation.reload()\n\t});\n\n\t$(\".main-slider\").slick({\n\t\tslide: \".main-slider__slide\",\n\t\tslidesToShow: 1,\n\t\tslidesToScroll: 1,\n\t\tarrows: true,\n\t\tspeed: 400,\n\t\tautoplay: true,\n\t\t// lazyLoad: \"progressive\",\n\t\tautoplaySpeed: 4000\n\t});\n\n\t$(\".anketa_new-slider\").slick({\n\t\tslide: \".anketa_new-slide\",\n\t\tslidesToShow: 1,\n\t\tslidesToScroll: 1,\n\t\tarrows: true,\n\t\tspeed: 400,\n\t\tautoplay: true,\n\t\t// lazyLoad: \"progressive\",\n\t\tautoplaySpeed: 2000\n\t});\n\n\t$(\".tabs__tab\").click(function(){\n\t\tvar $this = $(this);\n\n\t\tif ($(this).hasClass(\"active\"))\n\t\t\treturn\n\n\t\tvar id = +$this.attr(\"data-id\"),\n\t\t\t$parent = $this.closest(\".tabs\");\n\n\t\t$parent.find(\".tabs__tab.active, .tabs-content.active\").removeClass(\"active\");\n\n\t\t$parent.find(\".tabs__tab[data-id='\"+id+\"'], .tabs-content[data-id='\"+id+\"']\").addClass(\"active\");\n\n\t});\n\n\t$(\".cat-slider\").slick({\n\t\tslidesToShow: 4,\n\t\tslidesToScroll: 1,\n\t\tslide: \".cat-slider__slide\",\n\t\tautoplay: true,\n\t\tautoplaySpeed: 3000,\n\t\tresponsive: [\n\t\t\t{\n\t\t\t\tbreakpoint: 1000,\n\t\t\t\tsettings: {\n\t\t\t\t\tslidesToShow: 3,\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tbreakpoint: 820,\n\t\t\t\tsettings: {\n\t\t\t\t\tslidesToShow: 2,\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tbreakpoint: 660,\n\t\t\t\tsettings: {\n\t\t\t\t\tslidesToShow: 1,\n\t\t\t\t}\n\t\t\t}\n\t\t]\n\t});\n\n\t// слайдер в карточке товвара\n\t$(\".another .cat-plate\").slick({\n\t\tslidesToShow: 3,\n\t\tslidesToScroll: 1,\n\t\tslide: \".cat-plate__one-wrap\",\n\t\tresponsive: [\n\t\t\t{\n\t\t\t\tbreakpoint: 820,\n\t\t\t\tsettings: {\n\t\t\t\t\tslidesToShow: 2,\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tbreakpoint: 660,\n\t\t\t\tsettings: {\n\t\t\t\t\tslidesToShow: 1,\n\t\t\t\t}\n\t\t\t}\n\t\t]\n\t});\n\n\t$(\".bot-text__btn\").click(function(){\n\t\t$(this).toggleClass(\"active\");\n\t\t$(this).parent(\".bot-text\").toggleClass(\"active\");\n\t});\n\n\t$(\".catalog-nav__current\").click(function(){\n\t\tvar $this = $(this);\n\n\t\t$this.next(\".catalog-nav__list\").slideToggle(300);\n\t});\n\n\t$('.catalog-filter__button').click(function(){\n\t\tvar $this = $(this);\n\n\t\t$this.next('.catalog-filter__bock').slideToggle(300);\n\t});\n\n\t$(\".filter-block__title\").click(function(){\n\t\tvar $this = $(this);\n\n\t\t$this.next(\".filter-block__content\").slideToggle(300);\n\n\t\tsetTimeout(() =>{\n\t\t\t$this.parent(\".filter-block\").toggleClass(\"closed\");\n\t\t}, 290);\n\n\t});\n\n\t$('.catalog__filter-btn').click(function() {\n\t\t$('.catalog-filter__bock').slideToggle('slow');\n\t});\n\n\n\t$(\".price-filter\").each((i, el)=>{\n\t\tvar $this = $(el);\n\n\t\tvar step = +$this.attr(\"data-step\"),\n\t\t\t$min = $this.find(\"input[data-min]\"),\n\t\t\t$max = $this.find(\"input[data-max]\");\n\n\t\tvar min = +$min.attr(\"data-min\"),\n\t\t\tmax = +$max.attr(\"data-max\");\n\n\t\tvar $range = $this.find(\".range\").slider({\n\t\t\tanimate: \"normal\",\n\t\t\tmin: min,\n\t\t\tmax: max,\n\t\t\tvalues: [$min.val(), $max.val()],\n\t\t\trange: true,\n\t\t\tstep: step,\n\t\t\tslide: (e, ui) =>{\n\t\t\t\t$min.val(ui.values[0]);\n\t\t\t\t$max.val(ui.values[1]);\n\t\t\t},\n\t\t\tchange(e, ui){\n\t\t\t\tsmartFilter.reload($min[0])\n\t\t\t},\n\t\t});\n\n\t\t$this.find(\"input[type='tel']\").on(\"keyup\", function(){\n\t\t\tvar id, val;\n\n\t\t\tif ($(this).attr(\"data-min\")){\n\t\t\t\tid = 0;\n\t\t\t\tval = (+$(this).val() < min ? min : +$(this).val());\n\t\t\t}else if ($(this).attr(\"data-max\")){\n\t\t\t\tid = 1;\n\t\t\t\tval = (+$(this).val() > max ? max : +$(this).val());\n\t\t\t}\n\n\t\t\t$range.slider(\"values\", id, val);\n\t\t})\n\t});\n\n\t$('.tovar-slider').slick({\n\t\tslide: '.tovar-slider__slide',\n\t\tslidesToShow: 1,\n\t\tslidesToScroll: 1,\n\t\tarrows: false,\n\n\t});\n\n\t$('.vacancy__item-header').click(function() {\n\t \t$(this).next().slideToggle('slow');\n\t \t$(this).toggleClass('active');\n\t});\n\n\t$('#menu-toggle').click(function(){\n\t\t$(this).toggleClass('open');\n\t\t$('body').toggleClass(\"mobile-menu--open\");\n\t});\n\n\t$('.catalog__filter-btn').click(function(){\n\t\t$(this).toggleClass('filter-open');\n\t\t$('catalog-nav').slideToggle('slow');\n\t});\n\n\n\tif($('body').hasClass('inner')) {\n\t\t$('.head__menu').each(function(i, el){\n\t\t\tlet $this = $(this);\n\n\t\t\tvar title = 'Каталог',\n\t\t\t\tcatalogMenu = \"\";\n\n\t\t\t$this.find('.menu__link').each(function(){\n\t\t\t\tcatalogMenu += '<li class=\"submenu__el\">\\\n\t\t\t\t\t\t<a href=\"'+$(this).attr(\"href\")+'\" class=\"submenu__link\">'+$(this).text()+'</a>\\\n\t\t\t\t</li>'\n\t\t\t});\n\n\t\t\t$(\".mobile-menu\").append('<li class=\"mobile-menu__el\">\\\n\t       \t\t<span class=\"mobile-menu__link sub\">'+title+'</span>\\\n\t       \t\t<ul class=\"submenu\"><li class=\"submenu__el submenu__back\">Назад</li>'+catalogMenu+'</ul>\\\n\t       \t</li>')\n\n\t\t});\n\n\n\t};\n\n\n\n\t$(\".footer-menu__cont\").each((i, el) =>{\n    let $this = $(el);\n\n    var title = $this.find(\".footer-menu__title\").text(),\n   \t\tsubmenu = \"\";\n\n   \t$this.find(\".footer-menu__link\").each((i, el) =>{\n   \t\tlet $this = $(el);\n\n      submenu += '<li class=\"submenu__el\">\\\n\t\t\t<a href=\"'+$this.attr(\"href\")+'\" class=\"submenu__link\">'+$this.text()+'</a>\\\n\t\t</li>'\n   \t});\n\n\n   \t$(\".mobile-menu\").append('<li class=\"mobile-menu__el\">\\\n   \t\t<span class=\"mobile-menu__link sub\">'+title+'</span>\\\n   \t\t<ul class=\"submenu\"><li class=\"submenu__el submenu__back\">Назад</li>'+submenu+'</ul>\\\n   \t</li>')\n\n\t});\n\n  $('.catalog-nav').each((i, el) =>{\n  \tlet $this = $(el);\n\n  \tvar title = 'Категории',\n  \tcategoryList = \"\";\n\n  \t$this.find('.catalog-nav__list-link').each((i, el) => {\n  \t\tlet $this = $(el);\n\n  \t\tcategoryList += '<li class=\"submenu__el\">\\\n\t\t\t\t<a href=\"'+$this.attr(\"href\")+'\" class=\"submenu__link\">'+$this.text()+'</a>\\\n\t\t\t</li>'\n  \t});\n\n  \t$(\".mobile-menu\").append('<li class=\"mobile-menu__el\">\\\n       \t\t<span class=\"mobile-menu__link sub\">'+title+'</span>\\\n       \t\t<ul class=\"submenu\"><li class=\"submenu__el submenu__back\">Назад</li>'+categoryList+'</ul>\\\n       \t</li>')\n\n  });\n\n\t$('.head__top').clone().addClass(\"mobile-head__top\").appendTo('.menu-mobile__wrap');\n\t$('.msgs').clone().removeClass(\"msgs\").addClass(\"mobile-menu__message\").appendTo('.menu-mobile__wrap');\n\n\tif($(window).width() < 820) {\n\n\t\tvar fooerSoc = $('.footer__soc .soc').clone().removeClass('soc').addClass('js__mobile-soc');\n\t\t$('.mobile-menu__message').prepend(fooerSoc);\n\t};\n\t\n\n\t$(\"body\").on(\"click\", \".mobile-menu__link.sub, .submenu__back\", function(){\n\t\tlet $this = $(this);\n\n\t\t$this.closest('.mobile-menu__el').toggleClass('submenu-open');\n\n\t});\n\n\t$(\".to-full\").click(e =>{\n\t\tCookies.set(\"full-version\", 1);\n\t\tlocation.reload();\n\t});\n\n\t$(\".to-mobile\").click(e => {\n\t\tCookies.remove(\"full-version\");\n\t\tlocation.reload();\n\t});\n\n\t$('input[type=\"file\"]').change(function(){\n\t\tvar value = $(this)[0].files[0].name;\n\t\t$(this).prev('.forms__input--file-support').val(value);\n\t\t$(this).next('.forms__input--file-support').val(value);\n\t});\n\n\n\tif ($(\"html\").hasClass(\"bx-ie\")){\n\t\t$(\".main-news__important\").css({\n\t\t\theight: \"auto\"\n\t\t});\n\t\t$(\".main-news\").css({\n\t\t\t\"min-height\": $(\".main-news__important\").height()\n\t\t});\n\t}\n\n\t$(\".main-slider__slide\").each((i, el) => {\n\t\tlet $this = $(el);\n\n\t\tif ($this.find(\".main-slider__slide-title\").text() == \"\")\n\t\t\t$this.addClass(\"js__empty\");\n\t});\n\n\n\t$(\".catalog\").prepend('<div class=\"js__dop-info\"></div>');\n\n\t$(\".title-block__cont\").clone().addClass(\"js__title\").appendTo(\".js__dop-info\");\n\n\t// $('.status-price-1').closest('.cat-plate__price, .cat-list__price').addClass('max');\n\n\n\n\t$('body').on('touchstart touchmove touchend', 'span.ui-slider-handle', function (event) {\n\t    //mousevents to simulate on touch\n\t    var touchEvents = {\n\t        touchstart: 'mousedown',\n\t        touchmove: 'mousemove',\n\t        touchend: 'mouseup'\n\t    };\n\n\t    //get element and type of event to simulate\n\t    var simulatedEvent = touchEvents[event.originalEvent.type],\n\t        touch = event.originalEvent.changedTouches[0],\n\t        mouseEvent = document.createEvent('MouseEvent');\n\n\t    //return if no mouse event is matched\n\t    if (typeof simulatedEvent === 'undefined') {\n\t        return;\n\t    }\n\n\t    //init the mousevent if we have a matched event\n\t    mouseEvent.initMouseEvent(\n\t        simulatedEvent, //type\n\t        true, //bubbles \n\t        true, //cancelable \n\t        window, //view \n\t        1, //detail \n\t        touch.screenX, //screenX\n\t        touch.screenY, //screenY\n\t        touch.clientX, //clientX\n\t        touch.clientY, //clientY\n\t        false, //ctrlKey\n\t        false, //altKey\n\t        false, //shiftKey\n\t        false, //metaKey\n\t        0, //button\n\t        null //related target\n\t    );\n\n\t    //dispatch event on touched element\n\t    touch.target.dispatchEvent(mouseEvent);\n\t    event.preventDefault();\n\t});\n\n\n\t\n}\n\nvar getDistanceFromLatLonInKm = (lat1,lon1,lat2,lon2) => {\n  var R = 6371; // Radius of the earth in km\n  var dLat = deg2rad(lat2-lat1);  // deg2rad below\n  var dLon = deg2rad(lon2-lon1);\n  var a =\n    Math.sin(dLat/2) * Math.sin(dLat/2) +\n    Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) *\n    Math.sin(dLon/2) * Math.sin(dLon/2)\n    ;\n  var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\n  var d = R * c; // Distance in km\n  return d;\n},\ndeg2rad = (deg) => {\n  return deg * (Math.PI/180)\n}\n\n\n\ndocument.addEventListener(\"DOMContentLoaded\", function(){\n\tif (!document.body.classList.contains(\"mobile-app\") && !is.ios())\n\t\t$.smartbanner({\n\t\t\ttitle: \"Винный склад\",\n\t\t\tappStoreLanguage: \"ru\",\n\t\t\tbutton: \"Установить\",\n\t\t\tprice: \"\",\n\t\t\ticon: \"/local/templates/vinsklad2017/img/app-icon.jpg\",\n\t\t});\n\n\t;(function () {\n\t\tconst iosApp = \"https://apps.apple.com/ru/app/винный-склад/id1450252717\",\n\t\t\tandroidApp = \"https://play.google.com/store/apps/details?id=us.startmobile.vinestore&hl=ru\",\n\t\t\tappLink = document.querySelector(\".app-wrapper\");\n\n\t\tif (!appLink)\n\t\t\treturn;\n\n\t\tif (is.ios())\n\t\t\tappLink.setAttribute(\"href\", iosApp)\n\t\telse\n\t\t\tappLink.setAttribute(\"href\", androidApp)\n\t})()\n})"]}
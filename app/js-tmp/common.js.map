{"version":3,"sources":["common.js"],"names":["momentLast","Date","now","window","frameCacheVars","undefined","BX","addCustomEvent","json","loadApp","ready","$","Vue","use","Vuex","store","Store","state","userRegionId","Cookies","getJSON","userCity","mainShop","localStorage","shopsDataLast1","JSON","parse","getItem","filter","item","id","regionsData","shopsData","userPosition","inStock","ostatki","showCityPopup","mutations","deleteMainShop","remove","setMainRegion","newRegionId","set","expires","setMainCity","newCity","commit","setMainShop","shop","cityId","regionId","cities","tmpShop","xml_id","location","reload","loadData","ajax","url","type","data","success","response","i","isNaN","parseFloat","lat","lng","distance","getDistanceFromLatLonInKm","LAT","LNG","toFixed","sort","a","b","compA","address","toUpperCase","compB","setItem","e","console","log","checkLocation","findedRegion","regions","region","name","REGION","replace","length","app","$refs","citySelect","curRegion","findedCity","city","CITY","setTimeout","curCity","get","on","html","showAgeConfirm","el","headMessage","headMessageShow","headMessageClass","isShopsPopupOpened","mounted","uploadInputmask","shopsDataLast","removeItem","loadScripts","computed","cityPopup","methods","fancybox","href","closeBtn","closeClick","helpers","overlay","keys","close","beforeShow","addClass","afterShow","afterClose","removeClass","showMessage","text","options","resolve","class","time","hideCityPopup","getCurShopTime","split","showShopPopup","self","isClosable","update","component","props","required","Boolean","default","dateTime","append","toggle","openCalendar","todayDate","moment","ionStartDate","format","hour","add","curYear","nextYear","ionCalendar","lang","sundayFirst","years","hideArrows","startDate","onClick","date","cart_calendar_hours","val","curDate","locale","minute","second","millisecond","selectedDate","diff","onReady","dt","timeStart","timeEnd","parseInt","change","currentTarget","rows","Array","template","isRegionSelected","isCitySelected","regionsList","citiesList","watch","oldVal","selectCity","isContacts","search__input","viewType","curShop","srollPane","map","mapId","Math","random","radioPrefix","isKart","viewRadio","reinitMap","oldval","initMap","updated","initScroll","destroyMap","coords","center","shopsList","push","size","$el","find","width","height","zoom","ymaps","util","bounds","getCenterAndZoom","fromPoints","setCenter","objects","cluster","Clusterer","preset","clusterIconColor","hasBalloon","gridSize","selectedID","balloonContent","placemark","Placemark","iconLayout","iconImageHref","iconImageSize","geoObjects","setBounds","getBounds","checkZoomRange","getCenter","Map","setZoom","setViewMthod","method","filteredList","toLowerCase","indexOf","list","inputName","String","toggleText","filteredItems","toggleSearch","max","Number","min","minVal","maxVal","step","minName","maxName","maxValue","minValue","$this","$range","initSlider","slider","animate","values","range","slide","ui","str","slick","slidesToShow","slidesToScroll","arrows","speed","autoplay","autoplaySpeed","click","hasClass","attr","$parent","closest","responsive","breakpoint","settings","toggleClass","parent","next","slideToggle","each","$min","$max","smartFilter","title","catalogMenu","submenu","categoryList","clone","appendTo","fooerSoc","prepend","value","files","prev","css","event","touchEvents","touchstart","touchmove","touchend","simulatedEvent","originalEvent","touch","changedTouches","mouseEvent","document","createEvent","initMouseEvent","screenX","screenY","clientX","clientY","target","dispatchEvent","preventDefault","lat1","lon1","lat2","lon2","R","dLat","deg2rad","dLon","sin","cos","c","atan2","sqrt","d","deg","PI"],"mappings":"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","file":"common.js","sourcesContent":["var momentLast = Date.now();\r\n\r\nif (window.frameCacheVars !== undefined)\r\n    BX.addCustomEvent(\"onFrameDataReceived\" , (json) => {\r\n    \tloadApp();\r\n    });\r\nelse if (typeof(BX) != \"undefined\")\r\n    BX.ready(() => {\r\n    \tloadApp();\r\n    })\r\nelse\r\n\t$(() => {\r\n\t\tloadApp();\r\n\t})\r\n\r\nconst loadApp = () =>{\r\n\r\n\r\n\t// $('.wrapper-index-top .main-slider__cont').css({\r\n\t// \t'max-height': $('.head__menu .menu').outerHeight()\r\n\t// })\r\n\r\n\t// if($(window).width() < 1000){\r\n\t// \t$(window).resize(function(){\r\n\t// \t\t$('.wrapper-index-top .main-slider__cont').css({\r\n\t// \t\t\t'max-height': $('.head__menu .menu').outerHeight()\r\n\t// \t\t})\r\n\t// \t});\r\n\t// }\r\n\r\n\r\n\t\r\n\r\n\r\n\tVue.use(Vuex)\r\n\twindow.store = new Vuex.Store({\r\n\t\tstate: { \r\n\t\t\tuserRegionId: +Cookies.getJSON(\"userRegionId\") || null,\r\n\t\t\tuserCity: Cookies.getJSON(\"userCity\") || \"\",\r\n\t\t\tmainShop: localStorage && localStorage.shopsDataLast1 && Cookies.getJSON(\"mainShop\") ? JSON.parse(localStorage.getItem(\"shopsDataLast1\"))\r\n\t\t\t\t.filter(item => item.id == Cookies.getJSON(\"mainShop\").id)[0] : \"\",\r\n\t\t\tregionsData : localStorage && localStorage.regionsData ? JSON.parse(localStorage.getItem('regionsData')) : {},\r\n      shopsData : localStorage && localStorage.shopsDataLast1 ? JSON.parse(localStorage.getItem('shopsDataLast1')) : {},\r\n\t\t\tuserPosition: Cookies.getJSON(\"geolocation\") || false,\r\n\t\t\tinStock: window.ostatki ? JSON.parse(window.ostatki) : [],\r\n\t\t\tshowCityPopup: false,\r\n\t\t},\r\n\t\tmutations: {\r\n\t\t\tdeleteMainShop (state) {\r\n\t\t\t\tstate.mainShop = {};\r\n\r\n\t\t\t\tCookies.remove(\"mainShop\");\r\n\t\t\t},\r\n\t\t\tsetMainRegion (state, newRegionId) {\r\n\t\t\t\tstate.userRegionId = newRegionId;\r\n\t\t\t\tCookies.set(\"userRegionId\", newRegionId, {expires: 30});\r\n\t\t\t},\r\n\t\t\tsetMainCity (state, newCity) {\r\n\t\t\t\tif (state.userCity != newCity)\r\n\t\t\t\t\tthis.commit(\"deleteMainShop\");\r\n\r\n\t\t\t\tstate.userCity = newCity;\r\n\t\t\t\tCookies.set(\"userCity\", JSON.stringify(newCity), {expires: 30});\r\n\r\n\r\n\t\t\t},\r\n\t\t\tsetMainShop (state, id) {\r\n\t\t\t\tlet shop = state.shopsData.filter(item => item.id == id)[0],\r\n\t\t\t\t\tcityId = shop.cityId,\r\n\t\t\t\t\tregionId = state.regionsData.cities.filter(item => item.id == cityId)[0].regionId;\r\n\r\n\t\t\t\tstore.commit(\"setMainRegion\", regionId);\r\n\r\n\t\t\t\tstore.commit(\"setMainCity\", state.regionsData.cities.filter(item => \r\n\t\t\t\t\titem.id == cityId)[0]\r\n\t\t\t\t);\r\n\r\n\t\t\t\tstate.mainShop = shop;\r\n\r\n\t\t\t\tlet tmpShop = {\r\n\t\t\t\t\tcityId: shop.cityId,\r\n\t\t\t\t\tid: shop.id,\r\n\t\t\t\t\txml_id: shop.xml_id,\r\n\t\t\t\t};\r\n\r\n\t\t\t\tCookies.set(\"mainShop\", JSON.stringify(tmpShop), {expires: 30});\r\n\r\n\t\t\t\tlocation.reload()\r\n\r\n\t\t\t},\r\n\t\t\tloadData: async state =>{\r\n\t\t\t\tlet response = await $.ajax({\r\n\t\t\t\t\turl: \"/include/ajax.php\",\r\n\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\tdata: \"AJAX_ADD_CITY=Y\",\r\n\t\t\t\t\tsuccess (response){\r\n\t\t\t\t\t\treturn response\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tlet data = JSON.parse(response);\r\n\r\n\t\t\t\tif (state.userPosition)\r\n\t\t\t\t\tfor (let i in data.shopsData){\r\n\t\t\t\t\t\tlet shop = data.shopsData[i];\r\n\r\n\t\t\t\t\t\tif (isNaN(parseFloat(shop.lat)) || isNaN(parseFloat(shop.lng)))\r\n\t\t\t\t\t\t\tcontinue\r\n\r\n\t\t\t\t\t\tlet distance = getDistanceFromLatLonInKm(parseFloat(state.userPosition.LAT), \r\n\t\t\t\t\t\t\tparseFloat(state.userPosition.LNG),\r\n\t\t\t\t\t\t\tparseFloat(shop.lat),parseFloat(shop.lng))\r\n\r\n\t\t\t\t\t\tdata.shopsData[i].distance = distance.toFixed(2);\r\n\r\n\t\t\t\t\t\t// shop.address = shop.address.replace(\"г. \", \"\").replace(\" КО\", \"\").replace(/\\s+/g, \" \");\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\tdata.shopsData.sort((a, b) => {\r\n\t\t\t\t\tvar compA = a.address.toUpperCase();\r\n\t\t\t\t\tvar compB = b.address.toUpperCase();\r\n\r\n\t\t\t\t\treturn (compA < compB) ? -1 : (compA > compB) ? 1 : 0\r\n\t\t\t\t});\r\n\r\n\t\t\t\tstate.regionsData = data.regionsData;\r\n\r\n\t\t\t\tstate.shopsData = data.shopsData;\r\n\r\n\t\t\t\tif (localStorage){\r\n        \ttry {\r\n        \t\tlocalStorage.setItem(\"regionsData\", JSON.stringify(state.regionsData));\r\n        \t\tlocalStorage.setItem(\"regionsDataTimestamp\", momentLast);\r\n\r\n        \t\tlocalStorage.setItem(\"shopsDataLast1\", JSON.stringify(state.shopsData));\r\n        \t\tlocalStorage.setItem(\"shopsDataTimestamp\", momentLast);\r\n        \t} catch (e){\r\n        \t\tconsole.log(e)\r\n        \t}\r\n        }\r\n\r\n        store.commit(\"checkLocation\");\r\n\t\t\t},\r\n\t\t\tcheckLocation(state){\r\n\t\t\t\tif (state.userRegionId == null){\r\n\t\t\t\t\tlet findedRegion = state.regionsData.regions\r\n\t\t\t\t\t.filter(region => region.name == Cookies.getJSON(\"geolocation\").REGION.replace(\"+\", \" \"));\r\n\r\n\t\t\t\t\tif (findedRegion.length){\r\n\t\t\t\t\t\tstate.userRegionId = findedRegion[0].id;\r\n\t\t\t\t\t\twindow.app.$refs.citySelect.curRegion = +state.userRegionId;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (state.userCity == \"\"){\r\n\t\t\t\t\tlet findedCity = state.regionsData.cities\r\n\t\t\t\t\t.filter(city => city.name == Cookies.getJSON(\"geolocation\").CITY.replace(\"+\", \" \"));\r\n\r\n\t\t\t\t\tif (findedCity.length){\r\n\t\t\t\t\t\tstate.userCity = findedCity[0];\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\twindow.app.$refs.citySelect.curCity = +state.userCity.id;\r\n\t\t\t\t\t\t}, 100)\r\n\r\n\t\t\t\t\t\tstate.showCityPopup = Cookies.get(\"cityPopupShowed\") ? false : true;\r\n\r\n\t\t\t\t\t\t$(window).on(\"load\", e => {\r\n\t\t\t\t\t\t\t$(\".menu-mobile .city\").html($(\"header .city\").html());\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tif (Cookies.get(\"age_confirmed\"))\r\n\t\t\t\t\t\t\tapp.showCityPopup(false)\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\tapp.showAgeConfirm()\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!Cookies.get(\"age_confirmed\"))\r\n\t\t\t\t\tapp.showAgeConfirm();\r\n\t\t\t},\r\n\t\t}\r\n\t});\r\n\r\n\twindow.app = new Vue({\r\n\t\tel: \"#page-wr\",\r\n\t\tdata: {\r\n\t\t\theadMessage: \"\",\r\n\t\t\theadMessageShow: false,\r\n\t\t\theadMessageClass: \"notify\",\r\n\t\t\tisShopsPopupOpened: false,\r\n\t\t},\r\n\t\tstore: store,\r\n\t\tmounted () {\r\n\t\t\tconsole.log(\"mounted\");\r\n\r\n\t\t\t// store.state.shopsData.sort((a, b) => {\r\n\t\t\t// \tlet compA = a.address.toUpperCase(),\r\n\t\t\t// \t\tcompB = b.address.toUpperCase();\r\n\r\n\t\t\t// \treturn (compA < compB) ? -1 : (compA > compB) ? 1 : 0\r\n\r\n\t\t\tuploadInputmask();\r\n\r\n\t\t\tif (localStorage && (localStorage.shopsDataLast) || localStorage.shopsData){\r\n\t\t\t\tlocalStorage.removeItem(\"shopsDataLast\");\r\n\t\t\t\tlocalStorage.removeItem(\"shopsData\");\r\n\t\t\t}\r\n\r\n\t\t\tif (localStorage && (!store.state.regionsData.length || !store.state.shopsData.length))\r\n\t\t\t\tstore.commit(\"loadData\");\r\n\t\t\telse{\r\n\t\t\t\tif (!$(\".app-block\").length)\r\n\t\t\t\t\tthis.showAgeConfirm()\r\n\t\t\t}\r\n\r\n\t\t\tloadScripts();\r\n\r\n\t\t\t//filter();\r\n\r\n\t\t\t// console.log(this.mainShop);\r\n\r\n\t\t\t// $('script:contains(CMenuOpener)').each((key, $script) => {\r\n\t\t\t// \teval($script.innerText);\r\n\t\t\t// });\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tmainShop: () => store.state.mainShop,\r\n\t\t\tuserCity: () => store.state.userCity,\r\n\t\t\tcityPopup: () => store.state.showCityPopup,\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tshowAgeConfirm (){\r\n\t\t\t\tif ($(\".app-block\").length)\r\n\t\t\t\t\treturn\r\n\t\t\t\t$.fancybox({\r\n\t\t\t\t\t\thref : '#age-forms',\r\n\t\t\t\t\t\tcloseBtn : false,\r\n\t\t\t\t\t\tcloseClick  : false,\r\n\t\t\t\t\t\thelpers     : {\r\n\t\t\t\t\t\toverlay : {\r\n\t\t\t\t\t\t\tcloseClick: false,\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tkeys : {\r\n\t\t\t\t\t\tclose : null,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tbeforeShow:function() {\r\n\t\t\t\t\t\t$('body').addClass('fancy-active');\r\n\t\t\t\t\t},\r\n\t\t\t\t\tafterShow:function(){\r\n\r\n\t\t\t\t\t},\r\n\t\t\t\t\tafterClose:function(){\r\n\t\t\t\t\t\t$('body').removeClass('fancy-active');\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tshowMessage: async (text, options) => {\r\n\r\n\t\t\t\tif (app.headMessageShow){\r\n\t\t\t\t\tapp.headMessageShow = false;\r\n\t\t\t\t\tawait new Promise(resolve => {\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tresolve()\r\n\t\t\t\t\t\t}, 300)\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\r\n\t\t\t\tapp.headMessage = \"\";\r\n\t\t\t\tapp.headMessageClass = \"notify\";\r\n\r\n\r\n\t\t\t\tapp.headMessageShow = true;\r\n\r\n\t\t\t\tapp.headMessage = text;\r\n\r\n\t\t\t\tif (options.class)\r\n\t\t\t\t\tapp.headMessageClass = options.class;\r\n\r\n\t\t\t\tsetTimeout(()=>{\r\n\t\t\t\t\tapp.headMessageShow = false;\r\n\t\t\t\t}, options.time || 2000)\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\tsetMainShop(id) {\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\thideCityPopup(){\r\n\t\t\t\t// Cookies.set(\"cityPopupShowed\", 1);\r\n\r\n\t\t\t\tstore.commit(\"setMainCity\", this.userCity);\r\n\r\n\t\t\t\tstore.state.showCityPopup = false;\r\n\t\t\t},\r\n\t\t\tgetCurShopTime(){\r\n\t\t\t\tlet time = [];\r\n\t\t\t\tif (store.state.mainShop != \"\" && store.state.mainShop.time != \"\"){\r\n      \t\ttime = store.state.mainShop.time.split(\" \");\r\n\r\n      \t\ttime = time[1].split(\"-\");\r\n      \t}else{\r\n      \t\ttime[0] = \"9:00\";\r\n      \t\ttime[1] = \"22:00\";\r\n      \t}\r\n\r\n      \treturn time\r\n\t\t\t},\r\n\t\t\tshowShopPopup(){\r\n\t\t\t\tif ($(\".app-block\").length)\r\n\t\t\t\t\treturn\r\n\r\n\t\t\t\tlet self = this;\r\n\t\t\t\t$(\"#menu-toggle\").removeClass('open');\r\n\t\t\t\t$('body').removeClass(\"mobile-menu--open\");\r\n\r\n\t\t\t\t$.fancybox({\r\n\t\t\t\t\thref: \"#shops\",\r\n\t\t\t\t\tbeforeShow (){\r\n\t\t\t\t\t\t$(\"body\").addClass(\"fancy-active\");\r\n\t\t\t\t\t\tself.isShopsPopupOpened = true;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tafterClose (){\r\n\t\t\t\t\t\t$(\"body\").removeClass(\"fancy-active\");\r\n\t\t\t\t\t\tself.isShopsPopupOpened = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tshowCityPopup(isClosable = true){\r\n\t\t\t\tif ($(\".app-block\").length)\r\n\t\t\t\t\treturn\r\n\r\n\t\t\t\t$(\"#menu-toggle\").removeClass('open');\r\n\t\t\t\t$('body').removeClass(\"mobile-menu--open\");\r\n\r\n\t\t\t\tif (!isClosable)\r\n\t\t\t\t\t$.fancybox({\r\n\t\t\t\t\t\thref: \"#city\",\r\n\t\t\t\t\t\tcloseBtn: false,\r\n\t\t\t\t\t\tcloseClick: false,\r\n\t\t\t\t\t\thelpers: {\r\n\t\t\t\t\t\t\toverlay: {\r\n\t\t\t\t\t\t\t\tcloseClick: false\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tkeys: {\r\n\t\t\t\t\t\t\tclose: null\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tbeforeShow (){\r\n\t\t\t\t\t\t\t$(\"body\").addClass(\"fancy-active\")\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tafterClose (){\r\n\t\t\t\t\t\t\t$(\"body\").removeClass(\"fancy-active\")\t\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tafterShow (){\r\n\t\t\t\t\t\t\t$.fancybox.update()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\telse\r\n\t\t\t\t\t$.fancybox({\r\n\t\t\t\t\t\thref: \"#city\",\r\n\t\t\t\t\t\tbeforeShow (){\r\n\t\t\t\t\t\t\t$(\"body\").addClass(\"fancy-active\")\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tafterClose (){\r\n\t\t\t\t\t\t\t$(\"body\").removeClass(\"fancy-active\")\t\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tafterShow (){\r\n\t\t\t\t\t\t\t$.fancybox.update()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t});\r\n}\r\n\r\nVue.component(\"datetime-pick\", {\r\n\tprops: {\r\n\t\trequired: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: true\r\n\t\t}\r\n\t},\r\n\tdata: () => ({\r\n\t\tdateTime: \"\",\r\n\t}),\r\n\tmounted(){\r\n\t\t$(\".order-form__date\").append('<div class=\"order-form__calendar\">\\\r\n      <div id=\"order-calendar\" class=\"calendar\"></div>\\\r\n    </div>');\r\n\r\n\r\n    $('.order-form__calendar').toggle();\r\n\t},\r\n\tmethods: {\r\n\t\topenCalendar(){\t\r\n\t\t\tvar todayDate = moment();\r\n      var ionStartDate = todayDate.format(\"DD.MM.YYYY\");\r\n\r\n      if(todayDate.hour() >= 22) {\r\n          ionStartDate = todayDate.add(1, 'days').format(\"DD.MM.YYYY\");\r\n      }\r\n\r\n      let curYear = +moment().format(\"YYYY\"),\r\n      \t\tnextYear = curYear + 1;\r\n\r\n      $('.order-form__calendar').toggle();\r\n\r\n      $(\"#order-calendar\").ionCalendar({\r\n          lang: \"ru\",\r\n          sundayFirst: false,\r\n          years: curYear+\"-\"+nextYear,\r\n          format: 'DD.MM.YYYY',\r\n          hideArrows: true,\r\n          startDate: ionStartDate,\r\n          onClick: (date) => {\r\n              window.cart_calendar_hours = $('.ic__time-select').val();\r\n\r\n              var curDate = moment();\r\n              curDate.locale(\"ru\")\r\n              curDate.minute(0);\r\n              curDate.second(0);\r\n              curDate.millisecond(0);\r\n\r\n              var selectedDate = moment(date, 'DD.MM.YYYY');\r\n              selectedDate.locale(\"ru\")\r\n              selectedDate.hour(window.cart_calendar_hours);\r\n              //   selectedDate.hour(0);\r\n              selectedDate.minute(0);\r\n              selectedDate.second(0);\r\n              selectedDate.millisecond(0);\r\n\r\n              if (selectedDate.diff(curDate, 'hours') < 2) {\r\n                  selectedDate.hour(moment().add(2, 'hour').format('H'));\r\n              }\r\n\r\n              var date = selectedDate.format(\"HH:mm DD.MM.YYYY\");\r\n              //   date = selectedDate.format(\"DD.MM.YYYY\");\r\n\r\n              if ((selectedDate.diff(curDate, 'hours') < 2) || (selectedDate.diff(curDate, 'days') > 1)) {\r\n              \t// let text = \"Заказ можно оформить только на сегодня и завтра c 9:00 до 22:00\";\r\n              \t\r\n              \tlet time = app.getCurShopTime();\r\n\r\n              \tlet text = \"Заказ можно оформить только на сегодня и завтра c \"+time[0]+\" до \"+time[1];\r\n\r\n            \t\tapp.showMessage(text, {\r\n            \t\t\ttime: 2500,\r\n            \t\t\tclass: \"notify\"\r\n            \t\t});\r\n                // showHeaderMessage('', 'error');\r\n                return false;\r\n              }\r\n\r\n              $('.order-form__calendar').toggle();\r\n              this.dateTime = date;\r\n          },\r\n          onReady: (date) => {\r\n              var selectedDate = moment(date, 'DD.MM.YYYY');\r\n              var curDate = moment();\r\n\r\n              if (typeof(window.cart_calendar_hours) != 'undefined') {\r\n                  curDate.hour(window.cart_calendar_hours);\r\n              }\r\n              else {\r\n                  curDate.add(1, 'hour');\r\n              }\r\n              var dt = moment();\r\n              var html = '<div class=\"ic__time\"><select class=\"ic__time-select\">';\r\n\r\n              let time = app.getCurShopTime();\r\n\r\n              let timeStart = time[0], timeEnd = time[1];\r\n\r\n              for(var i = +timeStart.split(\":\")[0]; i < +timeEnd.split(\":\")[0]; i++){\r\n                  if((i < parseInt(moment().add(2, 'hour').format(\"H\"))) && (selectedDate.format('DD') == moment().format('DD'))) {\r\n                      continue;\r\n                  }\r\n                  if(i === parseInt(curDate.format(\"H\"))){\r\n                      html += '<option value=\"' + i + '\" selected=\"selected\">' + dt.hour(i).format(\"H\") + ':00</option>';\r\n                  } else {\r\n                      html += '<option value=\"' + i + '\">' + dt.hour(i).format(\"H\") + ':00</option>';\r\n                  }\r\n              }\r\n              html += '</select></div>';\r\n              $('.ic__header').append(html);\r\n\r\n              $('.ic__time-select').change((e) => {\r\n                  var hour = $(e.currentTarget).val();\r\n                  var date = this.dateTime;\r\n                  if(date == \"\")\r\n                      date = moment().format('HH:mm DD.MM.YYYY');\r\n                  var selectedDate = moment(date, 'HH:mm DD.MM.YYYY');\r\n                  selectedDate.hour(hour);\r\n                  selectedDate.minute(0);\r\n                  selectedDate.second(0);\r\n                  this.dateTime = selectedDate.format('HH:mm DD.MM.YYYY');\r\n              });\r\n            }\r\n        });\r\n\t\t}\r\n\t}\r\n})\r\n\r\nVue.component(\"features\", {\r\n\tprops: {\r\n\t\trows: {\r\n\t\t\ttype: Array,\r\n\t\t\tdefault: []\r\n\t\t}\r\n\t},\r\n\ttemplate: '\\\r\n\t\t<div class=\"features\">\\\r\n\t\t\t<table class=\"features-table\">\\\r\n\t\t\t\t<tr v-for=\"row in rows\">\\\r\n\t\t\t\t\t<td class=\"features-table__title\">{{row.title}}</td>\\\r\n\t\t\t\t\t<td class=\"features-table__content\" v-html=\"row.content\"></td>\\\r\n\t\t\t\t</tr>\\\r\n\t\t\t</table>\\\r\n\t\t</div>'\r\n});\r\n\r\nVue.component(\"city-select\", {\r\n\tdata: () => ({\r\n\t\tcurRegion: store.state.userRegionId || \"default\",\r\n\t\tcurCity: (store.state.userCity != \"\" ? store.state.userCity.id : \"default\"),\r\n\t\tisRegionSelected: (store.state.userRegionId != null ? true : false),\r\n\t\tisCitySelected: (store.state.userCity != \"\" ? true : false),\r\n\t}),\r\n\tcomputed: {\r\n\t\tregionsList: () => store.state.regionsData.regions,\r\n\t\tcitiesList () {\r\n\t\t\treturn store.state.regionsData.cities.filter((item) => item.regionId == this.curRegion)\r\n\t\t},\r\n\t},\r\n\tmounted(){\r\n\t\t// store.commit(\"checkLocation\");\r\n\r\n\t\t// this.curRegion = store.state.userRegionId || \"default\";\r\n\t\t// this.curCity = store.state.userCity != \"\" ? store.state.userCity.id : \"default\";\r\n\t},\r\n\tupdate() {\r\n\t\t$.fancybox.update();\r\n\t},\r\n\twatch: {\r\n\t\tcurRegion(val, oldVal){\r\n\t\t\tthis.isRegionSelected = true;\r\n\t\t\tthis.curCity = \"default\";\r\n\t\t},\r\n\t\tcurCity(val, oldVal){\r\n\t\t\tif (val == \"default\")\r\n\t\t\t\tthis.isCitySelected = false;\r\n\t\t\telse\r\n\t\t\t\tthis.isCitySelected = true;\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tselectCity() {\r\n\t\t\tstore.commit(\"setMainCity\", store.state.regionsData\r\n\t\t\t\t.cities.filter(item => item.id == this.curCity)[0]);\t\t\t\r\n\r\n\t\t\tstore.commit(\"setMainRegion\", this.curRegion);\r\n\t\t\tapp.showMessage(\"Город успешно выбран\", {\r\n\t\t\t\tclass: \"notify\",\r\n\t\t\t\ttime: 2000\r\n\t\t\t});\r\n\r\n\t\t\t$.fancybox.close();\r\n\r\n\t\t\tlocation.reload();\r\n\t\t}\r\n\t},\r\n\ttemplate: '\\\r\n\t\t<div class=\"forms__input-wrap\">\\\r\n          <div class=\"forms-input-cont\">\\\r\n              <select v-model=\"curRegion\" name=\"regionSelect\" class=\"forms__select\">\\\r\n\t\t\t\t<option value=\"default\" disabled>Выберите регион</option>\\\r\n                <option v-for=\"region in regionsList\" :value=\"region.id\">{{region.name}}</option>\\\r\n              </select>\\\r\n             <label for=\"form-name\" class=\"forms-label forms__label\">Область</label>\\\r\n          </div>\\\r\n          <div v-if=\"isRegionSelected\" class=\"forms-input-cont\">\\\r\n              <select v-model=\"curCity\" name=\"citySelect\" class=\"forms__select\">\\\r\n                  <option value=\"default\" disabled>Выберите город</option>\\\r\n                  <option v-for=\"city in citiesList\" :value=\"city.id\">{{city.name}}</option>\\\r\n              </select>\\\r\n             <label for=\"form-name\" class=\"forms-label forms__label\">Город</label>\\\r\n          </div>\\\r\n          <div v-if=\"isCitySelected\" style=\"width: 100%; justify-content: center;\" class=\"forms__submit\">\\\r\n            <a @click=\"selectCity()\" class=\"btn btn-form\">Да</a>\\\r\n          </div>\\\r\n        </div>\\\r\n    '\r\n});\r\n\r\nVue.component(\"shops\", {\r\n\tprops: {\r\n\t\tisContacts: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false,\r\n\t\t}\r\n\t},\r\n\tdata: () => ({\r\n\t\tsearch__input: \"\",\r\n\t\tisRegionSelected: Cookies.getJSON(\"userRegionId\") ? true : false,\r\n\t\tisCitySelected: Cookies.getJSON(\"userCity\") ? true : false,\r\n\t\tviewType: Cookies.get(\"shopsViewType\") || \"dist\",\r\n\t\tcurRegion: +Cookies.getJSON(\"userRegionId\") || \"default\",\r\n\t\tcurCity: (Cookies.getJSON(\"userCity\") ? +Cookies.getJSON(\"userCity\").id : \"default\"),\r\n\t\tcurShop: (Cookies.getJSON(\"mainShop\") ? +Cookies.getJSON(\"mainShop\").id : null),\r\n\t\tsrollPane: null,\r\n\t\tmap: null,\r\n\t\tmapId: \"shops-map\"+Math.random(),\r\n\t\tradioPrefix: Math.random(),\r\n\t\tisKart: window.ostatki ? true : false,\r\n\t}),\r\n\twatch: {\r\n\t\tsearch__input(val, oldVal){\r\n\t\t\t//this.scrollPane.reinitialise();\r\n\t\t},\r\n\t\tviewRadio(val, oldVal){\r\n\t\t\tif (val == oldVal)\r\n\t\t\t\treturn\r\n\r\n\t\t\t\r\n\t\t},\r\n\t\tcurRegion(val, oldVal){\r\n\t\t\tif (val == oldVal)\r\n\t\t\t\treturn\r\n\r\n\t\t\t//store.commit(\"setMainRegion\", val);\r\n\r\n\t\t\tthis.isRegionSelected = true;\r\n\t\t\tthis.isCitySelected = false;\r\n\t\t\tthis.curCity = \"default\";\r\n\t\t},\r\n\t\tcurCity(val, oldVal){\r\n\t\t\tif (val == oldVal || val == \"default\")\r\n\t\t\t\treturn\r\n\r\n\t\t\t// console.log(this.viewType);\r\n\r\n\t\t\tif (this.viewType == \"map\"){\r\n\t\t\t\t// this.destroyMap();\r\n\t\t\t\t// console.log(this.viewType);\r\n\t\t\t\t// this.viewType = \"map\";\r\n\t\t\t\tthis.reinitMap();\r\n\t\t\t}\r\n\r\n\t\t\t// console.log(this.viewType);\r\n\r\n\t\t\t//store.commit(\"setMainCity\", (this.citiesList.filter((item) => item.id == this.curCity))[0]);\r\n\r\n\t\t\t//this.isCitySelected = true;\r\n\t\t\tthis.update()\r\n\t\t},\r\n\t\tviewType (val, oldval) {\r\n\t\t\tswitch (val){\r\n\t\t\t\tcase \"map\":\r\n\t\t\t\t\tthis.initMap();\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthis.sort();\r\n\t\t\t\t\t//this.initScroll();\r\n\t\t\t}\r\n\t\t},\r\n\t},\r\n\tmounted (){\r\n\t\t// console.log(this.ostatki);\r\n\r\n\t\t// $(\".shops-view__one:nth-child(2) label\").trigger(\"click\");\r\n\r\n\t\t// this.sort();\r\n\r\n\t\tif (this.isContacts)\r\n\t\t\tthis.viewType = \"map\";\r\n\r\n\t\t// $(\".shops-view__one:first-child label\").trigger(\"click\");\r\n\r\n\t\t// for (let i in this.filteredList)\r\n\t\t\t// console.log(this.filteredList[i].address);\r\n\r\n\t\t// this.initScroll();\r\n\t\tthis.sort();\r\n\r\n\t\t//this.scrollPane.reinitialise();\r\n\t},\r\n\tupdated () {\r\n\t\t// if ($(\".shops-list__list\").length && this.scrollPane == null){\r\n\t\t// \tthis.scrollPane = $(\".shops-list__list\").jScrollPane();\r\n\t\t// \tthis.scrollPane = this.scrollPane.data(\"jsp\");\r\n\t\t// }else if ($(\".shops-list__list\").length){\r\n\t\t// \tthis.scrollPane.reinitialise()\r\n\t\t// }else if (!$(\".shops-list__list\").length)\r\n\t\t// \tthis.scrollPane = null\r\n\r\n\t\t$.fancybox.update();\r\n\t},\r\n\tmethods: {\r\n\t\tinitScroll(){\r\n\t\t\t// this.scrollPane = $(this.$el).find(\".shops-list__list\").jScrollPane();\r\n\r\n\t\t\t// this.scrollPane = this.scrollPane.data(\"jsp\");\r\n\r\n\t\t\t// this.scrollPane.reinitialise();\r\n\t\t},\r\n\t\tdestroyMap() {\r\n\t\t\t// console.log(this.map);\r\n\t\t\t// this.map.destructor();\r\n\t\t},\r\n\t\treinitMap() {\r\n\t\t\t// this.map.removeAll();\r\n\t\t\tvar coords = [], center = [0, 0], lat = 0, lng = 0;\r\n\r\n\t\t\tfor (var i in this.shopsList){\r\n\t\t\t\tlet shop = this.shopsList[i];\r\n\r\n\t\t\t\tif (!parseInt(this.ostatki[shop.xml_id]) && this.ostatki.length)\r\n\t\t\t\t\t\tcontinue\r\n\r\n\t\t\t\tif (!isNaN(parseFloat(shop.lat)) && !isNaN(parseFloat(shop.lat))){\r\n\t\t\t\t\tcoords.push([parseFloat(shop.lat), parseFloat(shop.lng)]);\r\n\t\t\t\t\tlat += parseFloat(shop.lat);\r\n\t\t\t\t\tlng += parseFloat(shop.lng);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tlet size = [$(this.$el).find(\".shops__map\").width(), $(this.$el).find(\".shops__map\").height()];\r\n\r\n\t\t\tlet zoom = ymaps.util.bounds.getCenterAndZoom(ymaps.util.bounds.fromPoints(coords), size);\r\n\r\n\t\t\t// this.map.setZoom(zoom.zoom+0.4);\r\n\r\n\t\t\tthis.map.setCenter(zoom.center, zoom.zoom);\r\n\r\n\t\t\tvar objects = [], cluster = new ymaps.Clusterer({\r\n\t\t\t\t\tpreset: 'islands#nightClusterIcons',\r\n\t\t\t\t\tclusterIconColor: \"#e31e24\",\r\n\t\t\t\t\thasBalloon: false,\r\n\t\t\t\t\tgridSize: 80,\r\n\t\t\t\t}),\r\n\t\t\tselectedID = false;\r\n\r\n\t\t\tfor (var i in this.shopsList){\r\n\t\t\t\tlet shop = this.shopsList[i];\r\n\r\n\t\t\t\tif (!parseInt(this.ostatki[shop.xml_id]) && this.ostatki.length)\r\n\t\t\t\t\t\tcontinue\r\n\r\n\t\t\t\tif (isNaN(parseFloat(shop.lat)) || isNaN(parseFloat(shop.lat)))\r\n\t\t\t\t\tcontinue\r\n\r\n\t\t\t\tif (shop.id != store.state.mainShop.id)\r\n\t\t\t\t\tshop.balloonContent = '\\\r\n\t\t\t\t\t\t<div class=\"shop-balloon\">\\\r\n\t\t\t\t\t\t\t<div class=\"shop-balloon__address\">'+shop.address+'</div>\\\r\n\t\t\t\t\t\t\t<div class=\"shop-balloon__time\">'+shop.time+'</div>\\\r\n\t\t\t\t\t\t\t<div v-if=\"shop.id != store.state.mainShop.id\" class=\"shop-balloon__btn\">\\\r\n\t\t\t\t\t\t\t\t<span onclick=\"store.commit(\\'setMainShop\\', '+shop.id+')\" class=\"btn btn--rectangle shop-select\">Выбрать</span>\\\r\n\t\t\t\t\t\t\t</div>\\\r\n\t\t\t\t\t\t</div>\\\r\n\t\t\t\t\t';\r\n\t\t\t\telse\r\n\t\t\t\t\tshop.balloonContent = '\\\r\n\t\t\t\t\t\t<div class=\"shop-balloon\">\\\r\n\t\t\t\t\t\t\t<div class=\"shop-balloon__address\">'+shop.address+'</div>\\\r\n\t\t\t\t\t\t\t<div class=\"shop-balloon__time\">'+shop.time+'</div>\\\r\n\t\t\t\t\t\t</div>\\\r\n\t\t\t\t\t';\r\n\r\n\t\t\t\tvar placemark = new ymaps.Placemark(\r\n\t\t\t\t\t[parseFloat(shop.lat), parseFloat(shop.lng)],{\r\n\t\t\t\t\t\tballoonContent: shop.balloonContent,\r\n\t\t\t\t\t},{\r\n\t\t\t\t\t\ticonLayout: \"default#image\",\r\n\t\t\t\t\t\ticonImageHref: (shop.id != store.state.mainShop.id ? \"/local/templates/vinsklad2017/img/ico-marker.png\" : \"/local/templates/vinsklad2017/img/ico-selected-marker.png\"),\r\n\t\t\t\t\t\ticonImageSize: (shop.id != store.state.mainShop.id ? [32, 43] : [28, 33])\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif (shop.id == store.state.mainShop.id)\r\n\t\t\t\t\tselectedID = {\r\n\t\t\t\t\t\tcoords: [parseFloat(shop.lat), parseFloat(shop.lng)]\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\tobjects.push(placemark);\r\n\t\t\t}\r\n\r\n\t\t\tcluster.add(objects);\r\n\r\n\t\t\tthis.map.geoObjects.add(cluster);\r\n\r\n\t\t\tif (!selectedID){\r\n\t\t\t\tthis.map.setBounds(cluster.getBounds(), {\r\n\t                checkZoomRange: true\r\n\t            })\r\n\t        }else\r\n\t        \tthis.map.setCenter(selectedID.coords, 3);\r\n\r\n\t\t},\r\n\t\tinitMap () {\r\n\t\t\tvar coords = [], center = [0, 0], lat = 0, lng = 0;\r\n\r\n\t\t\t$(\".shops__map-map\").html(\"\");\r\n\r\n\t\t\tymaps.ready(() => {\r\n\r\n\t\t\t\tfor (var i in this.shopsList){\r\n\t\t\t\t\tlet shop = this.shopsList[i];\r\n\r\n\t\t\t\t\tif (!parseInt(this.ostatki[shop.xml_id]) && this.ostatki.length)\r\n\t\t\t\t\t\tcontinue\r\n\r\n\t\t\t\t\tif (!isNaN(parseFloat(shop.lat)) && !isNaN(parseFloat(shop.lng))){\r\n\t\t\t\t\t\tcoords.push([parseFloat(shop.lat), parseFloat(shop.lng)]);\r\n\t\t\t\t\t\tlat += parseFloat(shop.lat);\r\n\t\t\t\t\t\tlng += parseFloat(shop.lng);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// center = [lng/coords.length, lat/coords.length];\r\n\r\n\t\t\t\tcenter = ymaps.util.bounds.getCenter(ymaps.util.bounds.fromPoints(coords));\r\n\r\n\t\t\t\tthis.map = new ymaps.Map(this.mapId, {\r\n\t\t\t\t\tzoom: 11,\r\n\t\t\t\t\tcenter: center,\r\n\t\t\t\t\t// controls: ['fullscreenControl']\r\n\t\t\t\t});\r\n\r\n\t\t\t\tlet size = [$(this.$el).find(\".shops__map\").width(), $(this.$el).find(\".shops__map\").height()];\r\n\r\n\t\t\t\tlet zoom = ymaps.util.bounds.getCenterAndZoom(ymaps.util.bounds.fromPoints(coords), size);\r\n\r\n\t\t\t\tthis.map.setZoom(zoom.zoom+0.4);\r\n\r\n\t\t\t\tvar objects = [], cluster = new ymaps.Clusterer({\r\n\t\t\t\t\tpreset: 'islands#nightClusterIcons',\r\n\t\t\t\t\tclusterIconColor: \"#e31e24\",\r\n\t\t\t\t\thasBalloon: false,\r\n\t\t\t\t\tgridSize: 80,\r\n\t\t\t\t}),\r\n\t\t\t\tselectedID = false;\r\n\r\n\t\t\t\tfor (var i in this.shopsList){\r\n\t\t\t\t\tlet shop = this.shopsList[i];\r\n\r\n\t\t\t\t\tif (!parseInt(this.ostatki[shop.xml_id]) && this.ostatki.length)\r\n\t\t\t\t\t\tcontinue\r\n\r\n\t\t\t\t\tif (isNaN(parseFloat(shop.lat)) || isNaN(parseFloat(shop.lng)))\r\n\t\t\t\t\t\tcontinue\r\n\r\n\t\t\t\t\tif (shop.id != store.state.mainShop.id)\r\n\t\t\t\t\t\tshop.balloonContent = '\\\r\n\t\t\t\t\t\t\t<div class=\"shop-balloon\">\\\r\n\t\t\t\t\t\t\t\t<div class=\"shop-balloon__address\">'+shop.address+'</div>\\\r\n\t\t\t\t\t\t\t\t<div class=\"shop-balloon__time\">'+shop.time+'</div>\\\r\n\t\t\t\t\t\t\t\t<div class=\"shop-balloon__btn\">\\\r\n\t\t\t\t\t\t\t\t\t<span onclick=\"store.commit(\\'setMainShop\\', '+shop.id+')\" class=\"btn btn--rectangle shop-select\">Выбрать</span>\\\r\n\t\t\t\t\t\t\t\t</div>\\\r\n\t\t\t\t\t\t\t</div>\\\r\n\t\t\t\t\t\t'\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tshop.balloonContent = '\\\r\n\t\t\t\t\t\t\t<div class=\"shop-balloon\">\\\r\n\t\t\t\t\t\t\t\t<div class=\"shop-balloon__address\">'+shop.address+'</div>\\\r\n\t\t\t\t\t\t\t\t<div class=\"shop-balloon__time\">'+shop.time+'</div>\\\r\n\t\t\t\t\t\t\t</div>\\\r\n\t\t\t\t\t\t'\r\n\r\n\t\t\t\t\tvar placemark = new ymaps.Placemark(\r\n\t\t\t\t\t\t[parseFloat(shop.lat), parseFloat(shop.lng)],{\r\n\t\t\t\t\t\t\tballoonContent: shop.balloonContent,\r\n\t\t\t\t\t\t},{\r\n\t\t\t\t\t\t\ticonLayout: \"default#image\",\r\n\t\t\t\t\t\t\ticonImageHref: (shop.id != store.state.mainShop.id ? \"/local/templates/vinsklad2017/img/ico-marker.png\" : \"/local/templates/vinsklad2017/img/ico-selected-marker.png\"),\r\n\t\t\t\t\t\t\ticonImageSize: (shop.id != store.state.mainShop.id ? [32, 43] : [28, 33])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tif (shop.id == store.state.mainShop.id)\r\n\t\t\t\t\t\tselectedID = {\r\n\t\t\t\t\t\t\tcoords: [parseFloat(shop.lat), parseFloat(shop.lng)]\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\tobjects.push(placemark);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcluster.add(objects);\r\n\r\n\t\t\t\tthis.map.geoObjects.add(cluster);\r\n\r\n\t\t\t\tif (!selectedID){\r\n\t\t\t\t\tthis.map.setBounds(cluster.getBounds(), {\r\n\t\t                checkZoomRange: true\r\n\t\t            })\r\n\t\t        }else\r\n\t\t        \tthis.map.setCenter(selectedID.coords, 16);\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t\r\n\t\t},\r\n\t\tsort (){\r\n\t\t\tswitch (this.viewType){\r\n\t\t\t\tcase \"alph\":\r\n\t\t\t\t\tthis.shopsList.sort((a, b) => {\r\n\t\t\t\t\t\tvar compA = a.address.toUpperCase();\r\n\t\t\t\t\t\tvar compB = b.address.toUpperCase();\r\n\r\n\t\t\t\t\t\treturn (compA < compB) ? -1 : (compA > compB) ? 1 : 0\r\n\t\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"dist\":\r\n\t\t\t\t\tthis.shopsList.sort((a, b) => {\r\n\t\t\t\t\t\treturn parseFloat(a.distance) - parseFloat(b.distance);\r\n\t\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\t// for (let i in this.filteredList){\r\n\t\t\t// \tlet shop = this.filteredList[i];\r\n\r\n\t\t\t// \tconsole.log(shop.distance)\r\n\t\t\t// }\r\n\t\t},\r\n\t\tsetViewMthod(method){\r\n\t\t\tif (method == \"map\"){\r\n\r\n\t\t\t}else{\r\n\t\t\t\t//this.initScroll();\r\n\t\t\t}\r\n\t\t\t//this.type = method;\r\n\t\t},\r\n\t\tsetMainShop() {\r\n\t\t\tstore.commit(\"setMainShop\", this.curShop);\r\n\t\t},\r\n\t\tupdate() {\r\n\t\t\tthis.isCitySelected = false;\r\n\t\t\tthis.isCitySelected = true;\r\n\t\t\tthis.sort();\r\n\t\t},\r\n\t},\r\n\tcomputed: {\r\n\t\tfilteredList (){\r\n\t\t\tthis.sort();\r\n\r\n\t\t\treturn this.shopsList.filter(item => ~item.address.toLowerCase()\r\n\t\t\t.indexOf(this.search__input.toLowerCase()));\r\n\t\t},\r\n\t\tregionsList: () => store.state.regionsData.regions,\r\n\t\tcitiesList () {\r\n\t\t\treturn store.state.regionsData.cities.filter(item => item.regionId == this.curRegion)\r\n\t\t},\r\n\t\tshopsList () {\r\n\t\t\tif (!this.isKart)\r\n\t\t\t\treturn store.state.shopsData.filter(item => item.cityId == this.curCity)\r\n\t\t\telse{\r\n\r\n\t\t\t\treturn store.state.shopsData.filter(item => {\r\n\t\t\t\t\tconsole.log(item.cityId, this.curCity, store.state.inStock[item.xml_id], item.xml_id);\r\n\r\n\t\t\t\t\treturn item.cityId == this.curCity && parseInt(this.ostatki[item.xml_id])\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\tostatki (){\r\n\t\t\treturn store.state.inStock;\r\n\t\t},\r\n\t},\r\n\ttemplate: '\\\r\n\t\t<div class=\"shops\">\\\r\n\t\t\t<div class=\"shops__top\">\\\r\n\t\t\t\t<div v-if=\"$root.isShopsPopupOpened\" class=\"city-select\">\\\r\n\t\t\t\t\t<div>\\\r\n\t\t\t\t\t\t<select v-model=\"curRegion\" class=\"city-select__region\">\\\r\n\t\t\t\t\t\t\t<option value=\"default\" disabled>Выберите область</option>\\\r\n\t\t\t\t\t\t\t<option v-for=\"region in regionsList\" :value=\"region.id\">{{ region.name }}</option>\\\r\n\t\t\t\t\t\t</select>\\\r\n\t\t\t\t\t</div>\\\r\n\t\t\t\t\t<div>\\\r\n\t\t\t\t\t\t<select v-if=\"isRegionSelected\" v-model=\"curCity\" class=\"city-select__city\">\\\r\n\t\t\t\t\t\t\t<option value=\"default\" disabled>Выберите город</option>\\\r\n\t\t\t\t\t\t\t<option v-for=\"city in citiesList\" :value=\"city.id\">{{ city.name }}</option>\\\r\n\t\t\t\t\t\t</select>\\\r\n\t\t\t\t\t</div>\\\r\n\t\t\t\t</div>\\\r\n\t\t\t\t<div v-else class=\"city-select\">\\\r\n\t\t\t\t\t<select v-model=\"curRegion\" class=\"city-select__region\">\\\r\n\t\t\t\t\t\t<option value=\"default\" disabled>Выберите регион</option>\\\r\n\t\t\t\t\t\t<option v-for=\"region in regionsList\" :value=\"region.id\">{{ region.name }}</option>\\\r\n\t\t\t\t\t</select>\\\r\n\t\t\t\t\t<select v-if=\"isRegionSelected\" v-model=\"curCity\" class=\"city-select__city\">\\\r\n\t\t\t\t\t\t<option value=\"default\" disabled>Выберите город</option>\\\r\n\t\t\t\t\t\t<option v-for=\"city in citiesList\" :value=\"city.id\">{{ city.name }}</option>\\\r\n\t\t\t\t\t</select>\\\r\n\t\t\t\t</div>\\\r\n\t\t\t</div>\\\r\n\t\t\t<div v-if=\"isCitySelected\" class=\"shops-filter\">\\\r\n\t\t\t\t<div class=\"shops-filter__radio\">\\\r\n\t\t\t\t\t<div class=\"shops-view\">\\\r\n\t\t\t\t\t\t<div class=\"shops-view__one\">\\\r\n\t\t\t\t\t\t\t<input type=\"radio\"\\\r\n\t\t\t\t\t\t\t\tclass=\"shops-view__one-input\"\\\r\n\t\t\t\t\t\t\t\tvalue=\"dist\"\\\r\n\t\t\t\t\t\t\t\t:id=\"radioPrefix+\\'dist\\'\"\\\r\n\t\t\t\t\t\t\t\tv-model=\"viewType\"\\\r\n\t\t\t\t\t\t\t/>\\\r\n\t\t\t\t\t\t\t<label\\\r\n\t\t\t\t\t\t\t\t:for=\"radioPrefix+\\'dist\\'\"\\\r\n\t\t\t\t\t\t\t\tclass=\"shops-view__label\">\\\r\n\t\t\t\t\t\t\t\tПо удалённости\\\r\n\t\t\t\t\t\t\t</label>\\\r\n\t\t\t\t\t\t</div>\\\r\n\t\t\t\t\t\t<div v-if=\"false\" data=\"window.ostatki\" class=\"shops-view__one\">\\\r\n\t\t\t\t\t\t\t<input type=\"radio\"\\\r\n\t\t\t\t\t\t\t\tclass=\"shops-view__one-input\"\\\r\n\t\t\t\t\t\t\t\tvalue=\"count\"\\\r\n\t\t\t\t\t\t\t\t:id=\"radioPrefix+\\'dist\\'\"\\\r\n\t\t\t\t\t\t\t\tv-model=\"viewType\"\\\r\n\t\t\t\t\t\t\t/>\\\r\n\t\t\t\t\t\t\t<label\\\r\n\t\t\t\t\t\t\t\t:for=\"radioPrefix+\\'dist\\'\"\\\r\n\t\t\t\t\t\t\t\tclass=\"shops-view__label\">\\\r\n\t\t\t\t\t\t\t\tПо количеству\\\r\n\t\t\t\t\t\t\t</label>\\\r\n\t\t\t\t\t\t</div>\\\r\n\t\t\t\t\t\t<div v-if=\"!isKart || shopsList.length\" class=\"shops-view__one\">\\\r\n\t\t\t\t\t\t\t<input type=\"radio\"\\\r\n\t\t\t\t\t\t\t\tclass=\"shops-view__one-input\"\\\r\n\t\t\t\t\t\t\t\tvalue=\"map\"\\\r\n\t\t\t\t\t\t\t\t:id=\"radioPrefix+\\'view_map\\'\"\\\r\n\t\t\t\t\t\t\t\tv-model=\"viewType\"\\\r\n\t\t\t\t\t\t\t/>\\\r\n\t\t\t\t\t\t\t<label\\\r\n\t\t\t\t\t\t\t\t:for=\"radioPrefix+\\'view_map\\'\"\\\r\n\t\t\t\t\t\t\t\tclass=\"shops-view__label\">\\\r\n\t\t\t\t\t\t\t\tКарта \\\r\n\t\t\t\t\t\t\t</label>\\\r\n\t\t\t\t\t\t</div>\\\r\n\t\t\t\t\t\t<div class=\"shops-view__one\">\\\r\n\t\t\t\t\t\t\t<input type=\"radio\"\\\r\n\t\t\t\t\t\t\t\tclass=\"shops-view__one-input\"\\\r\n\t\t\t\t\t\t\t\tvalue=\"alph\"\\\r\n\t\t\t\t\t\t\t\t:id=\"radioPrefix+\\'alph\\'\"\\\r\n\t\t\t\t\t\t\t\tv-model=\"viewType\"\\\r\n\t\t\t\t\t\t\t/>\\\r\n\t\t\t\t\t\t\t<label\\\r\n\t\t\t\t\t\t\t\t:for=\"radioPrefix+\\'alph\\'\"\\\r\n\t\t\t\t\t\t\t\tclass=\"shops-view__label\">\\\r\n\t\t\t\t\t\t\t\tПо алфавиту\\\r\n\t\t\t\t\t\t\t</label>\\\r\n\t\t\t\t\t\t</div>\\\r\n\t\t\t\t</div>\\\r\n\t\t\t\t<div class=\"shops-filter__search\">\\\r\n\t\t\t\t\t<input v-if=\"viewType == \\'alph\\' || viewType == \\'dist\\'\" type=\"text\" class=\"shops-filter__search-input\"\\\r\n\t\t\t\t\t\tv-model=\"search__input\" placeholder=\"Поиск\" />\\\r\n\t\t\t\t</div>\\\r\n\t\t\t</div>\\\r\n\t\t\t<div v-if=\"isCitySelected && (viewType == \\'alph\\' || viewType == \\'dist\\')\" class=\"shops-list\">\\\r\n\t\t\t\t<ul class=\"shops-list__list\">\\\r\n\t\t\t\t\t<li v-if=\"!filteredList.length\" class=\"no-results\">По запросу ничего не найдено</li>\\\r\n\t\t\t\t\t<!--  -->\\\r\n\t\t\t\t\t<li v-if=\"!isKart || parseInt(ostatki[shop.xml_id])\" v-for=\"shop in filteredList\" class=\"shops-list__list-el\">\\\r\n\t\t\t\t\t\t<div class=\"radio\">\\\r\n\t\t\t\t\t\t\t<input\\\r\n\t\t\t\t\t\t\t\ttype=\"radio\"\\\r\n\t\t\t\t\t\t\t\t:name=\"radioPrefix+\\'_+curshop\\'\"\\\r\n\t\t\t\t\t\t\t\tclass=\"radio__input\"\\\r\n\t\t\t\t\t\t\t\t:id=\"radioPrefix+\\'_\\'+shop.id\"\\\r\n\t\t\t\t\t\t\t\tv-model=\"curShop\"\\\r\n\t\t\t\t\t\t\t\t:value=\"shop.id\"\\\r\n\t\t\t\t\t\t\t/>\\\r\n\t\t\t\t\t\t\t<label :for=\"radioPrefix+\\'_\\'+shop.id\" class=\"radio__label\">\\\r\n\t\t\t\t\t\t\t\t<div class=\"shops-list__list-address\">\\\r\n\t\t\t\t\t\t\t\t\t<span>{{ shop.address }}</span>&nbsp;<span v-if=\"shop.draftbeer ==\\'BEERRIVER\\'\" title=\"Есть разливное пиво\" class=\"shops-list__list-beer\"></span>\\\r\n\t\t\t\t\t\t\t\t</div>\\\r\n\t\t\t\t\t\t\t\t<div v-if=\"shop.time\" class=\"shops-list__list-time\"><span>{{ shop.time }}</span></div>\\\r\n\t\t\t\t\t\t\t\t<div v-if=\"shop.distance\" class=\"shops-list__list-dist\"><span>{{ shop.distance }} км</span></div>\\\r\n\t\t\t\t\t\t\t\t<div v-if=\"window.ostatki\" class=\"shops-list__list-dist\"><span>{{ ostatki[shop.xml_id] || 0 }} шт</span></div>\\\r\n\t\t\t\t\t\t\t</label>\\\r\n\t\t\t\t\t\t</div>\\\r\n\t\t\t\t\t</li>\\\r\n\t\t\t\t\t<li v-if=\"isKart && !shopsList.length\" class=\"no-results\">Товара нет в наличии</li>\\\r\n\t\t\t\t</ul>\\\r\n\t\t\t</div>\\\r\n\t\t\t<div v-show=\"isCitySelected && viewType == \\'map\\'\" class=\"shops__map\">\\\r\n\t\t\t\t<div :id=\"mapId\" class=\"shops__map-map\"></div>\\\r\n\t\t\t</div>\\\r\n\t\t\t<div v-if=\"curShop && (viewType == \\'alph\\' || viewType == \\'dist\\')\" class=\"shop-select__cont\">\\\r\n\t\t\t\t<span @click=\"setMainShop()\" class=\"btn btn--rectangle shop-select\">Выбрать</span>\\\r\n\t\t\t</div>\\\r\n\t\t</div>\\\r\n\t'\r\n});\r\n\r\nVue.component(\"checks-filter\", {\r\n\tprops: {\r\n\t\tlist: {\r\n\t\t\ttype: Array,\r\n\t\t\tdefault: []\r\n\t\t},\r\n\t\tinputName: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: \"checks\"\r\n\t\t}\r\n\t},\r\n\tdata: () => ({\r\n\t\tsearch__input: \"\",\r\n\t\ttoggleText: \"Развернуть\",\r\n\t}),\r\n\tcomputed: {\r\n\t\tfilteredItems (){\r\n\t\t\treturn this.list.filter(item => {\r\n\t\t\t\treturn ~item.name.toLowerCase().indexOf(this.search__input.toLowerCase())\r\n\t\t\t})\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\ttoggleSearch() {\r\n\t\t\tthis.toggleText = (this.toggleText == \"Развернуть\" ? \"Свернуть\" : \"Развернуть\");\r\n\t\t}\r\n\t},\r\n\ttemplate: '\\\r\n\t\t<div class=\"filter-search\">\\\r\n\t\t\t<input type=\"text\" placeholder=\"Поиск по значениям\" v-model.trim=\"search__input\" class=\"filter-search__input\"/>\\\r\n\t\t\t<ul class=\"filter__checks filter__checks--search\">\\\r\n\t\t\t\t<li v-for=\"(item, i) in filteredItems\" class=\"filter__checks-el\">\\\r\n\t\t\t\t\t<div v-if=\"toggleText == \\'Свернуть\\' || i <= 5\" class=\"checkbox\">\\\r\n\t\t\t\t\t\t<input :id=\"inputName+i\" type=\"checkbox\" :name=\"inputName\" :checked=\"item.checked\" class=\"checkbox__input\"/>\\\r\n\t\t\t\t\t\t<label :for=\"inputName+i\" class=\"checkbox__label\">{{ item.name }}</label>\\\r\n\t\t\t\t\t</div>\\\r\n\t\t\t\t</li>\\\r\n\t\t\t</ul>\\\r\n\t\t\t<div v-if=\"filteredItems.length > 5\" class=\"filter-search__show\">\\\r\n\t\t\t\t<div @click=\"toggleSearch()\" class=\"filter-show-toggle\">{{ toggleText }}</div>\\\r\n\t\t\t</div>\\\r\n\t\t</div>'\r\n});\r\n\r\nVue.component(\"price-filter\", {\r\n\tprops: {\r\n\t\tmax: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 10000,\r\n\t\t},\r\n\t\tmin: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 0,\r\n\t\t},\r\n\t\tminVal: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 0\r\n\t\t},\r\n\t\tmaxVal: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 10000\r\n\t\t},\r\n\t\tstep: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 0.5\r\n\t\t},\r\n\t\tminName: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: \"min\"\r\n\t\t},\r\n\t\tmaxName: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: \"max\"\r\n\t\t}\r\n\t},\r\n\tdata: () => ({\r\n\t\tmaxValue: 0,\r\n\t\tminValue: 0,\r\n\t\t$this: null,\r\n\t\t$range: null\r\n\t}),\r\n\tmounted (){\r\n\t\tthis.$this = $(this.$el);\r\n\r\n\t\tthis.minValue = +this.minVal;\r\n\t\tthis.maxValue = +this.maxVal;\r\n\r\n\t\tthis.initSlider();\r\n\t},\r\n\ttemplate: '\\\r\n\t\t<div class=\"price-filter\">\\\r\n\t\t\t<div class=\"input-group\">\\\r\n\t\t\t\t<input type=\"tel\" v-model.number=\"minValue\" :name=\"minName\" class=\"catalog-filter__input input-group__input\"/>\\\r\n\t\t\t\t<input type=\"tel\" v-model.number=\"maxValue\" :name=\"maxName\" class=\"catalog-filter__input input-group__input\"/>\\\r\n\t\t\t</div>\\\r\n\t\t\t<i class=\"price-filter__range range\"></i>\\\r\n\t\t</div>\\\r\n\t',\r\n\twatch: {\r\n\t\tmaxValue (val, oldVal) {\r\n\t\t\tthis.$range.slider(\"values\", 1, val);\r\n\t\t},\r\n\t\tminValue (val, oldVal) {\r\n\t\t\tthis.$range.slider(\"values\", 0, val);\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tinitSlider () {\r\n\t\t\tvar self = this;\r\n\r\n\t\t\tthis.$range = this.$this.find(\".range\").slider({\r\n\t\t\t\tanimate: \"normal\",\r\n\t\t\t\tmin: +self.min,\r\n\t\t\t\tmax: +self.max,\r\n\t\t\t\tvalues: [+self.minValue, +self.maxValue],\r\n\t\t\t\trange: true,\r\n\t\t\t\tstep: +self.step,\r\n\t\t\t\tslide: (e, ui) =>{\r\n\t\t\t\t\tself.minValue = ui.values[0];\r\n\t\t\t\t\tself.maxValue = ui.values[1];\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n})\r\n\r\nvar log = (str) => {\r\n\tconsole.log(str)\r\n},\r\nloadScripts = () => {\r\n\t$(\".fancybox\").fancybox({\r\n\t\tbeforeShow (){\r\n\t\t\t$(\"body\").addClass(\"fancy-active\")\r\n\t\t},\r\n\t\tafterClose (){\r\n\t\t\t$(\"body\").removeClass(\"fancy-active\")\t\r\n\t\t}\r\n\t});\r\n\r\n\t$(\"body\").on(\"click\", \".mobile-head__top .head__shop-city\", () => {\r\n\t\tapp.showCityPopup();\r\n\t});\r\n\r\n\t$(\"body\").on(\"click\", \".mobile-head__top .head__shop-address .address\", () => {\r\n\t\tapp.showShopPopup();\r\n\t});\r\n\r\n\t$(\"body\").on(\"click\", \".mobile-head__top .head__shop-address .delete\", () =>{\r\n\t\tstore.commit(\"deleteMainShop\");\r\n\t\tlocation.reload()\r\n\t});\r\n\r\n\t$(\".main-slider\").slick({\r\n\t\tslide: \".main-slider__slide\",\r\n\t\tslidesToShow: 1,\r\n\t\tslidesToScroll: 1,\r\n\t\tarrows: true,\r\n\t\tspeed: 400,\r\n\t\tautoplay: true,\r\n\t\t// lazyLoad: \"progressive\",\r\n\t\tautoplaySpeed: 2000\r\n\t});\r\n\r\n\t$(\".anketa_new-slider\").slick({\r\n\t\tslide: \".anketa_new-slide\",\r\n\t\tslidesToShow: 1,\r\n\t\tslidesToScroll: 1,\r\n\t\tarrows: true,\r\n\t\tspeed: 400,\r\n\t\tautoplay: true,\r\n\t\t// lazyLoad: \"progressive\",\r\n\t\tautoplaySpeed: 2000\r\n\t});\r\n\r\n\t$(\".tabs__tab\").click(function(){\r\n\t\tvar $this = $(this);\r\n\r\n\t\tif ($(this).hasClass(\"active\"))\r\n\t\t\treturn\r\n\r\n\t\tvar id = +$this.attr(\"data-id\"),\r\n\t\t\t$parent = $this.closest(\".tabs\");\r\n\r\n\t\t$parent.find(\".tabs__tab.active, .tabs-content.active\").removeClass(\"active\");\r\n\r\n\t\t$parent.find(\".tabs__tab[data-id='\"+id+\"'], .tabs-content[data-id='\"+id+\"']\").addClass(\"active\");\r\n\r\n\t});\r\n\r\n\t$(\".cat-slider\").slick({\r\n\t\tslidesToShow: 4,\r\n\t\tslidesToScroll: 1,\r\n\t\tslide: \".cat-slider__slide\",\r\n\t\tautoplay: true,\r\n\t\tautoplaySpeed: 3000,\r\n\t\tresponsive: [\r\n\t\t\t{\r\n\t\t\t\tbreakpoint: 1000,\r\n\t\t\t\tsettings: {\r\n\t\t\t\t\tslidesToShow: 3,\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tbreakpoint: 820,\r\n\t\t\t\tsettings: {\r\n\t\t\t\t\tslidesToShow: 2,\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tbreakpoint: 660,\r\n\t\t\t\tsettings: {\r\n\t\t\t\t\tslidesToShow: 1,\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t]\r\n\t});\r\n\r\n\t// слайдер в карточке товвара\r\n\t$(\".another .cat-plate\").slick({\r\n\t\tslidesToShow: 3,\r\n\t\tslidesToScroll: 1,\r\n\t\tslide: \".cat-plate__one-wrap\",\r\n\t\tresponsive: [\r\n\t\t\t{\r\n\t\t\t\tbreakpoint: 820,\r\n\t\t\t\tsettings: {\r\n\t\t\t\t\tslidesToShow: 2,\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tbreakpoint: 660,\r\n\t\t\t\tsettings: {\r\n\t\t\t\t\tslidesToShow: 1,\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t]\r\n\t});\r\n\r\n\t$(\".bot-text__btn\").click(function(){\r\n\t\t$(this).toggleClass(\"active\");\r\n\t\t$(this).parent(\".bot-text\").toggleClass(\"active\");\r\n\t});\r\n\r\n\t$(\".catalog-nav__current\").click(function(){\r\n\t\tvar $this = $(this);\r\n\r\n\t\t$this.next(\".catalog-nav__list\").slideToggle(300);\r\n\t});\r\n\r\n\t$('.catalog-filter__button').click(function(){\r\n\t\tvar $this = $(this);\r\n\r\n\t\t$this.next('.catalog-filter__bock').slideToggle(300);\r\n\t});\r\n\r\n\t$(\".filter-block__title\").click(function(){\r\n\t\tvar $this = $(this);\r\n\r\n\t\t$this.next(\".filter-block__content\").slideToggle(300);\r\n\r\n\t\tsetTimeout(() =>{\r\n\t\t\t$this.parent(\".filter-block\").toggleClass(\"closed\");\r\n\t\t}, 290);\r\n\r\n\t});\r\n\r\n\t$('.catalog__filter-btn').click(function() {\r\n\t\t$('.catalog-filter__bock').slideToggle('slow');\r\n\t});\r\n\r\n\r\n\t$(\".price-filter\").each((i, el)=>{\r\n\t\tvar $this = $(el);\r\n\r\n\t\tvar step = +$this.attr(\"data-step\"),\r\n\t\t\t$min = $this.find(\"input[data-min]\"),\r\n\t\t\t$max = $this.find(\"input[data-max]\");\r\n\r\n\t\tvar min = +$min.attr(\"data-min\"),\r\n\t\t\tmax = +$max.attr(\"data-max\");\r\n\r\n\t\tvar $range = $this.find(\".range\").slider({\r\n\t\t\tanimate: \"normal\",\r\n\t\t\tmin: min,\r\n\t\t\tmax: max,\r\n\t\t\tvalues: [$min.val(), $max.val()],\r\n\t\t\trange: true,\r\n\t\t\tstep: step,\r\n\t\t\tslide: (e, ui) =>{\r\n\t\t\t\t$min.val(ui.values[0]);\r\n\t\t\t\t$max.val(ui.values[1]);\r\n\t\t\t},\r\n\t\t\tchange(e, ui){\r\n\t\t\t\tsmartFilter.reload($min[0])\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\t$this.find(\"input[type='tel']\").on(\"keyup\", function(){\r\n\t\t\tvar id, val;\r\n\r\n\t\t\tif ($(this).attr(\"data-min\")){\r\n\t\t\t\tid = 0;\r\n\t\t\t\tval = (+$(this).val() < min ? min : +$(this).val());\r\n\t\t\t}else if ($(this).attr(\"data-max\")){\r\n\t\t\t\tid = 1;\r\n\t\t\t\tval = (+$(this).val() > max ? max : +$(this).val());\r\n\t\t\t}\r\n\r\n\t\t\t$range.slider(\"values\", id, val);\r\n\t\t})\r\n\t});\r\n\r\n\t$('.tovar-slider').slick({\r\n\t\tslide: '.tovar-slider__slide',\r\n\t\tslidesToShow: 1,\r\n\t\tslidesToScroll: 1,\r\n\t\tarrows: false,\r\n\r\n\t});\r\n\r\n\t$('.vacancy__item-header').click(function() {\r\n\t \t$(this).next().slideToggle('slow');\r\n\t \t$(this).toggleClass('active');\r\n\t});\r\n\r\n\t$('#menu-toggle').click(function(){\r\n\t\t$(this).toggleClass('open');\r\n\t\t$('body').toggleClass(\"mobile-menu--open\");\r\n\t});\r\n\r\n\t$('.catalog__filter-btn').click(function(){\r\n\t\t$(this).toggleClass('filter-open');\r\n\t\t$('catalog-nav').slideToggle('slow');\r\n\t});\r\n\r\n\r\n\tif($('body').hasClass('inner')) {\r\n\t\t$('.head__menu').each(function(i, el){\r\n\t\t\tlet $this = $(this);\r\n\r\n\t\t\tvar title = 'Каталог',\r\n\t\t\t\tcatalogMenu = \"\";\r\n\r\n\t\t\t$this.find('.menu__link').each(function(){\r\n\t\t\t\tcatalogMenu += '<li class=\"submenu__el\">\\\r\n\t\t\t\t\t\t<a href=\"'+$(this).attr(\"href\")+'\" class=\"submenu__link\">'+$(this).text()+'</a>\\\r\n\t\t\t\t</li>'\r\n\t\t\t});\r\n\r\n\t\t\tconsole.log(1243);\r\n\r\n\t\t\t$(\".mobile-menu\").append('<li class=\"mobile-menu__el\">\\\r\n\t       \t\t<span class=\"mobile-menu__link sub\">'+title+'</span>\\\r\n\t       \t\t<ul class=\"submenu\"><li class=\"submenu__el submenu__back\">Назад</li>'+catalogMenu+'</ul>\\\r\n\t       \t</li>')\r\n\r\n\t\t});\r\n\r\n\r\n\t};\r\n\r\n\tconsole.log(1243);\r\n\r\n\r\n\r\n\t$(\".footer-menu__cont\").each((i, el) =>{\r\n    let $this = $(el);\r\n\r\n    var title = $this.find(\".footer-menu__title\").text(),\r\n   \t\tsubmenu = \"\";\r\n\r\n   \t$this.find(\".footer-menu__link\").each((i, el) =>{\r\n   \t\tlet $this = $(el);\r\n\r\n      submenu += '<li class=\"submenu__el\">\\\r\n\t\t\t<a href=\"'+$this.attr(\"href\")+'\" class=\"submenu__link\">'+$this.text()+'</a>\\\r\n\t\t</li>'\r\n   \t});\r\n\r\n\r\n   \t$(\".mobile-menu\").append('<li class=\"mobile-menu__el\">\\\r\n   \t\t<span class=\"mobile-menu__link sub\">'+title+'</span>\\\r\n   \t\t<ul class=\"submenu\"><li class=\"submenu__el submenu__back\">Назад</li>'+submenu+'</ul>\\\r\n   \t</li>')\r\n\r\n\t});\r\n\r\n  $('.catalog-nav').each((i, el) =>{\r\n  \tlet $this = $(el);\r\n\r\n  \tvar title = 'Категории',\r\n  \tcategoryList = \"\";\r\n\r\n  \t$this.find('.catalog-nav__list-link').each((i, el) => {\r\n  \t\tlet $this = $(el);\r\n\r\n  \t\tcategoryList += '<li class=\"submenu__el\">\\\r\n\t\t\t\t<a href=\"'+$this.attr(\"href\")+'\" class=\"submenu__link\">'+$this.text()+'</a>\\\r\n\t\t\t</li>'\r\n  \t});\r\n\r\n  \t$(\".mobile-menu\").append('<li class=\"mobile-menu__el\">\\\r\n       \t\t<span class=\"mobile-menu__link sub\">'+title+'</span>\\\r\n       \t\t<ul class=\"submenu\"><li class=\"submenu__el submenu__back\">Назад</li>'+categoryList+'</ul>\\\r\n       \t</li>')\r\n\r\n  });\r\n\r\n\t$('.head__top').clone().addClass(\"mobile-head__top\").appendTo('.menu-mobile__wrap');\r\n\t$('.msgs').clone().removeClass(\"msgs\").addClass(\"mobile-menu__message\").appendTo('.menu-mobile__wrap');\r\n\r\n\tif($(window).width() < 820) {\r\n\r\n\t\tvar fooerSoc = $('.footer__soc .soc').clone().removeClass('soc').addClass('js__mobile-soc');\r\n\t\t$('.mobile-menu__message').prepend(fooerSoc);\r\n\t};\r\n\t\r\n\r\n\t$(\"body\").on(\"click\", \".mobile-menu__link.sub, .submenu__back\", function(){\r\n\t\tlet $this = $(this);\r\n\r\n\t\t$this.closest('.mobile-menu__el').toggleClass('submenu-open');\r\n\r\n\t});\r\n\r\n\t$(\".to-full\").click(e =>{\r\n\t\tCookies.set(\"full-version\", 1);\r\n\t\tlocation.reload();\r\n\t});\r\n\r\n\t$(\".to-mobile\").click(e => {\r\n\t\tCookies.remove(\"full-version\");\r\n\t\tlocation.reload();\r\n\t});\r\n\r\n\t$('input[type=\"file\"]').change(function(){\r\n\t\tvar value = $(this)[0].files[0].name;\r\n\t\t$(this).prev('.forms__input--file-support').val(value);\r\n\t\t$(this).next('.forms__input--file-support').val(value);\r\n\t});\r\n\r\n\r\n\tif ($(\"html\").hasClass(\"bx-ie\")){\r\n\t\t$(\".main-news__important\").css({\r\n\t\t\theight: \"auto\"\r\n\t\t});\r\n\t\t$(\".main-news\").css({\r\n\t\t\t\"min-height\": $(\".main-news__important\").height()\r\n\t\t});\r\n\t}\r\n\r\n\t$(\".main-slider__slide\").each((i, el) => {\r\n\t\tlet $this = $(el);\r\n\r\n\t\tif ($this.find(\".main-slider__slide-title\").text() == \"\")\r\n\t\t\t$this.addClass(\"js__empty\");\r\n\t});\r\n\r\n\r\n\t$(\".catalog\").prepend('<div class=\"js__dop-info\"></div>');\r\n\r\n\t$(\".title-block__cont\").clone().addClass(\"js__title\").appendTo(\".js__dop-info\");\r\n\r\n\t// $('.status-price-1').closest('.cat-plate__price, .cat-list__price').addClass('max');\r\n\r\n\r\n\r\n\t$('body').on('touchstart touchmove touchend', 'span.ui-slider-handle', function (event) {\r\n\t    //mousevents to simulate on touch\r\n\t    var touchEvents = {\r\n\t        touchstart: 'mousedown',\r\n\t        touchmove: 'mousemove',\r\n\t        touchend: 'mouseup'\r\n\t    };\r\n\r\n\t    //get element and type of event to simulate\r\n\t    var simulatedEvent = touchEvents[event.originalEvent.type],\r\n\t        touch = event.originalEvent.changedTouches[0],\r\n\t        mouseEvent = document.createEvent('MouseEvent');\r\n\r\n\t    //return if no mouse event is matched\r\n\t    if (typeof simulatedEvent === 'undefined') {\r\n\t        return;\r\n\t    }\r\n\r\n\t    //init the mousevent if we have a matched event\r\n\t    mouseEvent.initMouseEvent(\r\n\t        simulatedEvent, //type\r\n\t        true, //bubbles \r\n\t        true, //cancelable \r\n\t        window, //view \r\n\t        1, //detail \r\n\t        touch.screenX, //screenX\r\n\t        touch.screenY, //screenY\r\n\t        touch.clientX, //clientX\r\n\t        touch.clientY, //clientY\r\n\t        false, //ctrlKey\r\n\t        false, //altKey\r\n\t        false, //shiftKey\r\n\t        false, //metaKey\r\n\t        0, //button\r\n\t        null //related target\r\n\t    );\r\n\r\n\t    //dispatch event on touched element\r\n\t    touch.target.dispatchEvent(mouseEvent);\r\n\t    event.preventDefault();\r\n\t});\r\n\r\n\r\n\t\r\n}\r\n\r\nvar getDistanceFromLatLonInKm = (lat1,lon1,lat2,lon2) => {\r\n  var R = 6371; // Radius of the earth in km\r\n  var dLat = deg2rad(lat2-lat1);  // deg2rad below\r\n  var dLon = deg2rad(lon2-lon1);\r\n  var a =\r\n    Math.sin(dLat/2) * Math.sin(dLat/2) +\r\n    Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) *\r\n    Math.sin(dLon/2) * Math.sin(dLon/2)\r\n    ;\r\n  var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\r\n  var d = R * c; // Distance in km\r\n  return d;\r\n},\r\ndeg2rad = (deg) => {\r\n  return deg * (Math.PI/180)\r\n}"]}